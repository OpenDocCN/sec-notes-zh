![](img/c9caf156e3d92e984692837ed60f2d4c_0.png)

# è¯¾ç¨‹P1-51ï¼šè‡ªåŠ¨åŒ–æŒ–æ´æ–¹å¼å¤§èµ·åº•â€”â€”æ‰«æå™¨ä¼˜åŒ–æ–¹æ¡ˆåŠè„šæœ¬ç¼–å†™ ğŸš€

åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•é€šè¿‡è°ƒç”¨æ‰«æå™¨APIå’Œæ“ä½œå…¶æ•°æ®åº“ï¼Œæ¥ä¼˜åŒ–è‡ªåŠ¨åŒ–æ¼æ´æŒ–æ˜æµç¨‹ï¼Œå¹¶ç¼–å†™è„šæœ¬ä»¥æé«˜æ•ˆç‡ã€‚è¯¾ç¨‹å†…å®¹ä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šä¸€æ˜¯é€šè¿‡APIæ‰¹é‡ç®¡ç†æ‰«æä»»åŠ¡ï¼ŒäºŒæ˜¯è¿æ¥æ‰«æå™¨æ•°æ®åº“ä»¥æå–å’ŒéªŒè¯æ¼æ´ä¿¡æ¯ã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_2.png)

---

![](img/c9caf156e3d92e984692837ed60f2d4c_4.png)

## ä¸ºä»€ä¹ˆè¦å­¦ä¹ ä½¿ç”¨æ‰«æå™¨ï¼ŸğŸ¤”

![](img/c9caf156e3d92e984692837ed60f2d4c_6.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†è¯¾ç¨‹çš„æ•´ä½“ç›®æ ‡ï¼Œæœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹æŒæ¡æ‰«æå™¨æŠ€èƒ½çš„å¿…è¦æ€§ã€‚ä»¥ä¸‹æ˜¯å‡ ä¸ªå…³é”®åŸå› ï¼š

1.  **ä½œä¸ºå®‰å…¨äººå‘˜çš„å¿…å¤‡æŠ€èƒ½**ï¼šè®¸å¤šå®‰å…¨å²—ä½çš„æ‹›è˜è¦æ±‚ä¸­ï¼Œæ˜ç¡®åˆ—å‡ºâ€œç†Ÿç»ƒä½¿ç”¨æŸæŸæ‰«æå™¨è€…ä¼˜å…ˆâ€ã€‚
2.  **æé«˜å·¥ä½œæ•ˆç‡**ï¼šæ‰«æå™¨çš„å¼€å‘åˆè¡·å°±æ˜¯å‡å°‘äººå·¥æ£€æµ‹ï¼Œå…¶æ‰«æé€Ÿåº¦å¿«ä¸”ä¸çŸ¥ç–²å€¦ã€‚
3.  **å­¦ä¹ æ‰«ææ€è·¯ä¸è§„åˆ™**ï¼šé€šè¿‡ç ”ç©¶æ‰«æå™¨å†…ç½®çš„æ£€æµ‹è§„åˆ™ï¼ˆä¾‹å¦‚é’ˆå¯¹å¤‡ä»½æ–‡ä»¶æ³„éœ²çš„è§„åˆ™ï¼‰ï¼Œå¯ä»¥å­¦ä¹ å‰äººçš„ç»éªŒï¼Œå¹¶ç¼–å†™æœ‰é’ˆå¯¹æ€§çš„è½»é‡çº§è„šæœ¬ã€‚
4.  **å‘ç°å¹¶å®Œå–„æ‰«æå™¨çš„ä¸è¶³**ï¼šæ‰«æå™¨å¯èƒ½å­˜åœ¨é€»è¾‘æ¼æ´æ£€æµ‹ç›²åŒºï¼Œæˆ–å¯¹å›½å†…å¼€å‘è€…çš„ä¹ æƒ¯æ”¯æŒä¸è¶³ï¼Œäº†è§£å…¶åŸç†æœ‰åŠ©äºæˆ‘ä»¬è¿›è¡Œè¡¥å……å’Œä¼˜åŒ–ã€‚

---

![](img/c9caf156e3d92e984692837ed60f2d4c_8.png)

## ç¬¬ä¸€éƒ¨åˆ†ï¼šè°ƒç”¨æ‰«æå™¨APIç¼–å†™è„šæœ¬ ğŸ› ï¸

![](img/c9caf156e3d92e984692837ed60f2d4c_10.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_12.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬äº†è§£äº†å­¦ä¹ æ‰«æå™¨çš„æ„ä¹‰ï¼Œæœ¬èŠ‚ä¸­æˆ‘ä»¬å°†åŠ¨æ‰‹å®è·µï¼Œå­¦ä¹ å¦‚ä½•é€šè¿‡APIä¸æ‰«æå™¨è¿›è¡Œäº¤äº’ã€‚

åœ¨å¼€å§‹ç¼–å†™è„šæœ¬å‰ï¼Œéœ€è¦æŒæ¡ä¸€äº›PythonåŸºç¡€çŸ¥è¯†ã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_14.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_15.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_16.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_18.png)

### PythonåŸºç¡€å‡†å¤‡

ä»¥ä¸‹æ˜¯ç¼–å†™è„šæœ¬æ‰€éœ€çš„æ ¸å¿ƒçŸ¥è¯†ï¼š

![](img/c9caf156e3d92e984692837ed60f2d4c_20.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_22.png)

*   **åˆ—è¡¨ä¸å­—å…¸**ï¼š
    *   åˆ—è¡¨ï¼šç”±ä¸­æ‹¬å· `[]` æ‹¬èµ·ï¼Œå…ƒç´ ä»¥é€—å·åˆ†éš”ã€‚ä¾‹å¦‚ï¼š`[â€˜aâ€˜, â€˜bâ€˜, â€˜câ€˜]`
    *   å­—å…¸ï¼šç”±å¤§æ‹¬å· `{}` æ‹¬èµ·ï¼Œæ˜¯é”®å€¼å¯¹é›†åˆã€‚ä¾‹å¦‚ï¼š`{â€˜key1â€˜: â€˜value1â€˜, â€˜key2â€˜: â€˜value2â€˜}`
*   **JSONå¤„ç†**ï¼š
    *   `json.loads()`: å°†JSONæ ¼å¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºPythonå¯¹è±¡ï¼ˆå¦‚å­—å…¸æˆ–åˆ—è¡¨ï¼‰ã€‚
    *   `json.dumps()`: å°†Pythonå¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ï¼Œç”¨äºPOSTæäº¤æ•°æ®ã€‚
*   **Requestsåº“**ï¼šç”¨äºå‘é€HTTPè¯·æ±‚ã€‚éœ€è¦æŒæ¡å‡ ç§åŸºæœ¬çš„è¯·æ±‚æ–¹æ³•ï¼Œå¦‚GETã€POSTã€PATCHã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_24.png)

### ç¯å¢ƒä¸é…ç½®

![](img/c9caf156e3d92e984692837ed60f2d4c_26.png)

æœ¬æ¬¡æ¼”ç¤ºä½¿ç”¨çš„æ¼æ´æµ‹è¯•ç¯å¢ƒæ˜¯ `Web for Pen Test`ã€‚å…³äºæ‰«æå™¨ï¼ˆAWVSï¼‰çš„å®‰è£…ï¼Œè¯·æ³¨æ„ä»¥ä¸‹ä¸¤ç‚¹ï¼š

![](img/c9caf156e3d92e984692837ed60f2d4c_28.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_30.png)

1.  è‹¥å®‰è£…åœ¨è¿œç¨‹æœåŠ¡å™¨ï¼Œéœ€åœ¨å®‰è£…æ—¶å‹¾é€‰â€œå…è®¸è¿œç¨‹è®¿é—®â€ï¼Œå¹¶é…ç½®å¥½é˜²ç«å¢™è§„åˆ™ã€‚
2.  è‹¥æµè§ˆå™¨æç¤ºè¯ä¹¦ä¸å®‰å…¨ï¼Œéœ€è¦æ‰‹åŠ¨å¯¼å…¥æ‰«æå™¨è‡ªå¸¦çš„SSLè¯ä¹¦ï¼ˆé€šå¸¸ä½äºå®‰è£…ç›®å½•ä¸‹ï¼‰ã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_32.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_34.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_36.png)

### è·å–ä¸éªŒè¯APIå¯†é’¥

APIå¯†é’¥æ˜¯è°ƒç”¨æ¥å£çš„å‡­è¯ã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_38.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_40.png)

1.  åœ¨æ‰«æå™¨Webç•Œé¢ï¼Œè¿›å…¥ `Configuration` -> `API Keys` ç”Ÿæˆä»¤ç‰Œã€‚
2.  åœ¨HTTPè¯·æ±‚å¤´ä¸­ï¼Œå¿…é¡»æ·»åŠ  `X-Auth` å­—æ®µè¿›è¡ŒéªŒè¯ï¼Œæ ¼å¼ä¸ºï¼š`X-Auth: <ä½ çš„APIä»¤ç‰Œ>`ã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_42.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_44.png)

ä»¥ä¸‹æ˜¯ä¸€ä¸ªPythonè¯·æ±‚å¤´æ„é€ ç¤ºä¾‹ï¼š
```python
headers = {
    â€˜X-Authâ€˜: â€˜ä½ çš„APIä»¤ç‰Œâ€˜,
    â€˜Content-typeâ€˜: â€˜application/jsonâ€˜
}
```

![](img/c9caf156e3d92e984692837ed60f2d4c_45.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_47.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_49.png)

### å®è·µï¼šæ·»åŠ æ‰«æç›®æ ‡

![](img/c9caf156e3d92e984692837ed60f2d4c_50.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_52.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_54.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_56.png)

æ·»åŠ ç›®æ ‡çš„è¯·æ±‚æ–¹å¼æ˜¯POSTï¼ŒURLä¸º `/api/v1/targets`ã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_58.png)

ä»¥ä¸‹æ˜¯æ·»åŠ ç›®æ ‡çš„å‡½æ•°ç¤ºä¾‹ï¼š
```python
import requests
import json

![](img/c9caf156e3d92e984692837ed60f2d4c_60.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_62.png)

def add_target(api_url, token, target_address, description):
    url = fâ€œ{api_url}/api/v1/targetsâ€œ
    headers = {
        â€˜X-Authâ€˜: token,
        â€˜Content-typeâ€˜: â€˜application/jsonâ€˜
    }
    data = {
        â€˜addressâ€˜: target_address,
        â€˜descriptionâ€˜: description
    }
    # å¿½ç•¥SSLè¯ä¹¦éªŒè¯ï¼ˆæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ï¼‰
    response = requests.post(url, headers=headers, data=json.dumps(data), verify=False)
    return response.json() # è¿”å›å“åº”ä¿¡æ¯

![](img/c9caf156e3d92e984692837ed60f2d4c_64.png)

# è°ƒç”¨å‡½æ•°
result = add_target(â€˜https://your-awvs-hostâ€˜, â€˜your-token-hereâ€˜, â€˜http://test.comâ€˜, â€˜æµ‹è¯•ç›®æ ‡â€˜)
print(result)
```
æ‰§è¡ŒæˆåŠŸåï¼Œä¼šè¿”å›ä¸€ä¸ªåŒ…å«ç›®æ ‡IDçš„JSONå¯¹è±¡ã€‚è¿™ä¸ªIDåœ¨åç»­æ“ä½œä¸­è‡³å…³é‡è¦ã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_66.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_68.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_70.png)

### å®è·µï¼šé…ç½®æ‰«æå‚æ•°

![](img/c9caf156e3d92e984692837ed60f2d4c_72.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_74.png)

æ·»åŠ ç›®æ ‡åï¼Œéœ€è¦å¯¹å…¶è¿›è¡Œé…ç½®ï¼Œå¦‚æ‰«æé€Ÿåº¦ã€ç«™ç‚¹ç™»å½•ä¿¡æ¯ç­‰ã€‚

é…ç½®è¯·æ±‚é€šå¸¸ä½¿ç”¨PATCHæ–¹æ³•ï¼ŒURLæ ¼å¼ä¸º `/api/v1/targets/{target_id}/configuration`ã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_76.png)

ä»¥ä¸‹æ˜¯è®¾ç½®æ‰«æé€Ÿåº¦çš„å‡½æ•°ç¤ºä¾‹ï¼š
```python
def set_scan_speed(api_url, token, target_id, speed):
    url = fâ€œ{api_url}/api/v1/targets/{target_id}/configurationâ€œ
    headers = {
        â€˜X-Authâ€˜: token,
        â€˜Content-typeâ€˜: â€˜application/jsonâ€˜
    }
    # speed å¯é€‰ â€˜slowâ€˜, â€˜moderateâ€˜, â€˜fastâ€˜
    data = {
        â€˜scan_speedâ€˜: speed
    }
    response = requests.patch(url, headers=headers, data=json.dumps(data), verify=False)
    return response.status_code # é€šå¸¸æˆåŠŸè¿”å›204

![](img/c9caf156e3d92e984692837ed60f2d4c_78.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_80.png)

# ç±»ä¼¼åœ°ï¼Œå¯ä»¥ç¼–å†™è®¾ç½®ç™»å½•å‡­è¯ã€ä»£ç†ç­‰å‡½æ•°
```
**å°æŠ€å·§**ï¼šå¦‚æœä¸æ¸…æ¥šAPIæäº¤çš„å…·ä½“æ•°æ®æ ¼å¼ï¼Œå¯ä»¥ä½¿ç”¨æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰ï¼Œåœ¨æ‰«æå™¨Webç•Œé¢è¿›è¡Œæ“ä½œæ—¶ï¼Œäºâ€œç½‘ç»œâ€æ ‡ç­¾é¡µä¸­æŸ¥çœ‹å®é™…å‘é€çš„è¯·æ±‚ã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_81.png)

### å®è·µï¼šå¯åŠ¨æ‰«æ

![](img/c9caf156e3d92e984692837ed60f2d4c_83.png)

é…ç½®å®Œæˆåï¼Œå³å¯å¯åŠ¨æ‰«æã€‚è¯·æ±‚æ–¹å¼ä¸ºPOSTï¼ŒURLä¸º `/api/v1/scans`ã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_85.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_86.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_88.png)

å¯åŠ¨æ‰«æéœ€è¦æŒ‡å®šç›®æ ‡IDå’Œæ‰«æç±»å‹ã€‚æ‰«æç±»å‹ä»£ç å¯åœ¨æ•°æ®åº“æˆ–å®˜æ–¹æ–‡æ¡£ä¸­æŸ¥è¯¢ï¼Œä¾‹å¦‚ï¼š
*   `11111111-1111-1111-1111-111111111111`: å®Œå…¨æ‰«æ
*   `11111111-1111-1111-1111-111111111112`: ä»…é«˜å±æ¼æ´

![](img/c9caf156e3d92e984692837ed60f2d4c_90.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_92.png)

ä»¥ä¸‹æ˜¯å¯åŠ¨æ‰«æçš„å‡½æ•°ç¤ºä¾‹ï¼š
```python
def start_scan(api_url, token, target_id, scan_profile_id):
    url = fâ€œ{api_url}/api/v1/scansâ€œ
    headers = {
        â€˜X-Authâ€˜: token,
        â€˜Content-typeâ€˜: â€˜application/jsonâ€˜
    }
    data = {
        â€˜target_idâ€˜: target_id,
        â€˜profile_idâ€˜: scan_profile_id
    }
    response = requests.post(url, headers=headers, data=json.dumps(data), verify=False)
    return response.json()
```

![](img/c9caf156e3d92e984692837ed60f2d4c_94.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_96.png)

---

![](img/c9caf156e3d92e984692837ed60f2d4c_98.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_100.png)

## ç¬¬äºŒéƒ¨åˆ†ï¼šæ‰«æå™¨æ•°æ®åº“çš„ä½¿ç”¨ ğŸ—ƒï¸

![](img/c9caf156e3d92e984692837ed60f2d4c_102.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_104.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•é€šè¿‡APIæ§åˆ¶æ‰«æå™¨ï¼Œæœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ç›´æ¥æ“ä½œæ‰«æå™¨æ•°æ®åº“ï¼Œä»¥æ›´çµæ´»åœ°è·å–å’ŒéªŒè¯æ¼æ´ä¿¡æ¯ã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_106.png)

è™½ç„¶APIä¹Ÿèƒ½è·å–æ¼æ´æ•°æ®ï¼Œä½†å­˜åœ¨åˆ†é¡µé™åˆ¶ï¼ˆæ¯æ¬¡æœ€å¤š99æ¡ï¼‰ã€‚ç›´æ¥æŸ¥è¯¢æ•°æ®åº“åˆ™æ›´ä¸ºé«˜æ•ˆå’Œå…¨é¢ã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_108.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_110.png)

### è¿æ¥æ•°æ®åº“

![](img/c9caf156e3d92e984692837ed60f2d4c_112.png)

æ‰«æå™¨ï¼ˆAWVSï¼‰ä½¿ç”¨PostgreSQLæ•°æ®åº“ã€‚è¿æ¥ä¿¡æ¯å¯åœ¨å…¶é…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ°ã€‚æœ¬åœ°è¿æ¥é€šå¸¸æ— éœ€å¯†ç ã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_114.png)

ä»¥ä¸‹æ˜¯ä½¿ç”¨Pythonè¿æ¥æ•°æ®åº“çš„ç¤ºä¾‹ï¼š
```python
import psycopg2

![](img/c9caf156e3d92e984692837ed60f2d4c_116.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_117.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_119.png)

# è¿æ¥å‚æ•°
conn = psycopg2.connect(
    database=â€œwvsâ€œ,
    user=â€œwvsâ€œ,
    password=â€œâ€œ, # æœ¬åœ°å¯èƒ½ä¸ºç©º
    host=â€œ127.0.0.1â€œ,
    port=â€œ5432â€œ
)
cursor = conn.cursor()
```

![](img/c9caf156e3d92e984692837ed60f2d4c_121.png)

### æ ¸å¿ƒæ•°æ®è¡¨

![](img/c9caf156e3d92e984692837ed60f2d4c_123.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_125.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_127.png)

æ•°æ®åº“ä¸­æœ‰å‡ ä¸ªé‡è¦çš„è¡¨ï¼š

![](img/c9caf156e3d92e984692837ed60f2d4c_129.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_131.png)

1.  **`dast_scans` è¡¨**ï¼šå­˜å‚¨æ‰«æä»»åŠ¡ä¿¡æ¯ã€‚
2.  **`vulnerabilities` è¡¨**ï¼š**è¿™æ˜¯æœ€é‡è¦çš„è¡¨**ï¼Œå­˜å‚¨äº†æ£€æµ‹å‡ºçš„æ¼æ´è¯¦æƒ…ï¼ŒåŒ…æ‹¬ï¼š
    *   æ¼æ´ç±»å‹
    *   å­˜åœ¨æ¼æ´çš„URL
    *   æ”»å‡»å‚æ•°ï¼ˆ`attack`ï¼‰
    *   å®Œæ•´çš„HTTPè¯·æ±‚æ•°æ®ï¼ˆ`request`ï¼‰
    *   æ”»å‡»è½½è·ï¼ˆ`proof`ï¼‰
    *   æœåŠ¡å™¨å“åº”ï¼ˆ`response`ï¼‰
3.  **`vulnerability_types` è¡¨**ï¼šå­˜å‚¨æ¼æ´ç±»å‹çš„æè¿°ã€ä¿®å¤æ–¹æ¡ˆç­‰ã€‚å¯ä»¥ä¿®æ”¹æ­¤è¡¨å†…å®¹ä»¥å®ç°æŠ¥å‘Šæ±‰åŒ–ï¼Œä½†éœ€æ³¨æ„ä¿ç•™HTMLæ ‡ç­¾å’Œå­—ç¬¦å®ä½“ã€‚

### ä»æ•°æ®åº“æå–æ¼æ´ä¿¡æ¯

![](img/c9caf156e3d92e984692837ed60f2d4c_133.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_135.png)

ä»¥ä¸‹æ˜¯ä» `vulnerabilities` è¡¨ä¸­æå–å…³é”®ä¿¡æ¯çš„ç¤ºä¾‹ï¼š
```python
# å‡è®¾å·²å»ºç«‹æ•°æ®åº“è¿æ¥ conn
cursor.execute(â€œSELECT url, attack, proof, request FROM vulnerabilities WHERE scan_id=xxxâ€œ)
vuln_records = cursor.fetchall()

![](img/c9caf156e3d92e984692837ed60f2d4c_137.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_138.png)

for record in vuln_records:
    vuln_url = record[0]
    vuln_attack_param = record[1]
    vuln_proof = record[2]
    vuln_raw_request = record[3]
    print(fâ€œæ¼æ´URL: {vuln_url}â€œ)
    print(fâ€œæ”»å‡»å‚æ•°: {vuln_attack_param}â€œ)
    # è¿›ä¸€æ­¥å¤„ç†...
cursor.close()
conn.close()
```

![](img/c9caf156e3d92e984692837ed60f2d4c_140.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_142.png)

### æ¼æ´éªŒè¯æ€è·¯

è·å–æ¼æ´ä¿¡æ¯åï¼Œå¯ä»¥ç¼–å†™è„šæœ¬è¿›è¡Œè‡ªåŠ¨éªŒè¯ï¼Œä»¥å‡å°‘æ‰‹å·¥ç¡®è®¤çš„å·¥ä½œé‡ã€‚

åŸºæœ¬æ€è·¯å¦‚ä¸‹ï¼š
1.  **åˆ¤æ–­æ¼æ´ç±»å‹**ï¼šæ ¹æ®æ•°æ®åº“ä¸­çš„æ¼æ´ç±»å‹å­—æ®µã€‚
2.  **é€‰æ‹©éªŒè¯å·¥å…·**ï¼šä¸ºä¸åŒç±»å‹çš„æ¼æ´é€‰æ‹©åˆé€‚çš„å¼€æºéªŒè¯å·¥å…·ï¼ˆå¦‚SQLMapç”¨äºSQLæ³¨å…¥ï¼ŒXSStrikeç”¨äºXSSï¼‰ã€‚
3.  **æå–å¹¶ä¼ é€’å‚æ•°**ï¼šä»æ•°æ®åº“è®°å½•ä¸­æå–å·¥å…·æ‰€éœ€çš„å‚æ•°ï¼ˆå¦‚URLã€è¯·æ±‚æ•°æ®ã€æ”»å‡»ç‚¹ï¼‰ã€‚
4.  **è°ƒç”¨å·¥å…·å¹¶è§£æç»“æœ**ï¼šæ‰§è¡ŒéªŒè¯å‘½ä»¤ï¼Œå¹¶åˆ¤æ–­è¾“å‡ºä¸­æ˜¯å¦åŒ…å«æˆåŠŸæ ‡è¯†ã€‚

**å…³é”®ç‚¹**ï¼šå¯¹äºSQLæ³¨å…¥ï¼Œéœ€è¦æ³¨æ„ `proof` å­—æ®µä¸­çš„æ”»å‡»è½½è·å¯èƒ½è¿‡é•¿ã€‚æœ‰æ—¶éœ€è¦å°†å…¶æ›¿æ¢ä¸ºæ•°æ®åº“ `attack` å­—æ®µä¸­è®°å½•çš„åŸå§‹å‚æ•°å€¼ï¼Œæ‰èƒ½æˆåŠŸéªŒè¯ã€‚ä¾‹å¦‚ï¼Œå°† `proof` ä¸­çš„ `1â€˜ AND â€˜1â€˜=â€˜1` æ›¿æ¢ä¸º `attack` ä¸­çš„åŸå§‹å€¼ `rot`ã€‚

**ç¤ºä¾‹ï¼šéªŒè¯XSSæ¼æ´**
å¯ä»¥ä¿®æ”¹ç°æœ‰XSSå·¥å…·ï¼ˆå¦‚XSStrikeï¼‰ï¼Œä½¿å…¶æ”¯æŒä»å‘½ä»¤è¡Œæ¥æ”¶å‚æ•°ï¼Œå¹¶ä¼˜åŒ–å…¶å¯¹æ— å‚æ•°XSSçš„æ£€æµ‹é€»è¾‘ã€‚
```bash
# ä¿®æ”¹åçš„å·¥å…·è°ƒç”¨æ–¹å¼
python xsstrike.py -u â€œhttp://target.com/page?msg=<script>alert(1)</script>â€œ
```

![](img/c9caf156e3d92e984692837ed60f2d4c_144.png)

**ç¤ºä¾‹ï¼šéªŒè¯SQLæ³¨å…¥æ¼æ´**
å°†æ•°æ®åº“ä¸­çš„ `request` å­—æ®µä¿å­˜ä¸ºæ–‡ä»¶ï¼Œç„¶åä½¿ç”¨SQLMapè¿›è¡Œæµ‹è¯•ã€‚
```bash
# å°†è¯·æ±‚æ•°æ®ä¿å­˜åˆ°æ–‡ä»¶ req.txt
# ä½¿ç”¨sqlmapæµ‹è¯•
sqlmap -r req.txt --batch
```

### ç¼–å†™è‡ªåŠ¨åŒ–éªŒè¯è„šæœ¬

![](img/c9caf156e3d92e984692837ed60f2d4c_146.png)

å¯ä»¥ç¼–å†™ä¸€ä¸ªä¸»è„šæœ¬ï¼Œè‡ªåŠ¨å®Œæˆä»¥ä¸‹æµç¨‹ï¼š
1.  æŸ¥è¯¢æ•°æ®åº“ï¼Œè·å–æ–°æ¼æ´ã€‚
2.  æ ¹æ®æ¼æ´ç±»å‹åˆ†å‘åˆ°ä¸åŒçš„éªŒè¯å­å‡½æ•°ã€‚
3.  è°ƒç”¨ç›¸åº”çš„å®‰å…¨å·¥å…·è¿›è¡ŒéªŒè¯ã€‚
4.  å°†éªŒè¯ç»“æœï¼ˆç¡®è®¤çš„æ¼æ´ã€è¯¯æŠ¥ï¼‰è®°å½•åˆ°æŠ¥å‘Šæ–‡ä»¶ä¸­ã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_148.png)

å¯¹äºéªŒè¯å¤±è´¥çš„æ¡ˆä¾‹ï¼Œå¯ä»¥é›†æˆç»•è¿‡è„šæœ¬ï¼ˆå¦‚å°†ç©ºæ ¼æ›¿æ¢ä¸ºæ³¨é‡Šç¬¦`/**/`ï¼‰è¿›è¡ŒäºŒæ¬¡å°è¯•ã€‚

---

![](img/c9caf156e3d92e984692837ed60f2d4c_150.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_151.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_153.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_155.png)

## æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ ğŸ“

![](img/c9caf156e3d92e984692837ed60f2d4c_157.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_159.png)

åœ¨åˆ©ç”¨æ‰«æå™¨è¿›è¡Œè‡ªåŠ¨åŒ–æŒ–æ´æ—¶ï¼Œè¯·åŠ¡å¿…æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

![](img/c9caf156e3d92e984692837ed60f2d4c_161.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_163.png)

1.  **æ¸…é™¤æ‰«æå™¨ç‰¹å¾**ï¼šæ‰«æå™¨å‘å‡ºçš„è¯·æ±‚å¤´ä¸­å¯èƒ½åŒ…å«ç‰¹å®šæ ‡è¯†ï¼ˆå¦‚`Acunetix`ï¼‰ã€‚è¿™äº›ç‰¹å¾å®¹æ˜“è¢«WAFè¯†åˆ«å¹¶æ‹¦æˆªã€‚å¯ä»¥é€šè¿‡ä»£ç†å·¥å…·ï¼ˆå¦‚Burp Suiteï¼‰ä¿®æ”¹æˆ–æ¸…é™¤è¿™äº›è¯·æ±‚å¤´ã€‚
2.  **å…³æ³¨éæ ‡å‡†ç«¯å£**ï¼šä¸è¦åªæ‰«æ80/443ç«¯å£ã€‚è®¸å¤šHTTPæœåŠ¡å¯èƒ½è¿è¡Œåœ¨å…¶ä»–ç«¯å£ä¸Šï¼Œå®ƒä»¬ä¹Ÿå¯èƒ½å­˜åœ¨æ¼æ´ã€‚
3.  **ä½¿ç”¨æµ‹è¯•è´¦å·**ï¼šå¦‚æœé…ç½®äº†è‡ªåŠ¨ç™»å½•æ‰«æï¼ŒåŠ¡å¿…ä½¿ç”¨æµ‹è¯•è´¦å·ï¼Œé¿å…çˆ¬è™«å¯¹çœŸå®è´¦æˆ·æ•°æ®é€ æˆæ„å¤–ä¿®æ”¹æˆ–åˆ é™¤ã€‚
4.  **æ§åˆ¶æ‰«æé¢‘ç‡**ï¼šé¿å…å¯¹ç›®æ ‡ç½‘ç«™é€ æˆè¿‡å¤§å‹åŠ›ï¼Œå½±å“å…¶æ­£å¸¸ä¸šåŠ¡ã€‚è®¾ç½®è¾ƒä½çš„æ‰«æé€Ÿåº¦ã€‚
5.  **æœ¬åœ°æ­å»ºæµ‹è¯•ç¯å¢ƒ**ï¼šå¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨å¼€æºCMS/æ¡†æ¶ï¼Œå¯åœ¨æœ¬åœ°æ­å»ºç›¸åŒç¯å¢ƒè¿›è¡Œæ‰«æã€‚è¿™æ ·é€Ÿåº¦æ›´å¿«ï¼Œä¸”æ²¡æœ‰WAFå¹²æ‰°ï¼Œå‘ç°æ¼æ´åå¯ç›´æ¥åœ¨çœŸå®ç½‘ç«™ä¸ŠéªŒè¯ã€‚
6.  **ç†è§£è¯¯æŠ¥ä¸æ¼æŠ¥**ï¼šæ²¡æœ‰ä»»ä½•æ‰«æå™¨èƒ½å‘ç°æ‰€æœ‰æ¼æ´ã€‚ä¸è¦å› ä¸ºæ‰«æå™¨æ²¡æœ‰æŠ¥é”™å°±è®¤ä¸ºç½‘ç«™ç»å¯¹å®‰å…¨ã€‚é«˜è´¨é‡çš„æ¼æ´å¾€å¾€éœ€è¦ç»“åˆæ‰‹å·¥æµ‹è¯•ã€‚
7.  **ä¿¡æ¯æ”¶é›†**ï¼šæ‰«æå™¨ç»“æœä¸ä»…æ˜¯æ¼æ´ï¼Œä¹ŸåŒ…å«æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼ˆå¦‚é‚®ç®±ã€IPã€æ–‡ä»¶è·¯å¾„ï¼‰ã€‚å¯ä»¥åˆ©ç”¨è¿™äº›æ•°æ®è¿›è¡Œæ›´æ·±åº¦çš„ä¿¡æ¯æ”¶é›†ã€‚

---

## æ€»ç»“ ğŸ¯

æœ¬èŠ‚è¯¾æˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†è‡ªåŠ¨åŒ–æ¼æ´æŒ–æ˜ä¸­æ‰«æå™¨çš„é«˜çº§ç”¨æ³•ã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_165.png)

![](img/c9caf156e3d92e984692837ed60f2d4c_166.png)

1.  **APIè‡ªåŠ¨åŒ–**ï¼šæˆ‘ä»¬æŒæ¡äº†å¦‚ä½•é€šè¿‡Pythonè„šæœ¬è°ƒç”¨æ‰«æå™¨APIï¼Œå®ç°ç›®æ ‡çš„æ‰¹é‡æ·»åŠ ã€å‚æ•°é…ç½®å’Œæ‰«æå¯åŠ¨ï¼Œä»è€Œå°†æ‰«æå™¨é›†æˆåˆ°è‡ªåŠ¨åŒ–å·¥ä½œæµä¸­ã€‚
2.  **æ•°æ®åº“æ“ä½œ**ï¼šæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ç›´æ¥è¿æ¥æ‰«æå™¨çš„PostgreSQLæ•°æ®åº“ï¼Œä»ä¸­æå–è¯¦ç»†çš„æ¼æ´ä¿¡æ¯ï¼Œå¹¶åŸºäºè¿™äº›ä¿¡æ¯ç¼–å†™è‡ªåŠ¨éªŒè¯è„šæœ¬ï¼Œæ˜¾è‘—æé«˜äº†æ¼æ´ç¡®è®¤çš„æ•ˆç‡ã€‚
3.  **å®è·µæŠ€å·§**ï¼šæˆ‘ä»¬æ¢è®¨äº†æ¸…é™¤æ‰«æç‰¹å¾ã€å¤„ç†éæ ‡å‡†ç«¯å£ã€ä½¿ç”¨æµ‹è¯•è´¦å·ã€æœ¬åœ°æµ‹è¯•ç­‰ä¸€ç³»åˆ—æœ€ä½³å®è·µï¼Œä»¥ç¡®ä¿è‡ªåŠ¨åŒ–è¿‡ç¨‹æ—¢é«˜æ•ˆåˆè´Ÿè´£ä»»ã€‚

![](img/c9caf156e3d92e984692837ed60f2d4c_168.png)

è®°ä½ï¼Œæ‰«æå™¨æ˜¯å¼ºå¤§çš„è¾…åŠ©å·¥å…·ï¼Œä½†æ— æ³•æ›¿ä»£å®‰å…¨ç ”ç©¶å‘˜çš„æ‰‹å·¥æµ‹è¯•å’Œæ·±å…¥åˆ†æã€‚å°†è‡ªåŠ¨åŒ–ä¸æ‰‹å·¥æµ‹è¯•ç›¸ç»“åˆï¼Œæ‰èƒ½æœ€å¤§åŒ–æŒ–æ´çš„æ·±åº¦å’Œå¹¿åº¦ã€‚