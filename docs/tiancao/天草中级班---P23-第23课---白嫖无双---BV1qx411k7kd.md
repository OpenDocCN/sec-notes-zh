# 天草中级班 - P23：第23课 - 白嫖无双 - BV1qx411k7kd

大家好，这节课我们来做一个脱口破解的，就是这么一个程序，它这个口是address-protect，这个口和这个口不同的，虽然说作者是一个，但是这个保护强度明显要强很多，这是我脱口的，我就删掉。

先来看一下这个什么东西。

![](img/1d0664eebbaab20063026fd242b97566_1.png)

我们先Od载入，Od载入之后。

![](img/1d0664eebbaab20063026fd242b97566_3.png)

就是这个样子了，先单步走，大家看到，它这个是往回跳，再看一下这些结构就知道，这里是解码了，解码，我们在这个地方下FL段点，分析一下，这个里面有非常非常多的花指令，大家看一下这里，2966，就是石精制的。

然后ECX16进入B96，我们来F9运行一下，它就减一次，循环解码，它这里是循环解码了，大家可能会说，难道就按这么多次，我们可以用另外的方法，我们先跳过这个解码看一下，修改一下F9。



![](img/1d0664eebbaab20063026fd242b97566_5.png)

过来了，过来了，然后打开内存景象，首先忽略一下，忽略所有的，在这个区段下这个段点。

![](img/1d0664eebbaab20063026fd242b97566_7.png)

再运行一下。

![](img/1d0664eebbaab20063026fd242b97566_9.png)

这个内存访问段点不行。

![](img/1d0664eebbaab20063026fd242b97566_11.png)

我们直接，直接下FL段点，大家看到这里了，这里就是一堆乱码了，是从这个跳转跳过来了，我们看一下这里，这个有一个S1巨饼，我们用在会变中跟随，到这里来，FL下段点，shift+F9，大家慢慢走，这里的。

EDI里面的值就是我们的OEP了，EDI里面的值就是我们的OEP，我们直接到OEP去，FL下段点，shift+F9运行中断，此时我们就可以脱壳了，打开import REC。



![](img/1d0664eebbaab20063026fd242b97566_13.png)

打开import REC，打开import REC，打开import REC。

![](img/1d0664eebbaab20063026fd242b97566_15.png)

打开import REC，有非常非常多的无效啊，我们用点击一下，一下子就全部修复好了，来看一下，是Darvid啊。



![](img/1d0664eebbaab20063026fd242b97566_17.png)

开始运行。

![](img/1d0664eebbaab20063026fd242b97566_19.png)

我们载入脱壳后的文件。

![](img/1d0664eebbaab20063026fd242b97566_21.png)

大家看到了啊。

![](img/1d0664eebbaab20063026fd242b97566_23.png)

![](img/1d0664eebbaab20063026fd242b97566_24.png)

他这个有这么多锁啊，全部都锁住了，就是说，如果你没有注册的话，这个锁全部都锁了啊，全部都被锁住了，就是这些功能啊，这些功能全部都被锁住了，大家看到了，I'm sorry啊，就是说你需要安装这些包的话。

I'm sorry就是你这是一个试用版啊，然后，关掉啊，好，我们来看一下。

![](img/1d0664eebbaab20063026fd242b97566_26.png)

他这有这个什么特征，有个Tarot的，我们搜索一下周创，搜索了一个，这一个，看下后下面还有没有，这里也有啊，有两个啊，有两个啊，我们再重新来，到第一个那里去啊，第一个这里。



![](img/1d0664eebbaab20063026fd242b97566_28.png)

那么这个呢，这里的这个啊，就是一个我们的，一个关键了，一个关键，大家看到了，Foo，Tarot，我们在这个地方下好断电，下好断电，这个关掉啊。



![](img/1d0664eebbaab20063026fd242b97566_30.png)

Shift+F就直接运行，把这个勾勾全部都打上啊。

![](img/1d0664eebbaab20063026fd242b97566_32.png)

免得影响我们我们那个运行，下面提示这个异常啊，Shift+F9，点About这里面啊，再点。

![](img/1d0664eebbaab20063026fd242b97566_34.png)

点他这个时候呢就断下来了，我们看一下，这里是什么，Al，TaxAl，GNG了，就是说如果我们这个地方啊，我们这个地方，如果Al=0的话，不等于0，他就跳了，不等于0他就跳，但他如果等于0的话就没有跳了。

那我们这里是要求啊，要求他不等于0，不等于0我们进去看一下，主要看一下啊，主要看一下，这个Al的来源，Al的来源，我拿到最下面来就知道，Al的来源是哪一些了，大家看到了啊，这个Al是由eBP-2来的。

eBP-2来的，我们在这个地方下好断，我们来看，往上面找一下，eBP-2，eBP-2是怎么样，是多少呢，看一下，这里有一个eBP-2是0，我们在这个地方下好断，大家看到了，是0。

然后下面自然我们把它改成1，改成1之后啊，然后再运行一下，到这里来，然后eBP-2=1。

![](img/1d0664eebbaab20063026fd242b97566_36.png)

然后单步一下，1=1，这样就跳过来了，我们把它给复制一下，看一下能否达到完全。

![](img/1d0664eebbaab20063026fd242b97566_38.png)

显示维护啊。

![](img/1d0664eebbaab20063026fd242b97566_40.png)

![](img/1d0664eebbaab20063026fd242b97566_41.png)

显示维护啊，这些锁都没有了，我们来看一下，可以啊，这些，看有没有，这都可以了，都可以，双击一个，随便双击一个进去都可以了，这是一个。



![](img/1d0664eebbaab20063026fd242b97566_43.png)

应该是网页制作的，非常好的一个软件，非常好的一个软件。

![](img/1d0664eebbaab20063026fd242b97566_45.png)

可以了，我们刚才看到了。

![](img/1d0664eebbaab20063026fd242b97566_47.png)

它有两个Tera的，两个Tera的，我们现在来找一下，看一下另外一个Tera的行不行，这里有一个，这是我们刚才找到的一个，然后接L，看就加L，再找，这里有一个。



![](img/1d0664eebbaab20063026fd242b97566_49.png)

我们双击进去，这里的，这里的，好，F9运行，F9运行，直接中断下来，直接就中断下来了，现在我们来进去，这里的结构跟刚才的差不多，看一下结构差不多，我们来把这里改一下，改一下，一样的，一样的，在于。

为复活的，我看这个里面的，复活的，复活的，我们进去。

![](img/1d0664eebbaab20063026fd242b97566_51.png)

再来把这个复制下来，这两种都一样。

![](img/1d0664eebbaab20063026fd242b97566_53.png)

看到这一启动就显示为复活的。

![](img/1d0664eebbaab20063026fd242b97566_55.png)

![](img/1d0664eebbaab20063026fd242b97566_56.png)

都可以用。

![](img/1d0664eebbaab20063026fd242b97566_58.png)

没有锁住了。

![](img/1d0664eebbaab20063026fd242b97566_60.png)

我们来看一下这个，也是一样的。

![](img/1d0664eebbaab20063026fd242b97566_62.png)

这两种破解都达到完成。

![](img/1d0664eebbaab20063026fd242b97566_64.png)

达到了一个，达到就是我们的一个目的了。

![](img/1d0664eebbaab20063026fd242b97566_66.png)

大家下去之后，再去试一下，看一下有没有其他的方法，有没有其他的方法可以，可以用，当然我们这个方法只是一个，解除一个限制的一个作用，今天这个课程就到这，再见，加上这个课，这个课，在看写上面。

看写上面就是有关于这方面一些文章，我感觉这个，这个程序，这个程序，应该是没有使用最强，没有使用最紧，一些保护选项，要使用了的话，他可能会造成我们假使几，一些现象，大家自己再找一些资料看一下，好。



![](img/1d0664eebbaab20063026fd242b97566_68.png)

再见。