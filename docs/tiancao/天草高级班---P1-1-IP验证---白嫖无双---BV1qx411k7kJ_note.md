# 天草高级班 - P1：IP验证破解实战 🛡️

![](img/a9e28ddaa99f76ac5a385dbb908a5705_1.png)

在本节课中，我们将学习针对一个带有IP验证功能的内部软件进行破解。课程将演示三种不同的破解思路，从跟踪按钮事件到修改程序逻辑，帮助你理解网络验证程序的基本分析方法。

![](img/a9e28ddaa99f76ac5a385dbb908a5705_3.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_5.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_7.png)

## 概述与程序初探

![](img/a9e28ddaa99f76ac5a385dbb908a5705_9.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_11.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_13.png)

本节课分析的软件是一个公司内部使用的同步更新程序，其启动后会出现一个登录验证窗口。窗口包含服务器选择（默认为灰色不可选）和密码输入框。

![](img/a9e28ddaa99f76ac5a385dbb908a5705_15.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_17.png)

首先，我们使用反汇编工具（如OD）载入程序。目标是找到验证逻辑的入口点。

![](img/a9e28ddaa99f76ac5a385dbb908a5705_19.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_21.png)

## 第一种破解方法：跟踪验证按钮

![](img/a9e28ddaa99f76ac5a385dbb908a5705_23.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_25.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_27.png)

第一种思路是从“验证”按钮的事件处理代码开始跟踪，定位关键判断并修改其逻辑。

![](img/a9e28ddaa99f76ac5a385dbb908a5705_29.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_30.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_32.png)

以下是分析步骤：

![](img/a9e28ddaa99f76ac5a385dbb908a5705_34.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_36.png)

1.  在反汇编工具中查找与“验证”按钮相关的字符串或事件。
2.  在验证按钮的事件处理函数入口处设置断点。
3.  运行程序，输入任意密码并点击“验证”，程序会在断点处暂停。
4.  单步执行代码，观察程序流程。重点留意 `CMP`（比较）和 `JZ`/`JNZ`（条件跳转）等指令。
5.  会发现一个关键比较：程序将某个寄存器（例如 `EAX`）的值与 `1` 进行比较。
    ```assembly
    CMP EAX, 1
    JZ 验证成功跳转地址
    ```
6.  此处的逻辑是：如果 `EAX == 1` 则跳向验证成功的流程，否则验证失败。我们的目标就是让程序执行这个跳转。
7.  修改方法：可以将 `CMP EAX, 1` 的结果强行设置为相等。一种常见做法是将其上方的、决定 `EAX` 值的指令改为 `MOV EAX, 1`。或者，直接修改关键跳转指令 `JZ` 为无条件跳转 `JMP`。
8.  修改后保存，程序即可实现输入任意密码通过验证。

上一节我们介绍了通过跟踪按钮事件进行破解的方法，本节我们来看看另一种更巧妙的思路。

## 第二种破解方法：转换按钮功能

![](img/a9e28ddaa99f76ac5a385dbb908a5705_38.png)

第二种思路利用了登录窗口的另一个按钮——“取消”。通过修改程序对“取消”按钮的响应逻辑，使其执行“验证通过”的流程。

![](img/a9e28ddaa99f76ac5a385dbb908a5705_40.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_42.png)

以下是分析步骤：

![](img/a9e28ddaa99f76ac5a385dbb908a5705_44.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_46.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_48.png)

1.  程序启动时，会调用创建登录框的函数。在此函数调用之后设置断点。
2.  运行程序，程序暂停后，观察栈和代码流程。会发现登录框显示后，程序根据用户点击的按钮（验证或取消）返回不同的值。
3.  通常，点击“取消”按钮会触发一个退出程序的流程。找到这个关键跳转。
    ```assembly
    TEST EAX, EAX
    JZ 退出流程地址
    ```
4.  此处的逻辑是：如果返回值为0（可能代表点击取消），则跳转到退出流程。我们只需将这个跳转指令 `JZ` 改为 `JNZ`（非零则跳），或者直接 `NOP`（空操作）掉，即可使点击“取消”按钮后不退出，而是继续执行（相当于验证通过）。
5.  修改后，点击“取消”按钮即可直接进入程序主界面。

![](img/a9e28ddaa99f76ac5a385dbb908a5705_50.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_51.png)

前面两种方法都需要与界面交互，本节我们学习第三种更底层、更彻底的方法。

![](img/a9e28ddaa99f76ac5a385dbb908a5705_53.png)

## 第三种破解方法：拦截登录框调用

![](img/a9e28ddaa99f76ac5a385dbb908a5705_55.png)

第三种思路是在程序调用创建登录对话框的函数时进行拦截，直接跳过该调用，使登录框根本不出现。

![](img/a9e28ddaa99f76ac5a385dbb908a5705_57.png)

以下是分析步骤：

![](img/a9e28ddaa99f76ac5a385dbb908a5705_59.png)

1.  在反汇编工具中，查找类似 `Call CreateDialog` 或 `Call DialogBox` 的系统API调用。
2.  在该调用指令处设置断点。
3.  运行程序，程序会在此处暂停。此时，我们可以修改函数调用的返回结果，或者直接跳过整个调用。
4.  一种有效的方法是：将调用登录框函数的 `CALL` 指令替换为 `NOP` 指令，或者修改其参数和返回地址，使其立即返回一个表示“验证成功”的值。
5.  例如，找到调用后，不执行该 `CALL`，而是直接设置 `EAX` 寄存器为1（假设1代表成功），然后跳转到验证通过后的代码地址。
    ```assembly
    ; 原指令
    CALL 创建登录框函数
    ; 修改为
    MOV EAX, 1 ; 模拟验证成功
    JMP 验证成功后的地址
    ```
6.  这样，程序启动后将不再显示登录窗口，直接进入主界面。

![](img/a9e28ddaa99f76ac5a385dbb908a5705_61.png)

## 总结与思路提炼

![](img/a9e28ddaa99f76ac5a385dbb908a5705_63.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_65.png)

本节课中，我们一起学习了针对一个IP验证程序的三种破解方法：

![](img/a9e28ddaa99f76ac5a385dbb908a5705_67.png)

1.  **跟踪按钮法**：从用户界面交互点入手，逆向跟踪验证逻辑，修改关键判断条件。
2.  **功能转换法**：利用程序已有的其他交互路径（如取消按钮），修改其内部逻辑，使其达到验证通过的目的。
3.  **调用拦截法**：在更底层拦截创建验证界面的系统调用，从根本上阻止验证窗口的出现。

![](img/a9e28ddaa99f76ac5a385dbb908a5705_69.png)

![](img/a9e28ddaa99f76ac5a385dbb908a5705_71.png)

这三种方法体现了软件破解中由表及里、从界面到核心的不同层次思路。它们不仅适用于本例的IP验证，也是分析各类网络验证、外挂保护程序的通用技巧。核心在于灵活运用反汇编工具，理解程序流程与控制流，并针对关键点进行精准修改。请注意，本教程仅用于安全技术研究学习，请勿用于非法用途。