# 天草高级班 - P13：ACProtect不脱壳补丁实战 🛡️

在本节课中，我们将学习如何对一款名为“台湾热血英雄”的、受ACProtect强壳保护的外挂程序进行不脱壳破解。核心目标是绕过其账号激活验证，使未激活账号也能登录使用。我们将通过定位关键跳转并打补丁的方式完成。

## 环境准备与问题分析

![](img/ea59389aded0e9e4f47902019edef3f5_1.png)

要使目标程序运行，首先需要将六个必需的DLL文件复制到程序目录下。

![](img/ea59389aded0e9e4f47902019edef3f5_2.png)

![](img/ea59389aded0e9e4f47902019edef3f5_3.png)

该外挂原本设计为必须使用已激活的账号才能登录。我们的破解目标是将它修改为未激活账号也能登录。程序在登录时需要使用代理服务器，但课程演示中提供的代理已经失效。不过，即使代理失效、界面提示“无效账号”，只要完成正确的破解，程序依然可以成功登录。

![](img/ea59389aded0e9e4f47902019edef3f5_5.png)

## 破解思路与定位

目标程序使用了ACProtect强壳。完美脱壳并修复程序较为繁琐，且可能产生跨平台兼容性问题（例如在自己电脑上可用，在其他电脑上不可用）。因此，我们选择不脱壳，直接对加壳后的程序打补丁。

![](img/ea59389aded0e9e4f47902019edef3f5_7.png)

上一节我们分析了程序的基本情况，本节中我们来看看如何定位关键代码。

![](img/ea59389aded0e9e4f47902019edef3f5_9.png)

由于程序加壳，直接搜索中文字符串“无效账号”是无效的。需要使用特定的插件（如“字幕圈插件”）来查找中文字符串引用，或者搜索其英文提示。

![](img/ea59389aded0e9e4f47902019edef3f5_11.png)

通过分析，我们发现该外挂虽然有两层验证，但只需修改一个关键跳转即可绕过。这个跳转位于“登录失败”的逻辑判断处。

![](img/ea59389aded0e9e4f47902019edef3f5_13.png)

![](img/ea59389aded0e9e4f47902019edef3f5_15.png)

以下是定位和修改的关键步骤：

1.  使用调试器附加已加壳的程序。
2.  借助插件或搜索英文文本，定位到与登录验证相关的代码区域。
3.  找到判断登录失败并跳转的指令。在本次案例中，其地址是 `40503`。
4.  该处的跳转指令原本在验证失败时执行，我们需要将其修改为无条件跳转（JMP），直接跳过失败处理流程。

![](img/ea59389aded0e9e4f47902019edef3f5_17.png)

核心修改是将原验证跳转改为强制跳转，代码形式如下：
```
原指令：JNZ 某地址  ; 如果非零（验证失败）则跳转到失败处理
修改为：JMP 某地址  ; 无条件跳转到成功流程
```
在地址 `40503` 处，实际是将其改为 `JMP` 到登录成功的代码段。

![](img/ea59389aded0e9e4f47902019edef3f5_19.png)

## 补丁制作与验证

![](img/ea59389aded0e9e4f47902019edef3f5_21.png)

找到地址 `40503` 处的“登录失败”跳转后，将其修改为 `JMP` 指令即可完成核心破解。

![](img/ea59389aded0e9e4f47902019edef3f5_23.png)

![](img/ea59389aded0e9e4f47902019edef3f5_25.png)

![](img/ea59389aded0e9e4f47902019edef3f5_26.png)

修改后，程序运行时可能仍会显示“无效账号”的提示（因为代理失效或提示逻辑未修改），但登录功能已经可以正常使用。

![](img/ea59389aded0e9e4f47902019edef3f5_28.png)

![](img/ea59389aded0e9e4f47902019edef3f5_30.png)

此外，程序还有一个“派系”或功能限制，原设计只能在游戏内使用。我们可以通过类似的方法定位并修改另一处限制判断（例如在地址 `489D` 附近），将其改为始终允许，从而解除该限制。

![](img/ea59389aded0e9e4f47902019edef3f5_31.png)

![](img/ea59389aded0e9e4f47902019edef3f5_33.png)

以下是完整的操作回顾列表：

![](img/ea59389aded0e9e4f47902019edef3f5_35.png)

![](img/ea59389aded0e9e4f47902019edef3f5_37.png)

*   **定位关键点**：在加壳程序中，通过插件辅助查找字符串，定位到登录验证函数。
*   **修改跳转**：将验证失败跳转（如 `JNZ`）修改为无条件跳转（`JMP`）。
*   **解除限制**：搜索并修改其他功能限制判断，扩大程序使用范围。
*   **测试验证**：寻找有效的台湾地区SOCKS5代理进行功能测试（注意：HTTP代理可能无效）。

![](img/ea59389aded0e9e4f47902019edef3f5_39.png)

![](img/ea59389aded0e9e4f47902019edef3f5_41.png)

## 总结与提醒

![](img/ea59389aded0e9e4f47902019edef3f5_43.png)

本节课中，我们一起学习了针对ACProtect强壳保护程序的不脱壳补丁技术。我们分析了外挂的验证逻辑，定位到核心的登录判断跳转（地址 `40503`），并通过将其修改为 `JMP` 指令，成功绕过了账号激活验证。同时，也简要介绍了如何解除程序的其他功能限制。

需要强调的是，此类破解方法仅供安全技术研究学习使用。请勿将技术用于非法用途或广泛传播，以免对软件开发者造成损害，并可能带来法律风险。

![](img/ea59389aded0e9e4f47902019edef3f5_45.png)

> 关注“星空识别者”的单元！