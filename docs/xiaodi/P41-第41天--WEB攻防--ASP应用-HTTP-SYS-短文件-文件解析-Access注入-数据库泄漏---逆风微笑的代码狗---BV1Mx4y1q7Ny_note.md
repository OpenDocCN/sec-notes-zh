![](img/417bd6c721484af32634ece3a6cedfe1_0.png)

# è¯¾ç¨‹P41ï¼šASPåº”ç”¨å®‰å…¨æ”»é˜²åŸºç¡€ ğŸ”

åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ASPï¼ˆActive Server Pagesï¼‰åº”ç”¨ç›¸å…³çš„å®‰å…¨åŸºç¡€çŸ¥è¯†ã€‚ASPæ˜¯ä¸€ç§è¾ƒæ—©æœŸçš„æœåŠ¡å™¨ç«¯è„šæœ¬æŠ€æœ¯ï¼Œè™½ç„¶ç°åœ¨å·²ä¸å¸¸è§ï¼Œä½†åœ¨ä¸€äº›é—ç•™ç³»ç»Ÿä¸­ä»å¯èƒ½å­˜åœ¨ã€‚äº†è§£å…¶å®‰å…¨ç‰¹æ€§æœ‰åŠ©äºæˆ‘ä»¬åº”å¯¹å¯èƒ½é‡åˆ°çš„è€æ—§ç³»ç»Ÿã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_2.png)

![](img/417bd6c721484af32634ece3a6cedfe1_4.png)

![](img/417bd6c721484af32634ece3a6cedfe1_6.png)

![](img/417bd6c721484af32634ece3a6cedfe1_8.png)

![](img/417bd6c721484af32634ece3a6cedfe1_9.png)

æˆ‘ä»¬å°†ä»ASPä¸Accessæ•°æ®åº“çš„å…¸å‹ç»„åˆå¼€å§‹ï¼Œæ¢è®¨ç”±æ­¤å¼•å‘çš„é»˜è®¤æ•°æ®åº“æ³„éœ²é—®é¢˜ã€‚æ¥ç€ï¼Œæˆ‘ä»¬ä¼šåˆ†æè¿è¡ŒASPçš„IISï¼ˆInternet Information Servicesï¼‰ä¸­é—´ä»¶ä¸Šçš„ä¸€äº›ç»å…¸æ¼æ´ï¼Œå¦‚HTTP.SYSè¿œç¨‹è“å±æ¼æ´ã€çŸ­æ–‡ä»¶åä¿¡æ¯æ³„éœ²å’Œæ–‡ä»¶è§£ææ¼æ´ã€‚æœ€åï¼Œæˆ‘ä»¬ä¼šé€šè¿‡ä¸€ä¸ªå®æˆ˜æ¡ˆä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•åˆ©ç”¨Accessæ•°æ®åº“æ³¨å…¥æ¼æ´è·å–åå°æƒé™ï¼Œå¹¶ç»“åˆæ–‡ä»¶ä¸Šä¼ ä¸è§£ææ¼æ´è·å–æœåŠ¡å™¨æ§åˆ¶æƒã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_11.png)

![](img/417bd6c721484af32634ece3a6cedfe1_13.png)

![](img/417bd6c721484af32634ece3a6cedfe1_15.png)

![](img/417bd6c721484af32634ece3a6cedfe1_17.png)

![](img/417bd6c721484af32634ece3a6cedfe1_18.png)

![](img/417bd6c721484af32634ece3a6cedfe1_20.png)

![](img/417bd6c721484af32634ece3a6cedfe1_22.png)

---

![](img/417bd6c721484af32634ece3a6cedfe1_24.png)

![](img/417bd6c721484af32634ece3a6cedfe1_26.png)

![](img/417bd6c721484af32634ece3a6cedfe1_28.png)

![](img/417bd6c721484af32634ece3a6cedfe1_30.png)

![](img/417bd6c721484af32634ece3a6cedfe1_32.png)

## ASPä¸Accessæ•°æ®åº“çš„é»˜è®¤æ­å»ºé£é™© ğŸ’¾

![](img/417bd6c721484af32634ece3a6cedfe1_34.png)

![](img/417bd6c721484af32634ece3a6cedfe1_36.png)

![](img/417bd6c721484af32634ece3a6cedfe1_38.png)

![](img/417bd6c721484af32634ece3a6cedfe1_40.png)

![](img/417bd6c721484af32634ece3a6cedfe1_42.png)

![](img/417bd6c721484af32634ece3a6cedfe1_43.png)

![](img/417bd6c721484af32634ece3a6cedfe1_45.png)

![](img/417bd6c721484af32634ece3a6cedfe1_47.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬æ¦‚è¿°äº†è¯¾ç¨‹å†…å®¹ï¼Œæœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹ASPåº”ç”¨æœ€å¸¸è§çš„ä¸€ç§æ¶æ„ç»„åˆåŠå…¶å¸¦æ¥çš„å®‰å…¨é—®é¢˜ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_49.png)

![](img/417bd6c721484af32634ece3a6cedfe1_51.png)

![](img/417bd6c721484af32634ece3a6cedfe1_53.png)

![](img/417bd6c721484af32634ece3a6cedfe1_55.png)

ç”±äºASPç¨‹åºå¸¸ä¸Accessæ•°æ®åº“æ­é…ä½¿ç”¨ï¼Œè¿™ç§ç»„åˆå¤šè§äºä¸­å°å‹Webåº”ç”¨ã€‚Accessæ•°æ®åº“çš„ä¸€ä¸ªå…³é”®ç‰¹æ€§æ˜¯å®ƒæ— éœ€åƒMySQLé‚£æ ·è¿›è¡Œç‹¬ç«‹çš„è¿æ¥é…ç½®ï¼ˆå¦‚è®¾ç½®è´¦å·ã€å¯†ç ã€æ•°æ®åº“åï¼‰ã€‚å¼€å‘è€…é€šå¸¸åœ¨è„šæœ¬æ–‡ä»¶ä¸­ç›´æ¥å®šä¹‰å¥½æ•°æ®åº“æ–‡ä»¶çš„è·¯å¾„ï¼ˆä¾‹å¦‚ `database/#data.mdb`ï¼‰ï¼Œç¨‹åºå¯åŠ¨æ—¶ä¾¿ä¼šè‡ªåŠ¨ä½¿ç”¨è¯¥æ–‡ä»¶ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_57.png)

![](img/417bd6c721484af32634ece3a6cedfe1_59.png)

**ä»£ç ç¤ºä¾‹ï¼šæ•°æ®åº“è¿æ¥é…ç½®**
```asp
<%
db_path = "../database/#data.mdb"
Set conn = Server.CreateObject("ADODB.Connection")
conn.Open "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & Server.MapPath(db_path)
%>
```

![](img/417bd6c721484af32634ece3a6cedfe1_61.png)

![](img/417bd6c721484af32634ece3a6cedfe1_63.png)

è¿™ç§â€œå¼€ç®±å³ç”¨â€çš„ä¾¿åˆ©æ€§ä¹Ÿå¸¦æ¥äº†å®‰å…¨éšæ‚£ã€‚å¦‚æœå¼€å‘è€…åœ¨éƒ¨ç½²æ—¶æ²¡æœ‰ä¿®æ”¹é»˜è®¤çš„æ•°æ®åº“è·¯å¾„å’Œæ–‡ä»¶åï¼Œæ”»å‡»è€…ä¾¿å¯èƒ½ç›´æ¥é€šè¿‡æ„é€ URLæ¥ä¸‹è½½æ•°æ®åº“æ–‡ä»¶ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_65.png)

![](img/417bd6c721484af32634ece3a6cedfe1_67.png)

![](img/417bd6c721484af32634ece3a6cedfe1_69.png)

![](img/417bd6c721484af32634ece3a6cedfe1_70.png)

**é£é™©æˆå› ï¼š**
1.  æ•°æ®åº“æ–‡ä»¶ï¼ˆ.mdbï¼‰é€šå¸¸å­˜æ”¾åœ¨ç½‘ç«™ç›®å½•ä¸‹ã€‚
2.  è¿æ¥è·¯å¾„åœ¨æºç ä¸­å›ºå®šï¼Œéƒ¨ç½²æ—¶å®¹æ˜“è¢«å¿½ç•¥ä¿®æ”¹ã€‚
3.  Accessæ•°æ®åº“æ–‡ä»¶æ— éœ€å¯†ç å³å¯æ‰“å¼€ï¼Œå…¶ä¸­å¯èƒ½åŒ…å«ç®¡ç†å‘˜è´¦å·å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_72.png)

![](img/417bd6c721484af32634ece3a6cedfe1_74.png)

![](img/417bd6c721484af32634ece3a6cedfe1_76.png)

ä»¥ä¸‹æ˜¯åˆ©ç”¨æ­¤é£é™©çš„åŸºæœ¬æ­¥éª¤ï¼š
1.  é€šè¿‡ä¿¡æ¯æ”¶é›†æˆ–çŒœæµ‹ï¼Œç¡®å®šç›®æ ‡ç½‘ç«™ä½¿ç”¨æŸæ¬¾å·²çŸ¥çš„ASPå¼€æºç¨‹åºã€‚
2.  è·å–è¯¥ç¨‹åºçš„æºç ï¼Œæ‰¾åˆ°å…¶é»˜è®¤çš„æ•°æ®åº“è·¯å¾„ï¼ˆå¦‚ `/database/#data.mdb`ï¼‰ã€‚
3.  å°è¯•ç›´æ¥è®¿é—®è¯¥è·¯å¾„ï¼ˆæ³¨æ„URLç¼–ç ï¼Œ`#` éœ€ç¼–ç ä¸º `%23`ï¼‰ï¼Œä¸‹è½½æ•°æ®åº“æ–‡ä»¶ã€‚
4.  ä½¿ç”¨Office Accessæˆ–ç›¸å…³å·¥å…·æ‰“å¼€.mdbæ–‡ä»¶ï¼ŒæŸ¥æ‰¾ç®¡ç†å‘˜è¡¨ï¼ˆå¦‚ `admin`ï¼‰ï¼Œè·å–è´¦å·å¯†ç ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_78.png)

![](img/417bd6c721484af32634ece3a6cedfe1_80.png)

> **æ³¨æ„**ï¼šæ­¤æ¼æ´çš„åˆ©ç”¨å‰ææ˜¯ç½‘ç«™é‡‡ç”¨é»˜è®¤é…ç½®æœªä½œä¿®æ”¹ã€‚ä½†è®¸å¤šç¼ºä¹ç»éªŒçš„ç®¡ç†å‘˜æˆ–å¼€å‘è€…ç¡®å®ä¼šä¿æŒé»˜è®¤è®¾ç½®ã€‚

---

![](img/417bd6c721484af32634ece3a6cedfe1_82.png)

![](img/417bd6c721484af32634ece3a6cedfe1_84.png)

## IISä¸­é—´ä»¶ç›¸å…³æ¼æ´ âš™ï¸

![](img/417bd6c721484af32634ece3a6cedfe1_86.png)

![](img/417bd6c721484af32634ece3a6cedfe1_88.png)

![](img/417bd6c721484af32634ece3a6cedfe1_90.png)

![](img/417bd6c721484af32634ece3a6cedfe1_92.png)

äº†è§£äº†ASPåº”ç”¨çš„è‡ªèº«ç‰¹ç‚¹åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ‰¿è½½å®ƒçš„IISæœåŠ¡å™¨æœ¬èº«å­˜åœ¨çš„ä¸€äº›å†å²æ¼æ´ã€‚è¿™äº›æ¼æ´è™½ç„¶å¹´ä»½è¾ƒä¹…ï¼Œä½†åœ¨æœªåŠæ—¶æ›´æ–°çš„è€æ—§ç³»ç»Ÿä¸Šä¾ç„¶å¯èƒ½å­˜åœ¨ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_94.png)

![](img/417bd6c721484af32634ece3a6cedfe1_96.png)

![](img/417bd6c721484af32634ece3a6cedfe1_98.png)

![](img/417bd6c721484af32634ece3a6cedfe1_100.png)

![](img/417bd6c721484af32634ece3a6cedfe1_102.png)

![](img/417bd6c721484af32634ece3a6cedfe1_104.png)

### HTTP.SYSè¿œç¨‹è“å±æ¼æ´ï¼ˆMS15-034ï¼‰ğŸ’¥

![](img/417bd6c721484af32634ece3a6cedfe1_106.png)

![](img/417bd6c721484af32634ece3a6cedfe1_108.png)

è¿™æ˜¯ä¸€ä¸ª2015å¹´æŠ«éœ²çš„Windowsç³»ç»Ÿå±‚æ¼æ´ï¼Œå½±å“IISã€‚æ”»å‡»è€…å¯ä»¥å‘é€ç‰¹åˆ¶çš„HTTPè¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡æœåŠ¡å™¨ç³»ç»Ÿå´©æºƒã€è“å±å¹¶é‡å¯ã€‚è¯¥æ¼æ´å±äºæ‹’ç»æœåŠ¡ï¼ˆDoSï¼‰å‹ï¼Œè™½ç„¶ä¸èƒ½ç›´æ¥è·å–æƒé™ï¼Œä½†ç ´åæ€§è¾ƒå¼ºã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_110.png)

![](img/417bd6c721484af32634ece3a6cedfe1_112.png)

![](img/417bd6c721484af32634ece3a6cedfe1_113.png)

![](img/417bd6c721484af32634ece3a6cedfe1_115.png)

![](img/417bd6c721484af32634ece3a6cedfe1_117.png)

![](img/417bd6c721484af32634ece3a6cedfe1_119.png)

![](img/417bd6c721484af32634ece3a6cedfe1_121.png)

![](img/417bd6c721484af32634ece3a6cedfe1_123.png)

![](img/417bd6c721484af32634ece3a6cedfe1_125.png)

![](img/417bd6c721484af32634ece3a6cedfe1_127.png)

**å½±å“ç‰ˆæœ¬**ï¼šWindows 7, Windows Server 2008 R2, Windows 8, Windows Server 2012ç­‰ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_129.png)

![](img/417bd6c721484af32634ece3a6cedfe1_131.png)

**æ£€æµ‹ä¸åˆ©ç”¨**ï¼š
1.  **æ£€æµ‹**ï¼šä½¿ç”¨ `curl` å‘½ä»¤å‘é€ç‰¹å®šè¯·æ±‚å¤´ï¼Œæ ¹æ®è¿”å›çŠ¶æ€åˆ¤æ–­ã€‚
    ```bash
    curl -v http://ç›®æ ‡IP/ -H "Host: test" -H "Range: bytes=0-18446744073709551615"
    ```
    è‹¥è¿”å› `416 Requested Range Not Satisfiable`ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **åˆ©ç”¨**ï¼šä½¿ç”¨Metasploitç­‰æ¸—é€æµ‹è¯•æ¡†æ¶ä¸­çš„å¯¹åº”æ¨¡å—ï¼ˆå¦‚ `auxiliary/dos/http/ms15_034_ulonglongadd`ï¼‰è¿›è¡Œæ”»å‡»ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_133.png)

![](img/417bd6c721484af32634ece3a6cedfe1_135.png)

![](img/417bd6c721484af32634ece3a6cedfe1_137.png)

![](img/417bd6c721484af32634ece3a6cedfe1_139.png)

> **è­¦å‘Š**ï¼šæ­¤æ¼æ´åˆ©ç”¨ä¼šå¯¼è‡´ç›®æ ‡æœåŠ¡ä¸­æ–­ï¼Œåœ¨æˆæƒæµ‹è¯•ä¸­éœ€è°¨æ…ä½¿ç”¨ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_141.png)

![](img/417bd6c721484af32634ece3a6cedfe1_143.png)

![](img/417bd6c721484af32634ece3a6cedfe1_145.png)

![](img/417bd6c721484af32634ece3a6cedfe1_147.png)

![](img/417bd6c721484af32634ece3a6cedfe1_149.png)

![](img/417bd6c721484af32634ece3a6cedfe1_151.png)

![](img/417bd6c721484af32634ece3a6cedfe1_153.png)

### IISçŸ­æ–‡ä»¶åæ³„éœ²æ¼æ´ ğŸ“

![](img/417bd6c721484af32634ece3a6cedfe1_155.png)

![](img/417bd6c721484af32634ece3a6cedfe1_157.png)

![](img/417bd6c721484af32634ece3a6cedfe1_159.png)

![](img/417bd6c721484af32634ece3a6cedfe1_161.png)

![](img/417bd6c721484af32634ece3a6cedfe1_163.png)

![](img/417bd6c721484af32634ece3a6cedfe1_165.png)

![](img/417bd6c721484af32634ece3a6cedfe1_167.png)

æ­¤æ¼æ´å…è®¸æ”»å‡»è€…çŒœè§£æœåŠ¡å™¨ä¸Šå­˜åœ¨çš„æ–‡ä»¶å’Œç›®å½•åï¼ˆä»…å‰6ä½å­—ç¬¦ï¼‰ï¼Œå¯ç”¨äºæ¢æµ‹åå°ç®¡ç†è·¯å¾„ã€é…ç½®æ–‡ä»¶æˆ–æ•°æ®åº“æ–‡ä»¶ç­‰æ•æ„Ÿä¿¡æ¯ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_169.png)

![](img/417bd6c721484af32634ece3a6cedfe1_171.png)

![](img/417bd6c721484af32634ece3a6cedfe1_173.png)

![](img/417bd6c721484af32634ece3a6cedfe1_175.png)

![](img/417bd6c721484af32634ece3a6cedfe1_177.png)

**æ¼æ´åŸç†**ï¼šWindowsä¸ºäº†å…¼å®¹æ—§çš„8.3æ–‡ä»¶åæ ¼å¼ï¼Œä¼šè‡ªåŠ¨ä¸ºé•¿æ–‡ä»¶ååˆ›å»ºçŸ­æ–‡ä»¶åï¼ˆä¾‹å¦‚ `longfilename.txt` å¯¹åº” `LONGFI~1.TXT`ï¼‰ã€‚IISé”™è¯¯åœ°æš´éœ²äº†é€šè¿‡çŸ­æ–‡ä»¶åè®¿é—®æ–‡ä»¶çš„åŠŸèƒ½ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_179.png)

![](img/417bd6c721484af32634ece3a6cedfe1_181.png)

![](img/417bd6c721484af32634ece3a6cedfe1_183.png)

![](img/417bd6c721484af32634ece3a6cedfe1_185.png)

![](img/417bd6c721484af32634ece3a6cedfe1_187.png)

![](img/417bd6c721484af32634ece3a6cedfe1_189.png)

**åˆ©ç”¨å·¥å…·**ï¼š
*   Javaç‰ˆæ‰«æå·¥å…·ï¼š`IIS Shortname Scanner`
*   Pythonç‰ˆæ‰«æå·¥å…·ï¼š`iis-shortname-scanner`

![](img/417bd6c721484af32634ece3a6cedfe1_191.png)

![](img/417bd6c721484af32634ece3a6cedfe1_193.png)

![](img/417bd6c721484af32634ece3a6cedfe1_195.png)

![](img/417bd6c721484af32634ece3a6cedfe1_197.png)

![](img/417bd6c721484af32634ece3a6cedfe1_199.png)

![](img/417bd6c721484af32634ece3a6cedfe1_201.png)

ä»¥ä¸‹æ˜¯ä½¿ç”¨æ­¤ç±»å·¥å…·çš„åŸºæœ¬æµç¨‹ï¼š
1.  è¿è¡Œæ‰«æå·¥å…·ï¼ŒæŒ‡å®šç›®æ ‡URLã€‚
2.  å·¥å…·ä¼šå°è¯•æšä¸¾ç›®å½•å’Œæ–‡ä»¶ï¼Œè¿”å›å…¶çŸ­æ–‡ä»¶åå½¢å¼ï¼ˆå¦‚ `ADMINI~1`ï¼‰ã€‚
3.  æ”»å‡»è€…æ ¹æ®å‰6ä½å­—ç¬¦çŒœæµ‹å®Œæ•´çš„æ–‡ä»¶åï¼ˆå¦‚ `admin_login.asp`ï¼‰ï¼Œä»è€Œå‘ç°æ½œåœ¨çš„æ”»å‡»å…¥å£ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_203.png)

![](img/417bd6c721484af32634ece3a6cedfe1_205.png)

![](img/417bd6c721484af32634ece3a6cedfe1_207.png)

### IISæ–‡ä»¶è§£ææ¼æ´ ğŸ§©

![](img/417bd6c721484af32634ece3a6cedfe1_209.png)

![](img/417bd6c721484af32634ece3a6cedfe1_211.png)

![](img/417bd6c721484af32634ece3a6cedfe1_212.png)

![](img/417bd6c721484af32634ece3a6cedfe1_214.png)

![](img/417bd6c721484af32634ece3a6cedfe1_216.png)

è¯¥æ¼æ´ä¸»è¦å½±å“IIS 6.0ç‰ˆæœ¬ï¼Œå­˜åœ¨ä¸¤ç§åˆ©ç”¨æ–¹å¼ï¼Œå¯å°†éå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆå¦‚å›¾ç‰‡ï¼‰å½“ä½œASPè„šæœ¬è§£ææ‰§è¡Œã€‚

**æ¼æ´å½¢å¼ä¸€ï¼šåˆ†å·æˆªæ–­**
å½“æ–‡ä»¶è·¯å¾„ä¸º `*.asp;.jpg` æ—¶ï¼ŒIIS 6.0ä¼šå¿½ç•¥åˆ†å·åçš„å†…å®¹ï¼Œå°†æ–‡ä»¶ä»¥ `.asp` æ‰©å±•åè¿›è¡Œè§£æã€‚
*   **ç¤ºä¾‹**ï¼šä¸Šä¼ æ–‡ä»¶ `shell.asp;.jpg`ï¼ŒæœåŠ¡å™¨ä¼šå°†å…¶ä½œä¸º `shell.asp` æ‰§è¡Œã€‚

**æ¼æ´å½¢å¼äºŒï¼šç›®å½•è§£æ**
åœ¨IIS 6.0ä¸­ï¼Œå¦‚æœç›®å½•ååŒ…å« `.asp`ã€`.asa`ã€`.cer` ç­‰å­—ç¬¦ä¸²ï¼Œåˆ™è¯¥ç›®å½•ä¸‹çš„**æ‰€æœ‰æ–‡ä»¶**éƒ½ä¼šè¢«å½“ä½œASPè„šæœ¬è§£æã€‚
*   **ç¤ºä¾‹**ï¼šåˆ›å»ºç›®å½• `test.asp`ï¼Œå…¶ä¸­æ”¾å…¥æ–‡ä»¶ `shell.jpg`ã€‚è®¿é—® `/test.asp/shell.jpg` æ—¶ï¼Œ`shell.jpg` ä¼šè¢«å½“ä½œASPä»£ç æ‰§è¡Œã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_218.png)

![](img/417bd6c721484af32634ece3a6cedfe1_220.png)

![](img/417bd6c721484af32634ece3a6cedfe1_222.png)

![](img/417bd6c721484af32634ece3a6cedfe1_224.png)

![](img/417bd6c721484af32634ece3a6cedfe1_226.png)

![](img/417bd6c721484af32634ece3a6cedfe1_228.png)

> **æ³¨æ„**ï¼šIIS 7.0åŠä»¥ä¸Šç‰ˆæœ¬å·²ä¿®å¤æ­¤æ¼æ´ï¼Œæˆ–éœ€è¦ç‰¹å®šæ¡ä»¶æ‰èƒ½è§¦å‘ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_230.png)

![](img/417bd6c721484af32634ece3a6cedfe1_232.png)

![](img/417bd6c721484af32634ece3a6cedfe1_234.png)

![](img/417bd6c721484af32634ece3a6cedfe1_236.png)

![](img/417bd6c721484af32634ece3a6cedfe1_238.png)

### IISå†™æƒé™æ¼æ´ï¼ˆWebDAVé…ç½®ä¸å½“ï¼‰âœï¸

![](img/417bd6c721484af32634ece3a6cedfe1_240.png)

åœ¨IIS 5.1/6.0ä¸­ï¼Œå¦‚æœç®¡ç†å‘˜åŒæ—¶å¼€å¯äº†WebDAVæ‰©å±•å’Œç›®å½•çš„â€œå†™å…¥â€æƒé™ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨HTTPçš„PUTæ–¹æ³•ç›´æ¥ä¸Šä¼ æ–‡ä»¶ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_242.png)

![](img/417bd6c721484af32634ece3a6cedfe1_244.png)

![](img/417bd6c721484af32634ece3a6cedfe1_246.png)

![](img/417bd6c721484af32634ece3a6cedfe1_248.png)

![](img/417bd6c721484af32634ece3a6cedfe1_250.png)

![](img/417bd6c721484af32634ece3a6cedfe1_252.png)

![](img/417bd6c721484af32634ece3a6cedfe1_254.png)

**æ¼æ´åˆ©ç”¨æ­¥éª¤**ï¼š
1.  ä½¿ç”¨å·¥å…·ï¼ˆå¦‚Postmanï¼‰å‘é€HTTP PUTè¯·æ±‚ï¼Œåœ¨ç›®æ ‡ç›®å½•ä¸Šä¼ ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ã€‚
2.  åˆ©ç”¨MOVEæ–¹æ³•ï¼Œç»“åˆIISè§£ææ¼æ´ï¼Œå°†æ–‡ä»¶é‡å‘½åä¸ºå¯æ‰§è¡Œè„šæœ¬ï¼ˆå¦‚ `.asp`ï¼‰ã€‚
3.  è®¿é—®è¯¥è„šæœ¬æ–‡ä»¶ï¼Œè·å–WebShellã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_256.png)

![](img/417bd6c721484af32634ece3a6cedfe1_258.png)

![](img/417bd6c721484af32634ece3a6cedfe1_260.png)

![](img/417bd6c721484af32634ece3a6cedfe1_262.png)

![](img/417bd6c721484af32634ece3a6cedfe1_263.png)

![](img/417bd6c721484af32634ece3a6cedfe1_265.png)

> **æç¤º**ï¼šæ­¤æ¼æ´åœ¨å½“å‰äº’è”ç½‘ç¯å¢ƒä¸­å·²æä¸ºç½•è§ï¼Œä»…ä½œçŸ¥è¯†äº†è§£ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_267.png)

![](img/417bd6c721484af32634ece3a6cedfe1_269.png)

![](img/417bd6c721484af32634ece3a6cedfe1_271.png)

![](img/417bd6c721484af32634ece3a6cedfe1_273.png)

![](img/417bd6c721484af32634ece3a6cedfe1_275.png)

---

![](img/417bd6c721484af32634ece3a6cedfe1_277.png)

![](img/417bd6c721484af32634ece3a6cedfe1_279.png)

## Accessæ•°æ®åº“æ³¨å…¥å®æˆ˜ ğŸ¯

![](img/417bd6c721484af32634ece3a6cedfe1_281.png)

å‰é¢æˆ‘ä»¬ä»‹ç»äº†å¤šç§æ¼æ´ï¼Œæœ¬èŠ‚æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæ¨¡æ‹Ÿå®æˆ˜ï¼Œä¸²è”èµ·ä¿¡æ¯æ”¶é›†ã€æ¼æ´åˆ©ç”¨å’Œæƒé™æå‡çš„è¿‡ç¨‹ã€‚æ ¸å¿ƒæ˜¯åˆ©ç”¨Accessæ•°æ®åº“çš„SQLæ³¨å…¥æ¼æ´ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_283.png)

![](img/417bd6c721484af32634ece3a6cedfe1_285.png)

![](img/417bd6c721484af32634ece3a6cedfe1_287.png)

![](img/417bd6c721484af32634ece3a6cedfe1_289.png)

![](img/417bd6c721484af32634ece3a6cedfe1_291.png)

![](img/417bd6c721484af32634ece3a6cedfe1_293.png)

### SQLæ³¨å…¥åŸç†ç®€è¿°

![](img/417bd6c721484af32634ece3a6cedfe1_294.png)

![](img/417bd6c721484af32634ece3a6cedfe1_296.png)

![](img/417bd6c721484af32634ece3a6cedfe1_298.png)

![](img/417bd6c721484af32634ece3a6cedfe1_300.png)

SQLæ³¨å…¥çš„äº§ç”Ÿæ˜¯å› ä¸ºåº”ç”¨ç¨‹åºå°†ç”¨æˆ·è¾“å…¥çš„æ•°æ®ï¼Œæœªç»å……åˆ†è¿‡æ»¤æˆ–è½¬ä¹‰ï¼Œç›´æ¥æ‹¼æ¥åˆ°äº†SQLæŸ¥è¯¢è¯­å¥ä¸­ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹æ®Šçš„è¾“å…¥ï¼Œæ”¹å˜åŸæŸ¥è¯¢çš„é€»è¾‘ï¼Œä»è€Œæ‰§è¡Œéé¢„æœŸçš„æ•°æ®åº“æ“ä½œã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_302.png)

![](img/417bd6c721484af32634ece3a6cedfe1_304.png)

![](img/417bd6c721484af32634ece3a6cedfe1_306.png)

![](img/417bd6c721484af32634ece3a6cedfe1_308.png)

**ç¤ºä¾‹**ï¼š
åŸå§‹æŸ¥è¯¢è¯­å¥ï¼š`SELECT * FROM news WHERE id = ç”¨æˆ·è¾“å…¥`
ç”¨æˆ·è¾“å…¥ï¼š`1`
æ­£å¸¸æŸ¥è¯¢ï¼š`SELECT * FROM news WHERE id = 1`
æ¶æ„è¾“å…¥ï¼š`1 UNION SELECT username, password FROM admin`
æœ€ç»ˆæŸ¥è¯¢ï¼š`SELECT * FROM news WHERE id = 1 UNION SELECT username, password FROM admin`
è¿™æ ·ï¼Œæ”»å‡»è€…å°±çªƒå–äº†ç®¡ç†å‘˜è¡¨ä¸­çš„è´¦å·å¯†ç ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_310.png)

![](img/417bd6c721484af32634ece3a6cedfe1_312.png)

![](img/417bd6c721484af32634ece3a6cedfe1_314.png)

![](img/417bd6c721484af32634ece3a6cedfe1_316.png)

![](img/417bd6c721484af32634ece3a6cedfe1_318.png)

### ä½¿ç”¨Sqlmapè¿›è¡ŒAccessæ³¨å…¥

![](img/417bd6c721484af32634ece3a6cedfe1_320.png)

![](img/417bd6c721484af32634ece3a6cedfe1_322.png)

![](img/417bd6c721484af32634ece3a6cedfe1_324.png)

![](img/417bd6c721484af32634ece3a6cedfe1_326.png)

å¯¹äºAccessæ•°æ®åº“çš„æ³¨å…¥ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…· `Sqlmap`ï¼Œå› ä¸ºå®ƒä¾èµ–äºâ€œçŒœè§£â€è¡¨åå’Œåˆ—åï¼Œæ‰‹å·¥æ³¨å…¥æ•ˆç‡è¾ƒä½ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_328.png)

![](img/417bd6c721484af32634ece3a6cedfe1_330.png)

![](img/417bd6c721484af32634ece3a6cedfe1_332.png)

![](img/417bd6c721484af32634ece3a6cedfe1_334.png)

![](img/417bd6c721484af32634ece3a6cedfe1_336.png)

**å®æˆ˜æ­¥éª¤**ï¼š

![](img/417bd6c721484af32634ece3a6cedfe1_338.png)

![](img/417bd6c721484af32634ece3a6cedfe1_340.png)

1.  **å¯»æ‰¾æ³¨å…¥ç‚¹**ï¼šæ‰¾åˆ°ç±»ä¼¼ `http://target.com/show.asp?id=123` è¿™æ ·å¸¦æœ‰å‚æ•°çš„URLã€‚
2.  **ä½¿ç”¨Sqlmapæ£€æµ‹**ï¼š
    ```bash
    python sqlmap.py -u "http://target.com/show.asp?id=123"
    ```
3.  **çŒœè§£è¡¨å**ï¼š
    ```bash
    python sqlmap.py -u "http://target.com/show.asp?id=123" --tables
    ```
    å·¥å…·ä¼šä½¿ç”¨å†…ç½®å­—å…¸çŒœæµ‹æ•°æ®åº“ä¸­æœ‰å“ªäº›è¡¨ã€‚é‡ç‚¹å…³æ³¨å¦‚ `admin`ã€`user`ã€`manager` ç­‰å¯èƒ½å­˜æ”¾ç®¡ç†å‘˜å‡­æ®çš„è¡¨åã€‚
4.  **çŒœè§£åˆ—å**ï¼š
    ```bash
    python sqlmap.py -u "http://target.com/show.asp?id=123" -T admin --columns
    ```
    æŒ‡å®šä¸Šä¸€æ­¥çŒœåˆ°çš„è¡¨åï¼ˆå¦‚ `admin`ï¼‰ï¼ŒçŒœæµ‹è¯¥è¡¨ä¸­æœ‰å“ªäº›åˆ—ï¼Œé€šå¸¸å¯»æ‰¾ `username`ã€`password` ç­‰åˆ—ã€‚
5.  **æå–æ•°æ®**ï¼š
    ```bash
    python sqlmap.py -u "http://target.com/show.asp?id=123" -T admin -C "username,password" --dump
    ```
    æŒ‡å®šè¡¨å’Œåˆ—ï¼Œå°†æ•°æ®å†…å®¹å¯¼å‡ºã€‚å¯†ç å¯èƒ½æ˜¯æ˜æ–‡ï¼Œä¹Ÿå¯èƒ½æ˜¯MD5ç­‰å“ˆå¸Œå€¼ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ´è§£ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_342.png)

![](img/417bd6c721484af32634ece3a6cedfe1_344.png)

![](img/417bd6c721484af32634ece3a6cedfe1_346.png)

![](img/417bd6c721484af32634ece3a6cedfe1_348.png)

![](img/417bd6c721484af32634ece3a6cedfe1_350.png)

### è·å–åå°æƒé™ä¸WebShell

![](img/417bd6c721484af32634ece3a6cedfe1_352.png)

![](img/417bd6c721484af32634ece3a6cedfe1_354.png)

![](img/417bd6c721484af32634ece3a6cedfe1_356.png)

![](img/417bd6c721484af32634ece3a6cedfe1_358.png)

![](img/417bd6c721484af32634ece3a6cedfe1_360.png)

åœ¨é€šè¿‡æ³¨å…¥è·å–ç®¡ç†å‘˜è´¦å·å¯†ç åï¼Œä¸‹ä¸€æ­¥æ˜¯æ‰¾åˆ°åå°ç™»å½•åœ°å€å¹¶ç™»å½•ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_362.png)

![](img/417bd6c721484af32634ece3a6cedfe1_364.png)

![](img/417bd6c721484af32634ece3a6cedfe1_366.png)

![](img/417bd6c721484af32634ece3a6cedfe1_368.png)

**å¯»æ‰¾åå°è·¯å¾„çš„å‡ ç§æ–¹æ³•**ï¼š
*   **ç›®å½•æ‰«æ**ï¼šä½¿ç”¨å­—å…¸å¯¹ç½‘ç«™ç›®å½•è¿›è¡Œæš´åŠ›çŒœè§£ï¼ˆå¦‚ `DirBuster`, `å¾¡å‰‘` ç­‰å·¥å…·ï¼‰ï¼Œå¯»æ‰¾ `/admin`, `/manage`, `/login` ç­‰è·¯å¾„ã€‚
*   **çŸ­æ–‡ä»¶åæ¢æµ‹**ï¼šåˆ©ç”¨å‰é¢æåˆ°çš„IISçŸ­æ–‡ä»¶åæ¼æ´ï¼Œæ¢æµ‹å¯èƒ½å­˜åœ¨åå°ç›®å½•ã€‚
*   **ç½‘é¡µçˆ¬è™«**ï¼šä½¿ç”¨çˆ¬è™«å·¥å…·åˆ†æç½‘ç«™æ‰€æœ‰é“¾æ¥ï¼Œä»é¡µé¢æºç æˆ–é“¾æ¥ä¸­å¯èƒ½å‘ç°åå°åœ°å€ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_370.png)

![](img/417bd6c721484af32634ece3a6cedfe1_372.png)

![](img/417bd6c721484af32634ece3a6cedfe1_374.png)

![](img/417bd6c721484af32634ece3a6cedfe1_376.png)

![](img/417bd6c721484af32634ece3a6cedfe1_378.png)

![](img/417bd6c721484af32634ece3a6cedfe1_380.png)

![](img/417bd6c721484af32634ece3a6cedfe1_382.png)

![](img/417bd6c721484af32634ece3a6cedfe1_383.png)

ç™»å½•åå°åï¼Œå¯ä»¥å¯»æ‰¾æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ã€‚å¦‚æœå­˜åœ¨ä¸Šä¼ ä¸”è¿‡æ»¤ä¸ä¸¥ï¼Œå¯ä»¥å°è¯•ç›´æ¥ä¸Šä¼ ASPæœ¨é©¬ï¼ˆWebShellï¼‰ã€‚å¦‚æœå‰ç«¯å¯¹æ–‡ä»¶åç¼€åšäº†é™åˆ¶ï¼Œå¯ä»¥ç»“åˆ **IISè§£ææ¼æ´**ï¼ˆå¦‚å°†æ–‡ä»¶å‘½åä¸º `shell.asp;.jpg`ï¼‰è¿›è¡Œç»•è¿‡ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_385.png)

![](img/417bd6c721484af32634ece3a6cedfe1_387.png)

![](img/417bd6c721484af32634ece3a6cedfe1_389.png)

![](img/417bd6c721484af32634ece3a6cedfe1_391.png)

![](img/417bd6c721484af32634ece3a6cedfe1_393.png)

![](img/417bd6c721484af32634ece3a6cedfe1_395.png)

![](img/417bd6c721484af32634ece3a6cedfe1_397.png)

ä¸Šä¼ æˆåŠŸåï¼Œè®¿é—®WebShellçš„URLï¼Œå³å¯è·å¾—ä¸€ä¸ªä¸æœåŠ¡å™¨äº¤äº’çš„å‘½ä»¤æ‰§è¡Œç¯å¢ƒï¼Œä»è€Œæ§åˆ¶ç½‘ç«™æœåŠ¡å™¨ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_399.png)

![](img/417bd6c721484af32634ece3a6cedfe1_401.png)

![](img/417bd6c721484af32634ece3a6cedfe1_403.png)

![](img/417bd6c721484af32634ece3a6cedfe1_405.png)

![](img/417bd6c721484af32634ece3a6cedfe1_407.png)

![](img/417bd6c721484af32634ece3a6cedfe1_409.png)

---

![](img/417bd6c721484af32634ece3a6cedfe1_411.png)

![](img/417bd6c721484af32634ece3a6cedfe1_413.png)

![](img/417bd6c721484af32634ece3a6cedfe1_415.png)

![](img/417bd6c721484af32634ece3a6cedfe1_417.png)

![](img/417bd6c721484af32634ece3a6cedfe1_419.png)

![](img/417bd6c721484af32634ece3a6cedfe1_421.png)

![](img/417bd6c721484af32634ece3a6cedfe1_423.png)

![](img/417bd6c721484af32634ece3a6cedfe1_425.png)

## æ€»ç»“ ğŸ“

![](img/417bd6c721484af32634ece3a6cedfe1_427.png)

![](img/417bd6c721484af32634ece3a6cedfe1_429.png)

![](img/417bd6c721484af32634ece3a6cedfe1_430.png)

![](img/417bd6c721484af32634ece3a6cedfe1_432.png)

![](img/417bd6c721484af32634ece3a6cedfe1_434.png)

![](img/417bd6c721484af32634ece3a6cedfe1_436.png)

æœ¬èŠ‚è¯¾ä¸­æˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†ASPåº”ç”¨å®‰å…¨æ”»é˜²çš„åŸºç¡€çŸ¥è¯†ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_438.png)

![](img/417bd6c721484af32634ece3a6cedfe1_439.png)

æˆ‘ä»¬é¦–å…ˆåˆ†æäº†**ASP+Access**è¿™ç§ç»å…¸ç»„åˆå› é»˜è®¤é…ç½®å¯¼è‡´çš„**æ•°æ®åº“æ³„éœ²é£é™©**ã€‚ç„¶åï¼Œæ¢è®¨äº†IISä¸­é—´ä»¶çš„å‡ ä¸ªå†å²æ¼æ´ï¼šå¯å¯¼è‡´æœåŠ¡æ‹’ç»çš„**HTTP.SYSè“å±æ¼æ´**ã€ç”¨äºä¿¡æ¯æ”¶é›†çš„**çŸ­æ–‡ä»¶åæ³„éœ²æ¼æ´**ã€å¯ç»•è¿‡ä¸Šä¼ é™åˆ¶çš„**æ–‡ä»¶è§£ææ¼æ´**ä»¥åŠé…ç½®ä¸å½“å¼•å‘çš„**å†™æƒé™æ¼æ´**ã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_441.png)

![](img/417bd6c721484af32634ece3a6cedfe1_442.png)

![](img/417bd6c721484af32634ece3a6cedfe1_444.png)

![](img/417bd6c721484af32634ece3a6cedfe1_446.png)

![](img/417bd6c721484af32634ece3a6cedfe1_448.png)

![](img/417bd6c721484af32634ece3a6cedfe1_450.png)

![](img/417bd6c721484af32634ece3a6cedfe1_452.png)

![](img/417bd6c721484af32634ece3a6cedfe1_454.png)

æœ€åï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®æˆ˜æµç¨‹ï¼Œæ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨**Accessæ•°æ®åº“æ³¨å…¥æ¼æ´**è·å–åå°å‡­è¯ï¼Œå¹¶ç»“åˆ**ç›®å½•æ‰«æ**å¯»æ‰¾åå°ï¼Œä»¥åŠåˆ©ç”¨**æ–‡ä»¶ä¸Šä¼ ä¸è§£ææ¼æ´**ä¸Šä¼ WebShellï¼Œæœ€ç»ˆè·å–æœåŠ¡å™¨æ§åˆ¶æƒã€‚

![](img/417bd6c721484af32634ece3a6cedfe1_456.png)

![](img/417bd6c721484af32634ece3a6cedfe1_458.png)

![](img/417bd6c721484af32634ece3a6cedfe1_460.png)

![](img/417bd6c721484af32634ece3a6cedfe1_462.png)

![](img/417bd6c721484af32634ece3a6cedfe1_464.png)

![](img/417bd6c721484af32634ece3a6cedfe1_466.png)

![](img/417bd6c721484af32634ece3a6cedfe1_468.png)

è™½ç„¶ASPæŠ€æœ¯å·²é€æ¸é€€å‡ºä¸»æµï¼Œä½†å…¶ä¸­è•´å«çš„å®‰å…¨æ€æƒ³ï¼ˆå¦‚é»˜è®¤é…ç½®é£é™©ã€æ³¨å…¥åŸç†ã€è§£æé€»è¾‘ç­‰ï¼‰å¯¹äºç†è§£æ•´ä¸ªWebå®‰å…¨ä½“ç³»ä»ç„¶å…·æœ‰é‡è¦ä»·å€¼ã€‚åœ¨åç»­è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æŠŠé‡ç‚¹è½¬å‘PHPã€Javaç­‰ç°ä»£ä¸»æµæŠ€æœ¯æ ˆçš„å®‰å…¨é—®é¢˜ã€‚