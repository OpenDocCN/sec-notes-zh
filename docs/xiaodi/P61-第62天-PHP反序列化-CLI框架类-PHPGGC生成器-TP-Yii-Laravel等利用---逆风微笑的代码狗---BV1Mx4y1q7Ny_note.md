# ğŸš€ è¯¾ç¨‹61ï¼šPHPæ¡†æ¶ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ä¸PHPGGCå·¥å…·å®æˆ˜

![](img/c4ba44e408df6c460f91177db8a2db1e_1.png)

åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ PHPä¸»æµæ¡†æ¶ï¼ˆå¦‚ThinkPHPã€Yiiã€Laravelï¼‰ä¸­ååºåˆ—åŒ–æ¼æ´çš„åˆ©ç”¨æ–¹æ³•ã€‚è¯¾ç¨‹å°†é‡ç‚¹ä»‹ç»è‡ªåŠ¨åŒ–åˆ©ç”¨å·¥å…·PHPGGCï¼Œå¹¶é€šè¿‡CTFä¾‹é¢˜æ¼”ç¤ºå¦‚ä½•å‘ç°å’Œåˆ©ç”¨è¿™ç±»æ¼æ´ã€‚æˆ‘ä»¬è¿˜å°†æ¢è®¨æ¼æ´çš„æŒ–æ˜æ€è·¯ï¼Œå¸®åŠ©ä½ ç†è§£æ¡†æ¶ç±»ååºåˆ—åŒ–ä¸åŸç”Ÿä»£ç ååºåˆ—åŒ–çš„åŒºåˆ«ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_3.png)

---

## ğŸ“š è¯¾ç¨‹æ¦‚è¿°

ååºåˆ—åŒ–æ¼æ´åœ¨PHPå®‰å…¨ä¸­æ˜¯ä¸€ä¸ªé‡è¦è®®é¢˜ã€‚å‰æœŸè¯¾ç¨‹æˆ‘ä»¬å­¦ä¹ äº†åŸç”ŸPHPä»£ç ä¸­çš„ååºåˆ—åŒ–åŸç†ä¸åˆ©ç”¨ã€‚æœ¬èŠ‚è¯¾å°†èšç„¦äº**æ¡†æ¶å±‚é¢**çš„ååºåˆ—åŒ–æ¼æ´ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_5.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_6.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_8.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_10.png)

æ¡†æ¶ç±»ååºåˆ—åŒ–æ¼æ´çš„æ ¸å¿ƒä»£ç ä½äºæ¡†æ¶å†…éƒ¨ï¼Œè€Œéå¼€å‘è€…è‡ªå®šä¹‰çš„ä»£ç ä¸­ã€‚è¿™æ„å‘³ç€åˆ©ç”¨è¿™ç±»æ¼æ´éœ€è¦æ·±å…¥äº†è§£æ¡†æ¶çš„å†…éƒ¨æœºåˆ¶ï¼Œå…¶å¤æ‚ç¨‹åº¦è¿œè¶…åŸç”ŸPHPä»£ç ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¼•å…¥äº†**PHPGGC**è¿™ç±»è‡ªåŠ¨åŒ–å·¥å…·æ¥è¾…åŠ©åˆ©ç”¨ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_12.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_14.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_16.png)

---

![](img/c4ba44e408df6c460f91177db8a2db1e_18.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_20.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_22.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_24.png)

## ğŸ”§ æ ¸å¿ƒå·¥å…·ä»‹ç»ï¼šPHPGGCä¸NoSoServer

![](img/c4ba44e408df6c460f91177db8a2db1e_26.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_28.png)

åœ¨æ·±å…¥åˆ©ç”¨ä¹‹å‰ï¼Œæœ‰å¿…è¦äº†è§£ä¸¤ä¸ªå…³é”®é¡¹ç›®ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_30.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_32.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_34.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_36.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_38.png)

### NoSoServeré¡¹ç›®

![](img/c4ba44e408df6c460f91177db8a2db1e_40.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_42.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_44.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_46.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_48.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_49.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_51.png)

è¿™æ˜¯ä¸€ä¸ªé›†æˆåŒ–Webç¯å¢ƒï¼Œå°†å››ç§è¯­è¨€ï¼ˆJavaã€.NETã€PHPã€Pythonï¼‰çš„ä¸»æµååºåˆ—åŒ–åˆ©ç”¨å·¥å…·é›†åˆåœ¨ä¸€èµ·ã€‚å…¶PHPéƒ¨åˆ†é›†æˆçš„æ­£æ˜¯**PHPGGC**å·¥å…·ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_53.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_55.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_57.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_59.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_61.png)

**é¡¹ç›®åœ°å€**ï¼š`https://github.com/...` ï¼ˆæ­¤å¤„çœç•¥å…·ä½“åœ°å€ï¼Œè¯¾ç¨‹ä¸­å·²å±•ç¤ºï¼‰

![](img/c4ba44e408df6c460f91177db8a2db1e_63.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_65.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_67.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_69.png)

å®ƒçš„ä½œç”¨æ˜¯æä¾›ä¸€ä¸ªå›¾å½¢åŒ–ç•Œé¢ï¼Œæ–¹ä¾¿ç”Ÿæˆé’ˆå¯¹ä¸åŒæ¡†æ¶å’Œç»„ä»¶çš„ååºåˆ—åŒ–åˆ©ç”¨è½½è·ï¼ˆPayloadï¼‰ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_71.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_73.png)

### PHPGGCå·¥å…·

![](img/c4ba44e408df6c460f91177db8a2db1e_75.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_77.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_79.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_81.png)

PHPGGCæ˜¯ä¸“é—¨é’ˆå¯¹PHPè¯­è¨€å¼€å‘çš„CMSå’Œæ¡†æ¶çš„ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ç”Ÿæˆå·¥å…·ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_83.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_85.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_87.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_89.png)

**å®ƒçš„å®šä½æ˜¯è§£å†³æ¡†æ¶ç±»ååºåˆ—åŒ–é“¾ï¼ˆPOPé“¾ï¼‰è¿‡äºå¤æ‚ã€æ‰‹å·¥æ„é€ å›°éš¾çš„é—®é¢˜**ã€‚å®ƒé¢„ç½®äº†ä¼—å¤šå·²çŸ¥æ¼æ´çš„åˆ©ç”¨é“¾ï¼Œæ”¯æŒThinkPHPã€Yiiã€Laravelã€WordPressç­‰ä¸»æµç³»ç»Ÿã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_91.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_93.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_95.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_96.png)

**åŸºæœ¬ç”¨æ³•**ï¼š
```bash
# åˆ—å‡ºæ‰€æœ‰æ”¯æŒçš„æ¼æ´åˆ©ç”¨é“¾
phpggc -l

![](img/c4ba44e408df6c460f91177db8a2db1e_98.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_99.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_101.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_103.png)

# ç”Ÿæˆç‰¹å®šåˆ©ç”¨é“¾çš„Payload
phpggc ThinkPHP/RCE1 system "cat /flag" --base64
```
**å‚æ•°è¯´æ˜**ï¼š
*   `-l`: åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„åˆ©ç”¨é“¾ã€‚
*   `ThinkPHP/RCE1`: æŒ‡å®šè¦ä½¿ç”¨çš„æ¼æ´åˆ©ç”¨é“¾åç§°ã€‚
*   `system â€œcat /flagâ€`: æŒ‡å®šæœ€ç»ˆè¦æ‰§è¡Œçš„å‡½æ•°å’Œå‘½ä»¤ã€‚
*   `--base64`: å¯¹ç”Ÿæˆçš„Payloadè¿›è¡ŒBase64ç¼–ç ï¼ˆæ ¹æ®ç›®æ ‡ä»£ç æ˜¯å¦éœ€è¦è§£ç è€Œå®šï¼‰ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_105.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_107.png)

---

![](img/c4ba44e408df6c460f91177db8a2db1e_109.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_111.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_113.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_115.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_117.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_119.png)

## ğŸ¯ å®æˆ˜æ¡ˆä¾‹ï¼šCTFé¢˜å‹æ¼”ç¤º

![](img/c4ba44e408df6c460f91177db8a2db1e_121.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_123.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_125.png)

ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸‰ä¸ªCTFä¾‹é¢˜ï¼Œåˆ†åˆ«æ¼”ç¤ºThinkPHPã€Yiiå’ŒLaravelæ¡†æ¶ååºåˆ—åŒ–æ¼æ´çš„åˆ©ç”¨æµç¨‹ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_127.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_129.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_131.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_133.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_135.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_137.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_139.png)

### æ¡ˆä¾‹ä¸€ï¼šThinkPHP 6.0 ååºåˆ—åŒ–

![](img/c4ba44e408df6c460f91177db8a2db1e_141.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_143.png)

**é¢˜ç›®èƒŒæ™¯**ï¼šé¢˜ç›®æ˜¯ä¸€ä¸ªThinkPHP 6.0æ­å»ºçš„ç«™ç‚¹ï¼Œé€šè¿‡æ‰«æå‘ç°æºç å‹ç¼©åŒ…ã€‚åœ¨æºç çš„æ§åˆ¶å™¨ä¸­ï¼Œå‘ç°å­˜åœ¨`unserialize($_POST[â€˜dataâ€™])`çš„ä»£ç ï¼Œä¸”æ²¡æœ‰æ˜æ˜¾çš„è¿‡æ»¤ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_145.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_147.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_149.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_151.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_153.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_155.png)

**åˆ©ç”¨æ­¥éª¤**ï¼š
1.  **ä¿¡æ¯æ”¶é›†**ï¼šç¡®è®¤æ¡†æ¶ä¸ºThinkPHPï¼Œç‰ˆæœ¬ä¸º6.0.xã€‚
2.  **å·¥å…·é€‰æ‹©**ï¼šä½¿ç”¨PHPGGCæŸ¥æ‰¾é€‚ç”¨äºThinkPHP 6.0çš„RCEåˆ©ç”¨é“¾ã€‚
    ```bash
    phpggc -l | grep ThinkPHP
    ```
    å‘ç°`ThinkPHP/RCE3`å’Œ`ThinkPHP/RCE4`é€‚ç”¨äºè¯¥ç‰ˆæœ¬ã€‚
3.  **ç”ŸæˆPayload**ï¼šé€‰æ‹©å…¶ä¸­ä¸€ä¸ªé“¾ç”Ÿæˆæ‰§è¡Œå‘½ä»¤çš„Payloadã€‚
    ```bash
    phpggc ThinkPHP/RCE3 system â€œcat /flagâ€ â€“urlencode
    ```
4.  **å‘é€Payload**ï¼šå°†ç”Ÿæˆçš„Payloadé€šè¿‡POSTè¯·æ±‚å‘é€åˆ°å­˜åœ¨`unserialize`çš„ç«¯ç‚¹ã€‚
    ```bash
    curl -X POST http://target.com/index.php â€“data â€œdata=<ç”Ÿæˆçš„Payload>â€
    ```
5.  **è·å–ç»“æœ**ï¼šæˆåŠŸæ‰§è¡Œå‘½ä»¤å¹¶è·å–flagã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_157.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_159.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_161.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_163.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_165.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_167.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_169.png)

**å…³é”®ç‚¹**ï¼šå¯¹äºæ¡†æ¶ç±»æ¼æ´ï¼Œ**å¿…é¡»æœ‰æºç å‚è€ƒ**æ‰èƒ½çŸ¥é“è§¦å‘ç‚¹åœ¨å“ªé‡Œã€‚é»‘ç›’æµ‹è¯•å¾ˆéš¾ç›´æ¥å‘ç°æ­¤ç±»æ¼æ´ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_171.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_173.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_174.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_176.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_178.png)

---

![](img/c4ba44e408df6c460f91177db8a2db1e_180.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_182.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_184.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_186.png)

### æ¡ˆä¾‹äºŒï¼šYii 2.0 ååºåˆ—åŒ–

![](img/c4ba44e408df6c460f91177db8a2db1e_188.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_190.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_192.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_194.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_196.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_198.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_200.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_202.png)

**é¢˜ç›®èƒŒæ™¯**ï¼šé¢˜ç›®é€šè¿‡æºç æ³„éœ²æç¤ºå­˜åœ¨Yii 2.0æ¡†æ¶ï¼Œå¹¶åœ¨`/backshell`è·¯å¾„ä¸‹å­˜åœ¨`unserialize(base64_decode($_GET[â€˜codeâ€™]))`çš„ä»£ç ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_204.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_206.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_208.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_210.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_212.png)

**åˆ©ç”¨æ­¥éª¤**ï¼š
1.  **ç¡®è®¤ç¯å¢ƒ**ï¼šé€šè¿‡å‰ç«¯å¼•ç”¨çš„JSæ–‡ä»¶ç­‰çº¿ç´¢ï¼Œç¡®è®¤æ¡†æ¶ä¸ºYii 2.0ã€‚
2.  **ç”ŸæˆPayload**ï¼šä½¿ç”¨PHPGGCç”ŸæˆYii 2.0çš„åˆ©ç”¨é“¾Payloadã€‚ç”±äºä»£ç ä¼šè¿›è¡ŒBase64è§£ç ï¼Œæˆ‘ä»¬éœ€è¦ç”ŸæˆBase64ç¼–ç åçš„Payloadã€‚
    ```bash
    phpggc Yii2/RCE1 system â€œcp /flag /tmp/flag.txtâ€ â€“base64
    ```
    *è¿™é‡Œä½¿ç”¨æ–‡ä»¶å¤åˆ¶å‘½ä»¤æ˜¯å› ä¸ºæŸäº›ç¯å¢ƒå¯èƒ½æ— å›æ˜¾ï¼Œå°†ç»“æœå†™å…¥æ–‡ä»¶å†è®¿é—®æŸ¥çœ‹ã€‚*
3.  **å‘é€Payload**ï¼šä»¥GETæ–¹å¼å°†`code`å‚æ•°æäº¤åˆ°ç›®æ ‡åœ°å€ã€‚
    ```
    http://target.com/backshell?code=<Base64ç¼–ç åçš„Payload>
    ```
4.  **æŸ¥çœ‹ç»“æœ**ï¼šè®¿é—®`/tmp/flag.txt`ï¼ˆæˆ–Webç›®å½•ä¸‹çš„ç›¸åº”æ–‡ä»¶ï¼‰è·å–å‘½ä»¤æ‰§è¡Œç»“æœã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_214.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_216.png)

---

![](img/c4ba44e408df6c460f91177db8a2db1e_218.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_220.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_222.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_224.png)

### æ¡ˆä¾‹ä¸‰ï¼šLaravel ååºåˆ—åŒ–

![](img/c4ba44e408df6c460f91177db8a2db1e_226.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_228.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_230.png)

**é¢˜ç›®èƒŒæ™¯**ï¼šé¢˜ç›®ç›´æ¥ç»™å‡ºæºç ï¼Œåœ¨è·¯ç”±ä¸­å®šä¹‰äº†POSTè¯·æ±‚å¤„ç†å‡½æ•°ï¼Œå…¶ä¸­åŒ…å«`unserialize($_POST[â€˜dataâ€™])`ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_232.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_234.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_236.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_238.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_240.png)

**åˆ©ç”¨æ­¥éª¤**ï¼š
1.  **ç‰ˆæœ¬ç¡®è®¤**ï¼šåœ¨æºç ä¸­æŸ¥æ‰¾Laravelçš„ç‰ˆæœ¬ä¿¡æ¯ï¼ˆå¦‚`composer.json`ï¼‰ã€‚
2.  **é€‰æ‹©åˆ©ç”¨é“¾**ï¼šä½¿ç”¨PHPGGCæŸ¥æ‰¾é€‚ç”¨äºè¯¥ç‰ˆæœ¬çš„Laravelååºåˆ—åŒ–é“¾ã€‚ç”±äºç‰ˆæœ¬æœªçŸ¥ï¼Œå¯èƒ½éœ€è¦å°è¯•å¤šä¸ªã€‚
    ```bash
    phpggc -l | grep Laravel
    ```
3.  **ç”Ÿæˆå¹¶æµ‹è¯•**ï¼šé€‰æ‹©ä¸€ä¸ªå¯èƒ½é€‚ç”¨çš„é“¾ï¼ˆå¦‚`Laravel/RCE1`ï¼‰ç”ŸæˆPayloadè¿›è¡Œæµ‹è¯•ã€‚
    ```bash
    phpggc Laravel/RCE1 system â€œls -laâ€ â€“urlencode
    ```
4.  **å‘é€è¯·æ±‚**ï¼šå°†Payloadé€šè¿‡POSTçš„`data`å­—æ®µæäº¤ã€‚
5.  **è·å–å›æ˜¾**ï¼šæˆåŠŸæ‰§è¡Œ`ls`å‘½ä»¤ï¼Œåˆ—å‡ºå½“å‰ç›®å½•æ–‡ä»¶ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_242.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_243.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_245.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_247.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_249.png)

---

![](img/c4ba44e408df6c460f91177db8a2db1e_251.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_253.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_255.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_257.png)

## ğŸ•µï¸ æ¼æ´æŒ–æ˜æ€è·¯åˆ†æ

![](img/c4ba44e408df6c460f91177db8a2db1e_259.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_261.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨å·²çŸ¥æ¼æ´ã€‚æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ¥æ¢è®¨ä¸€ä¸‹è¿™ç±»æ¼æ´æ˜¯å¦‚ä½•è¢«æŒ–æ˜å‡ºæ¥çš„ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_263.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_265.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_267.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_269.png)

æ¡†æ¶ç±»ååºåˆ—åŒ–æ¼æ´çš„æŒ–æ˜åˆ†ä¸ºä¸¤ä¸ªå±‚é¢ï¼š

![](img/c4ba44e408df6c460f91177db8a2db1e_271.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_273.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_275.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_277.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_279.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_281.png)

### å±‚é¢ä¸€ï¼šåœ¨å·²çŸ¥æ¡†æ¶æ¼æ´åŸºç¡€ä¸ŠæŒ–æ˜CMSæ¼æ´

![](img/c4ba44e408df6c460f91177db8a2db1e_283.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_285.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_287.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_289.png)

è¿™æ˜¯ç›¸å¯¹å®¹æ˜“çš„å±‚é¢ã€‚å½“ä½ å®¡è®¡ä¸€ä¸ªä½¿ç”¨ThinkPHPã€Yiiç­‰æ¡†æ¶å¼€å‘çš„CMSæ—¶ï¼š
1.  é¦–å…ˆç¡®å®šCMSæ‰€ä½¿ç”¨çš„æ¡†æ¶åŠç‰ˆæœ¬ã€‚
2.  æŸ¥é˜…èµ„æ–™ï¼Œç¡®è®¤è¯¥æ¡†æ¶ç‰ˆæœ¬æ˜¯å¦å­˜åœ¨å·²çŸ¥çš„ååºåˆ—åŒ–æ¼æ´ã€‚
3.  **æœ€å…³é”®çš„ä¸€æ­¥**ï¼šåœ¨CMSçš„æºç ä¸­å…¨å±€æœç´¢`unserialize`å‡½æ•°ï¼Œå¯»æ‰¾å¯æ§çš„è§¦å‘ç‚¹ã€‚
4.  å¦‚æœæ‰¾åˆ°è§¦å‘ç‚¹ï¼Œä¸”æ¡†æ¶ç‰ˆæœ¬å­˜åœ¨æ¼æ´ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨PHPGGCç”ŸæˆPayloadè¿›è¡Œåˆ©ç”¨ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_291.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_293.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_295.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_297.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_299.png)

**è¿™ç›¸å½“äºç«™åœ¨â€œå·¨äººâ€ï¼ˆæ¡†æ¶æ¼æ´å‘ç°è€…ï¼‰çš„è‚©è†€ä¸Šï¼Œå»æŒ–æ˜å…·ä½“åº”ç”¨ç³»ç»Ÿçš„æ¼æ´ã€‚**

![](img/c4ba44e408df6c460f91177db8a2db1e_301.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_303.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_305.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_307.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_309.png)

### å±‚é¢äºŒï¼šæŒ–æ˜æ¡†æ¶æœ¬èº«çš„é›¶æ—¥æ¼æ´

![](img/c4ba44e408df6c460f91177db8a2db1e_311.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_313.png)

è¿™æ˜¯éš¾åº¦æœ€é«˜çš„å±‚é¢ï¼Œéœ€è¦å…·å¤‡æ·±åšçš„å¼€å‘åŠŸåº•å’Œå¯¹æ¡†æ¶æºç çš„æ·±åˆ»ç†è§£ã€‚ä»¥ThinkPHP 5.0.24ååºåˆ—åŒ–æ¼æ´çš„æŒ–æ˜ä¸ºä¾‹ï¼Œå…¶å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š

![](img/c4ba44e408df6c460f91177db8a2db1e_315.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_317.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_319.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_321.png)

1.  **å¯»æ‰¾å…¥å£ç‚¹**ï¼šåœ¨æ¡†æ¶æºç ä¸­æœç´¢æ‰€æœ‰å¯èƒ½çš„é­”æœ¯æ–¹æ³•ï¼ˆå¦‚`__destruct`, `__wakeup`ï¼‰ï¼Œè¿™äº›æ˜¯ååºåˆ—åŒ–é“¾çš„èµ·ç‚¹ã€‚
2.  **å›æº¯è°ƒç”¨é“¾**ï¼šä»æŸä¸ª`__destruct`æ–¹æ³•å¼€å§‹ï¼Œåˆ†æå…¶è°ƒç”¨çš„å…¶ä»–æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå‘ç°`__destruct`ä¸­è°ƒç”¨äº†`removeFiles`æ–¹æ³•ã€‚
3.  **å¯»æ‰¾æ•æ„Ÿæ“ä½œ**ï¼šåœ¨`removeFiles`æ–¹æ³•ä¸­ï¼Œå‘ç°å…¶å¯¹ä¸€ä¸ªå±æ€§è¿›è¡Œäº†`file_exists`åˆ¤æ–­ã€‚å¦‚æœè¯¥å±æ€§æ˜¯å¯¹è±¡ï¼Œåˆ™ä¼šè§¦å‘å…¶`__toString`æ–¹æ³•ã€‚
4.  **é“¾å¼ä¼ é€’**ï¼šæ¥ç€åˆ†æ`__toString`æ–¹æ³•ï¼Œå®ƒå¯èƒ½è°ƒç”¨äº†`toJson`ï¼Œè¿›è€Œè°ƒç”¨`__call`ï¼ˆå½“è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è§¦å‘ï¼‰ã€‚
5.  **æŠµè¾¾å±é™©å‡½æ•°**ï¼šæœ€ç»ˆåœ¨`__call`æ–¹æ³•ä¸­ï¼Œæ‰¾åˆ°äº†å¯ä»¥æ§åˆ¶`call_user_func`æˆ–`call_user_func_array`å‡½æ•°å‚æ•°çš„ç‚¹ï¼Œä»è€Œå®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚
6.  **æ„é€ POPé“¾**ï¼šå°†ä¸Šè¿°æ‰€æœ‰ç¯èŠ‚æ¶‰åŠçš„ç±»å±æ€§ç²¾å¿ƒæ„é€ ï¼Œä¸²è”æˆä¸€æ¡å®Œæ•´çš„ã€ä»ååºåˆ—åŒ–è§¦å‘åˆ°å‘½ä»¤æ‰§è¡Œçš„è°ƒç”¨é“¾ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_323.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_325.png)

è¿™ä¸ªè¿‡ç¨‹éœ€è¦å¯¹æ¡†æ¶çš„å‘½åç©ºé—´ã€ç±»ç»“æ„ã€æ–¹æ³•è°ƒç”¨æœ‰éå¸¸æ¸…æ™°çš„äº†è§£ï¼Œå¹¶ä¸”è¦éå†å¤§é‡ä»£ç ï¼Œæ’é™¤æ— æ•ˆè·¯å¾„ã€‚**è¿™è¿œéä¸€æœä¸€å¤•å¯ä»¥æŒæ¡ï¼Œé€šå¸¸éœ€è¦å¤šå¹´çš„PHPå¼€å‘ç»éªŒå’Œå¯¹å®‰å…¨ç ”ç©¶çš„çƒ­æƒ…ã€‚**

![](img/c4ba44e408df6c460f91177db8a2db1e_327.png)

---

![](img/c4ba44e408df6c460f91177db8a2db1e_329.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_330.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_332.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_334.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_336.png)

## ğŸ’» ç¯å¢ƒæ­å»ºè¡¥å……ï¼šNoSoServer

![](img/c4ba44e408df6c460f91177db8a2db1e_338.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_340.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_342.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_344.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_346.png)

æœ‰åŒå­¦æåˆ°NoSoServeré¡¹ç›®çš„æ­å»ºé—®é¢˜ï¼Œè¿™é‡Œè¿›è¡Œç®€è¦è¯´æ˜ã€‚

**æ­å»ºæ­¥éª¤**ï¼š
1.  **å‡†å¤‡ç¯å¢ƒ**ï¼šä¸€å°Windows Server 2012 R2æˆ–æ›´é«˜ç‰ˆæœ¬çš„æœåŠ¡å™¨ï¼Œå®‰è£…IISã€‚
2.  **å®‰è£…ä¾èµ–**ï¼šåœ¨IISä¸­å®‰è£…**åº”ç”¨ç¨‹åºå¼€å‘**åŠŸèƒ½ï¼Œç¡®ä¿å‹¾é€‰`.NET 4.5`æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
3.  **éƒ¨ç½²æºç **ï¼šå°†NoSoServeré¡¹ç›®æºç è§£å‹åˆ°IISçš„ç½‘ç«™ç›®å½•ï¼ˆå¦‚`C:\inetpub\wwwroot\nososervertest`ï¼‰ã€‚
4.  **é…ç½®IIS**ï¼š
    *   åœ¨IISç®¡ç†å™¨ä¸­æ·»åŠ ç½‘ç«™ï¼Œç‰©ç†è·¯å¾„æŒ‡å‘æºç ç›®å½•ã€‚
    *   å°†è¯¥ç½‘ç«™åº”ç”¨ç¨‹åºæ± çš„**.NET CLRç‰ˆæœ¬**è®¾ç½®ä¸º`v4.0`æˆ–æ›´é«˜ã€‚
5.  **è®¾ç½®æƒé™**ï¼šç»™äºˆæºç ç›®å½•`IIS_IUSRS`ç”¨æˆ·ç»„**å®Œå…¨æ§åˆ¶**æƒé™ï¼Œä»¥è§£å†³å¯èƒ½çš„500é”™è¯¯ã€‚
6.  **è®¿é—®æµ‹è¯•**ï¼šé€šè¿‡æµè§ˆå™¨è®¿é—®`http://your-ip:port`å³å¯çœ‹åˆ°é›†æˆç•Œé¢ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_348.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_350.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_352.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_354.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_356.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_358.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_360.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_362.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_364.png)

**æ³¨æ„**ï¼šNoSoServerçš„PHPGGC WebåŠŸèƒ½å¯èƒ½éœ€è¦åœ¨Linuxç¯å¢ƒä¸‹è¿è¡ŒPHPGGCè„šæœ¬ï¼ŒWindows IISç¯å¢ƒå¯èƒ½æ— æ³•ç›´æ¥ä½¿ç”¨è¯¥åŠŸèƒ½ç”ŸæˆPHPçš„Payloadã€‚ä½†Javaã€.NETã€Pythonéƒ¨åˆ†é€šå¸¸æ­£å¸¸ã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_366.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_368.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_369.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_371.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_373.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_375.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_377.png)

---

![](img/c4ba44e408df6c460f91177db8a2db1e_379.png)

## ğŸ“ è¯¾ç¨‹æ€»ç»“

![](img/c4ba44e408df6c460f91177db8a2db1e_381.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_383.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_385.png)

æœ¬èŠ‚è¯¾æˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†PHPæ¡†æ¶ååºåˆ—åŒ–æ¼æ´çš„åˆ©ç”¨ä¸ç›¸å…³çŸ¥è¯†ï¼š

![](img/c4ba44e408df6c460f91177db8a2db1e_387.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_389.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_390.png)

1.  **æ ¸å¿ƒæ¦‚å¿µ**ï¼šæ¡†æ¶ç±»ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨çš„æ˜¯æ¡†æ¶å†…éƒ¨å°è£…çš„ä»£ç é“¾ï¼Œå¤æ‚åº¦é«˜ï¼Œé€šå¸¸éœ€è¦å€ŸåŠ©è‡ªåŠ¨åŒ–å·¥å…·ã€‚
2.  **æ ¸å¿ƒå·¥å…·**ï¼š**PHPGGC**æ˜¯PHPæ¡†æ¶ååºåˆ—åŒ–åˆ©ç”¨çš„â€œç‘å£«å†›åˆ€â€ï¼Œå¯ä»¥ä¸€é”®ç”Ÿæˆé’ˆå¯¹å¤šç§æ¡†æ¶å’Œç‰ˆæœ¬çš„æ”»å‡»Payloadã€‚
3.  **åˆ©ç”¨æµç¨‹**ï¼šå‘ç°ååºåˆ—åŒ–è§¦å‘ç‚¹ -> è¯†åˆ«æ¡†æ¶åŠç‰ˆæœ¬ -> ä½¿ç”¨PHPGGCç”Ÿæˆå¯¹åº”Payload -> å‘é€Payloadæ‰§è¡Œå‘½ä»¤ã€‚
4.  **æŒ–æ˜å±‚æ¬¡**ï¼š
    *   **åˆçº§/å®æˆ˜**ï¼šåœ¨å·²çŸ¥æ¡†æ¶æ¼æ´åŸºç¡€ä¸Šï¼Œå®¡è®¡å…·ä½“CMS/åº”ç”¨ï¼Œå¯»æ‰¾å¯æ§çš„`unserialize`ç‚¹è¿›è¡Œåˆ©ç”¨ã€‚
    *   **é«˜çº§/ç ”ç©¶**ï¼šæ·±å…¥åˆ†ææ¡†æ¶æºç ï¼ŒæŒ–æ˜æ¡†æ¶æœ¬èº«çš„é›¶æ—¥ååºåˆ—åŒ–æ¼æ´ï¼Œè¿™éœ€è¦æå¼ºçš„å¼€å‘èƒ½åŠ›å’Œä»£ç å®¡è®¡åŠŸåº•ã€‚
5.  **ç¯å¢ƒæ­å»º**ï¼šæŒæ¡äº†NoSoServeré›†æˆç¯å¢ƒçš„æ­å»ºæ–¹æ³•ï¼Œä¾¿äºå›¾å½¢åŒ–ç”Ÿæˆå¤šç§è¯­è¨€çš„ååºåˆ—åŒ–Payloadã€‚

![](img/c4ba44e408df6c460f91177db8a2db1e_392.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_394.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_396.png)

![](img/c4ba44e408df6c460f91177db8a2db1e_398.png)

é€šè¿‡æœ¬è¯¾çš„å­¦ä¹ ï¼Œä½ åº”å½“èƒ½å¤Ÿåº”å¯¹CTFä¸­å¸¸è§çš„æ¡†æ¶ååºåˆ—åŒ–é¢˜ç›®ï¼Œå¹¶å…·å¤‡åœ¨å®æˆ˜ä¸­å®¡è®¡ä½¿ç”¨å·²çŸ¥æ¼æ´æ¡†æ¶çš„CMSçš„åŸºæœ¬èƒ½åŠ›ã€‚è¦è¿ˆå‘æŒ–æ˜æ¡†æ¶åº•å±‚æ¼æ´çš„å±‚æ¬¡ï¼Œåˆ™éœ€è¦æŒç»­æ·±è€•PHPå¼€å‘ä¸ä»£ç å®¡è®¡æŠ€æœ¯ã€‚