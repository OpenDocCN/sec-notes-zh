![](img/5ac33253800fc8478bbb1a1b9f61e303_1.png)

# ğŸ› ï¸ JSå®‰å…¨å¼€å‘å®æˆ˜ï¼šDOMæ“ä½œä¸åŠ å¯†é€†å‘åˆ†æï¼ˆç¬¬29å¤©ï¼‰

![](img/5ac33253800fc8478bbb1a1b9f61e303_3.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_5.png)

åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ JavaScriptå®‰å…¨å¼€å‘ä¸­çš„ä¸¤ä¸ªæ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼šDOMæ ‘æ“ä½œçš„å®‰å…¨éšæ‚£ï¼ˆDOMå‹XSSï¼‰ä»¥åŠå‰ç«¯åŠ å¯†ç¼–ç åº“çš„è¯†åˆ«ä¸é€†å‘åˆ†æã€‚è¿™äº›çŸ¥è¯†æ˜¯è¿›è¡ŒWebå®‰å…¨æµ‹è¯•ï¼Œç‰¹åˆ«æ˜¯å‰ç«¯æ¼æ´æŒ–æ˜ä¸è°ƒè¯•çš„åŸºç¡€ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_7.png)

---

![](img/5ac33253800fc8478bbb1a1b9f61e303_9.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_11.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_13.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_15.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_17.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_19.png)

## ğŸŒ³ ç¬¬ä¸€éƒ¨åˆ†ï¼šDOMæ ‘æ“ä½œä¸å®‰å…¨é£é™©

![](img/5ac33253800fc8478bbb1a1b9f61e303_21.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_23.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_25.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_27.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_29.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_31.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_33.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_35.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†JSçš„AJAXåŸºç¡€ã€‚æœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹DOMï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰æ“ä½œåŠå…¶ç›¸å…³çš„å®‰å…¨é—®é¢˜ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_37.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_39.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_41.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_43.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_45.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_47.png)

DOMæ˜¯æµè§ˆå™¨æä¾›çš„ä¸€å¥—ç”¨äºæ“ä½œç½‘é¡µå†…å®¹ã€ç»“æ„å’Œæ ·å¼çš„ç¼–ç¨‹æ¥å£ã€‚å®ƒå…è®¸JavaScriptåŠ¨æ€åœ°è®¿é—®å’Œæ›´æ–°é¡µé¢å†…å®¹ï¼Œå®ç°ä¸ç”¨æˆ·çš„äº¤äº’ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_49.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_51.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_53.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_54.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_55.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_57.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_59.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_61.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_63.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_65.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_67.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_69.png)

### DOMæ“ä½œåŸºç¡€ç¤ºä¾‹

![](img/5ac33253800fc8478bbb1a1b9f61e303_71.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_73.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_75.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_77.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_79.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_81.png)

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„DOMæ“ä½œç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•è·å–å’Œä¿®æ”¹é¡µé¢å…ƒç´ ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_83.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_85.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_87.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_89.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_91.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_93.png)

```html
<!DOCTYPE html>
<html>
<head>
    <title>DOMæ“ä½œç¤ºä¾‹</title>
</head>
<body>
    <h1 id="title">è¿™æ˜¯æ ‡é¢˜</h1>
    <img id="myImage" src="iphone.jpg" width="300">
    <button onclick="updateImage()">åˆ·æ–°å›¾ç‰‡</button>
    <button onclick="updateTitle()">ä¿®æ”¹æ ‡é¢˜</button>

    <script>
        // è·å–å›¾ç‰‡å…ƒç´ å¹¶ä¿®æ”¹å…¶srcå±æ€§
        function updateImage() {
            let imgElement = document.querySelector('#myImage');
            console.log('åŸå§‹SRC:', imgElement.src);
            imgElement.src = 'huawei.png'; // ä¿®æ”¹å›¾ç‰‡æº
            console.log('ä¿®æ”¹åSRC:', imgElement.src);
        }

        // è·å–æ ‡é¢˜å…ƒç´ å¹¶ä¿®æ”¹å…¶å†…å®¹
        function updateTitle() {
            let titleElement = document.querySelector('#title');
            // innerText è·å–çº¯æ–‡æœ¬ï¼Œä¸è§£æHTML
            console.log('innerTextè·å–:', titleElement.innerText);
            // innerHTML è·å–åŒ…å«HTMLæ ‡ç­¾çš„å†…å®¹
            console.log('innerHTMLè·å–:', titleElement.innerHTML);

            // ä¿®æ”¹å†…å®¹
            titleElement.innerText = 'è¿™æ˜¯å°è¿ª (innerText)';
            // å¦‚æœä½¿ç”¨innerHTMLï¼Œå¯ä»¥æ’å…¥HTMLæ ‡ç­¾
            // titleElement.innerHTML = 'è¿™æ˜¯å°è¿ª <br> (innerHTML)';
        }
    </script>
</body>
</html>
```

![](img/5ac33253800fc8478bbb1a1b9f61e303_95.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_97.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_99.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_101.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_103.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_105.png)

**ä»£ç è§£æï¼š**
*   `document.querySelector(â€˜#myImageâ€™)`ï¼šé€šè¿‡CSSé€‰æ‹©å™¨è·å–IDä¸º`myImage`çš„å…ƒç´ ã€‚
*   `element.src`ï¼šè·å–æˆ–è®¾ç½®å…ƒç´ çš„`src`å±æ€§ã€‚
*   `element.innerText`ï¼šè·å–æˆ–è®¾ç½®å…ƒç´ çš„çº¯æ–‡æœ¬å†…å®¹ï¼Œä¸è§£æHTMLã€‚
*   `element.innerHTML`ï¼šè·å–æˆ–è®¾ç½®å…ƒç´ çš„HTMLå†…å®¹ï¼Œä¼šè§£æå…¶ä¸­çš„æ ‡ç­¾ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_107.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_109.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_111.png)

### DOMå‹XSSæ¼æ´åŸç†

![](img/5ac33253800fc8478bbb1a1b9f61e303_113.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_115.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_117.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_119.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_121.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_123.png)

DOMæ“ä½œæœ¬èº«æ˜¯å®‰å…¨çš„ï¼Œä½†å½“æ“ä½œçš„æ•°æ®æºï¼ˆå¦‚URLå‚æ•°ã€ç”¨æˆ·è¾“å…¥ï¼‰ä¸å¯ä¿¡ä¸”æœªç»ä¸¥æ ¼è¿‡æ»¤æ—¶ï¼Œå°±ä¼šäº§ç”Ÿ**DOMå‹XSS**æ¼æ´ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_125.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_127.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_129.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_131.png)

**æ¼æ´æ¨¡å‹ï¼š**
```javascript
// å‡è®¾ä»¥ä¸‹ä»£ç ä»URLçš„hashä¸­è·å–æ•°æ®å¹¶å†™å…¥é¡µé¢
let userInput = window.location.hash.substring(1); // è·å– # åçš„å†…å®¹
document.getElementById('output').innerHTML = userInput; // å±é™©æ“ä½œï¼
```
å¦‚æœç”¨æˆ·è®¿é—®çš„URLæ˜¯ï¼š`http://example.com/page.html#<script>alert(â€˜xssâ€™)</script>`ï¼Œé‚£ä¹ˆæ¶æ„è„šæœ¬å°±ä¼šè¢«æ‰§è¡Œã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_133.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_135.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_137.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_139.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_140.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_142.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_144.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_146.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_148.png)

**ä¸åå°„/å­˜å‚¨å‹XSSçš„åŒºåˆ«ï¼š**
DOMå‹XSSçš„æ¶æ„ä»£ç **ä¸ç»è¿‡æœåŠ¡å™¨**ï¼Œç”±å‰ç«¯JSç›´æ¥åœ¨å—å®³è€…æµè§ˆå™¨ä¸­æ„é€ å¹¶æ‰§è¡Œã€‚è¿™ä½¿å…¶æ›´éš¾è¢«ä¼ ç»Ÿçš„WAFï¼ˆWebåº”ç”¨é˜²ç«å¢™ï¼‰æˆ–æœåŠ¡ç«¯æ—¥å¿—æ£€æµ‹åˆ°ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_150.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_152.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_154.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_156.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_158.png)

### å®æˆ˜æ¡ˆä¾‹ï¼šæœ‰é“ç¿»è¯‘DOMå‹XSSåˆ†æ

åœ¨çœŸå®åœºæ™¯ä¸­ï¼ŒDOMå‹XSSå¯èƒ½å‡ºç°åœ¨å¤æ‚çš„äº¤äº’é€»è¾‘é‡Œã€‚ä¾‹å¦‚ï¼ŒæŸäº›ç¿»è¯‘ç½‘ç«™çš„åŒå‘ç¿»è¯‘åŠŸèƒ½ï¼š
1.  **åŠŸèƒ½é€»è¾‘**ï¼šç”¨æˆ·åœ¨Aæ¡†è¾“å…¥ï¼Œç»“æœå®æ—¶æ˜¾ç¤ºåœ¨Bæ¡†ï¼›åä¹‹äº¦ç„¶ã€‚è¿™é€šå¸¸é€šè¿‡DOMæ“ä½œå®ç°ã€‚
2.  **æ¼æ´ç‚¹**ï¼šå‡è®¾ä»Aæ¡†åˆ°Bæ¡†çš„æ•°æ®ç»è¿‡äº†å®‰å…¨è¿‡æ»¤ï¼ˆå¦‚è½¬ä¹‰å°–æ‹¬å·`<>`ï¼‰ï¼Œä½†ä»Bæ¡†åå‘ç¿»è¯‘åˆ°Aæ¡†æ—¶ï¼Œè¿‡æ»¤é€»è¾‘å¯èƒ½ç¼ºå¤±æˆ–ä¸åŒã€‚
3.  **æ”»å‡»é“¾**ï¼š
    *   æ”»å‡»è€…åœ¨Aæ¡†è¾“å…¥ä¸€ä¸ªåŒ…å«æ¶æ„IMGæ ‡ç­¾çš„â€œå•è¯â€ï¼š`<img src=1 onerror=alert(1)>`ã€‚
    *   ç½‘ç«™å°†å…¶å®‰å…¨åœ°æ˜¾ç¤ºåœ¨Bæ¡†ï¼ˆæ ‡ç­¾è¢«è½¬ä¹‰ï¼Œä¸æ‰§è¡Œï¼‰ã€‚
    *   ä½†å½“ç”¨æˆ·**å°†é¼ æ ‡æ‚¬åœåœ¨Bæ¡†çš„æ­¤å†…å®¹ä¸Š**ï¼ˆè§¦å‘åå‘ç¿»è¯‘äº‹ä»¶ï¼‰æ—¶ï¼Œç½‘ç«™å¯èƒ½å°†Bæ¡†å†…å®¹**æœªç»è¿‡æ»¤**åœ°å†™å›Aæ¡†çš„æŸä¸ªå±æ€§ä¸­ï¼Œä»è€Œè§¦å‘`onerror`äº‹ä»¶ï¼Œæ‰§è¡ŒJSä»£ç ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_160.png)

**æ ¸å¿ƒè¦ç‚¹ï¼š** åœ¨æµ‹è¯•æ—¶ï¼Œéœ€è¦å…³æ³¨æ•°æ®çš„**åŒå‘æµåŠ¨**å’Œ**ä¸åŒäº‹ä»¶å¤„ç†å™¨**ï¼ˆå¦‚`onclick`ã€`onmouseover`ï¼‰ä¸­çš„æ•°æ®å¤„ç†å·®å¼‚ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_162.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_164.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_166.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_168.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_170.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_172.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_174.png)

---

![](img/5ac33253800fc8478bbb1a1b9f61e303_176.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_178.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_180.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_182.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_184.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_186.png)

## ğŸ” ç¬¬äºŒéƒ¨åˆ†ï¼šå‰ç«¯åŠ å¯†ä¸é€†å‘è°ƒè¯•

ä¸Šä¸€èŠ‚æˆ‘ä»¬äº†è§£äº†DOMæ“ä½œçš„é£é™©ã€‚æœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹å‰ç«¯åŠ å¯†çš„å¸¸è§åœºæ™¯ä»¥åŠå¦‚ä½•é€šè¿‡é€†å‘è°ƒè¯•æ¥åˆ†æåŠ å¯†é€»è¾‘ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_188.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_190.png)

### ä¸ºä»€ä¹ˆéœ€è¦åˆ†æå‰ç«¯åŠ å¯†ï¼Ÿ

åœ¨ç°ä»£Webåº”ç”¨ä¸­ï¼Œç™»å½•ã€æäº¤ç­‰æ•æ„Ÿæ“ä½œçš„æ•°æ®å¸¸å¸¸åœ¨å‰ç«¯ï¼ˆJavaScriptï¼‰è¿›è¡ŒåŠ å¯†åå†å‘é€ç»™æœåŠ¡å™¨ã€‚ä¾‹å¦‚ï¼š
*   å¯†ç ä½¿ç”¨MD5ã€SHA1ã€AESã€RSAç­‰ç®—æ³•åŠ å¯†ã€‚
*   æ•´ä¸ªè¯·æ±‚å‚æ•°å¯èƒ½è¢«ç¼–ç ï¼ˆå¦‚Base64ï¼‰æˆ–ä½¿ç”¨è‡ªå®šä¹‰ç®—æ³•æ··æ·†ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_192.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_194.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_196.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_198.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_200.png)

ä½œä¸ºå®‰å…¨æµ‹è¯•äººå‘˜ï¼Œå¦‚æœä¸çŸ¥é“åŠ å¯†ç®—æ³•å’Œå¯†é’¥ï¼š
1.  ä½ æ— æ³•æ„é€ æœ‰æ•ˆçš„æµ‹è¯•Payloadï¼ˆå¦‚SQLæ³¨å…¥è¯­å¥ï¼‰ã€‚
2.  ä½ å‘é€çš„æ˜æ–‡Payloadè¢«å‰ç«¯åŠ å¯†åï¼Œä¼šå˜æˆä¸€å †ä¹±ç ï¼ŒæœåŠ¡å™¨æ— æ³•æ­£ç¡®è§£æï¼Œä»è€Œå¯¼è‡´æ¼æ´æ£€æµ‹å¤±è´¥ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_202.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_204.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_206.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_208.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_210.png)

å› æ­¤ï¼Œ**é€†å‘åˆ†æå‰ç«¯åŠ å¯†é€»è¾‘æ˜¯æµ‹è¯•è¿™ç±»åº”ç”¨çš„å…ˆå†³æ¡ä»¶**ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_212.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_214.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_216.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_218.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_220.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_222.png)

### å¸¸ç”¨åŠ å¯†åº“ç¤ºä¾‹

![](img/5ac33253800fc8478bbb1a1b9f61e303_224.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_226.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_228.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_229.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_231.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_233.png)

å‰ç«¯é€šå¸¸ä¼šå¼•å…¥æˆç†Ÿçš„åŠ å¯†åº“ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨`crypto-js`åº“è¿›è¡Œå¤šç§åŠ å¯†çš„ç¤ºä¾‹ï¼š

![](img/5ac33253800fc8478bbb1a1b9f61e303_235.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_237.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_239.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_241.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_243.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_245.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_247.png)

```html
<!DOCTYPE html>
<html>
<head>
    <title>åŠ å¯†ç¤ºä¾‹</title>
    <!-- å¼•å…¥ crypto-js åº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>
<body>
    <script>
        let plainText = "xiaodi";

        // 1. MD5 åŠ å¯†
        let md5Hash = CryptoJS.MD5(plainText).toString();
        console.log("MD5:", md5Hash); // è¾“å‡ºï¼š å“ˆå¸Œå€¼

        // 2. Base64 ç¼–ç 
        let base64Encoded = CryptoJS.enc.Base64.stringify(CryptoJS.enc.Utf8.parse(plainText));
        console.log("Base64:", base64Encoded); // è¾“å‡ºï¼š eGlhb2Rp

        // 3. AES åŠ å¯† (éœ€è¦å¯†é’¥)
        let key = CryptoJS.enc.Utf8.parse("1234567890123456"); // 16ä½å¯†é’¥
        let aesEncrypted = CryptoJS.AES.encrypt(plainText, key, {
            mode: CryptoJS.mode.ECB,
            padding: CryptoJS.pad.Pkcs7
        }).toString();
        console.log("AESåŠ å¯†:", aesEncrypted);

        // 4. SHA256 åŠ å¯†
        let sha256Hash = CryptoJS.SHA256(plainText).toString();
        console.log("SHA256:", sha256Hash);
    </script>
</body>
</html>
```

![](img/5ac33253800fc8478bbb1a1b9f61e303_249.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_251.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_253.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_255.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_257.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_259.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_261.png)

### é€†å‘è°ƒè¯•å®æˆ˜ï¼šå®šä½åŠ å¯†å‡½æ•°

![](img/5ac33253800fc8478bbb1a1b9f61e303_263.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_265.png)

æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ï¼šåœ¨ç›®æ ‡ç½‘ç«™çš„ç™»å½•é¡µé¢ï¼Œæ‰¾åˆ°å¯¹å¯†ç è¿›è¡ŒåŠ å¯†çš„JavaScriptä»£ç ã€‚

**æ­¥éª¤æ¼”ç¤ºï¼ˆä»¥æŸå¿«é€’ç½‘ç«™ä¸ºä¾‹ï¼‰ï¼š**

1.  **æŠ“åŒ…è§‚å¯Ÿ**ï¼šæ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰ï¼Œè¿›å…¥ç™»å½•é¡µï¼Œè¾“å…¥è´¦å·å¯†ç æäº¤ã€‚åœ¨`Network`ï¼ˆç½‘ç»œï¼‰æ ‡ç­¾ä¸­ï¼Œæ‰¾åˆ°ç™»å½•è¯·æ±‚ï¼ˆå¦‚`login.do`ï¼‰ï¼ŒæŸ¥çœ‹`Form Data`ï¼ˆè¡¨å•æ•°æ®ï¼‰ã€‚å‘ç°`password`å­—æ®µæ˜¯ä¸€é•¿ä¸²å¯†æ–‡ï¼Œè€Œéæ˜æ–‡ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_267.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_269.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_271.png)

2.  **æœç´¢å…³é”®å‚æ•°**ï¼šåœ¨`Sources`ï¼ˆæºä»£ç ï¼‰æˆ–`Elements`ï¼ˆå…ƒç´ ï¼‰æ ‡ç­¾ä¸­ï¼Œä½¿ç”¨å…¨å±€æœç´¢ï¼ˆCtrl+Shift+Fï¼‰ï¼Œæœç´¢è¿™ä¸ªåŠ å¯†å¯†ç çš„å‚æ•°åï¼Œå¦‚`encryptedPassword`ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_273.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_275.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_277.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_278.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_279.png)

3.  **å®šä½åŠ å¯†ä»£ç **ï¼šåœ¨æœç´¢ç»“æœä¸­ï¼Œæ‰¾åˆ°å¤„ç†ç™»å½•æäº¤çš„JavaScriptæ–‡ä»¶ï¼ˆå¦‚`login.js`ï¼‰ã€‚åœ¨å…¶ä¸­æ‰¾åˆ°ç±»ä¼¼ä¸‹é¢çš„ä»£ç ï¼š
    ```javascript
    $('#loginBtn').click(function() {
        var username = $('#username').val();
        var plainPwd = $('#password').val();

        // å…³é”®è¡Œï¼šå¯¹å¯†ç è¿›è¡ŒåŠ å¯†
        var encryptedPwd = encryptFunction(plainPwd); // æˆ– window.encrypt(plainPwd)

        $.post('/login.do', {
            username: username,
            password: encryptedPwd // å‘é€åŠ å¯†åçš„å¯†ç 
        }, function(data) {
            // å›è°ƒå¤„ç†
        });
    });
    ```

![](img/5ac33253800fc8478bbb1a1b9f61e303_281.png)

4.  **è®¾ç½®æ–­ç‚¹è°ƒè¯•**ï¼š
    *   åœ¨`encryptFunction`é‚£ä¸€è¡Œå·¦ä¾§çš„è¡Œå·ä¸Šç‚¹å‡»ï¼Œè®¾ç½®ä¸€ä¸ª**æ–­ç‚¹**ã€‚
    *   å›åˆ°é¡µé¢ï¼Œå†æ¬¡è¾“å…¥å¯†ç ç‚¹å‡»ç™»å½•ã€‚æµè§ˆå™¨æ‰§è¡Œåˆ°æ–­ç‚¹å¤„ä¼š**æš‚åœ**ã€‚
    *   åœ¨å³ä¾§çš„`Debugger`ï¼ˆè°ƒè¯•å™¨ï¼‰é¢æ¿ï¼Œä½ å¯ä»¥æŸ¥çœ‹æ­¤æ—¶æ‰€æœ‰å˜é‡çš„å€¼ã€‚
    *   å°†é¼ æ ‡æ‚¬åœåœ¨`encryptFunction`ä¸Šï¼Œæˆ–æŸ¥çœ‹`Scope`ï¼ˆä½œç”¨åŸŸï¼‰é¢æ¿ï¼Œæ‰¾åˆ°è¯¥å‡½æ•°çš„å®šä¹‰ã€‚å®ƒå¯èƒ½æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°ï¼Œä¹Ÿå¯èƒ½æ˜¯å¼•ç”¨äº†åƒ`CryptoJS`è¿™æ ·çš„åº“ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_283.png)

5.  **åœ¨æ§åˆ¶å°æ¨¡æ‹ŸåŠ å¯†**ï¼š
    *   å½“ä»£ç åœ¨æ–­ç‚¹å¤„æš‚åœæ—¶ï¼ŒåŠ å¯†å‡½æ•°å·²ç»è¢«åŠ è½½åˆ°å½“å‰æ‰§è¡Œç¯å¢ƒä¸­ã€‚
    *   åˆ‡æ¢åˆ°`Console`ï¼ˆæ§åˆ¶å°ï¼‰æ ‡ç­¾ã€‚
    *   ä½ å¯ä»¥ç›´æ¥è°ƒç”¨è¿™ä¸ªåŠ å¯†å‡½æ•°ï¼Œæµ‹è¯•ä½ è‡ªå·±çš„Payloadï¼š
        ```javascript
        // æµ‹è¯•åŠ å¯†å‡½æ•°
        encryptFunction("xiaodi"); // è¿”å›å¯†æ–‡
        encryptFunction("admin' OR '1'='1"); // è¿”å›æ³¨å…¥Payloadçš„å¯†æ–‡
        ```
    *   è·å¾—å¯†æ–‡åï¼Œä½ å°±å¯ä»¥ä½¿ç”¨Burp Suiteç­‰å·¥å…·ï¼Œç”¨è¿™ä¸ªå¯†æ–‡æ›¿æ¢åŸå§‹è¯·æ±‚ä¸­çš„`password`å­—æ®µï¼Œè¿›è¡ŒçœŸæ­£çš„æ¼æ´æµ‹è¯•äº†ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_285.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_287.png)

**é«˜çº§æƒ…å†µ**ï¼šå¦‚æœåŠ å¯†ç®—æ³•éå¸¸å¤æ‚æˆ–ç»è¿‡æ··æ·†ï¼Œå¯èƒ½éœ€è¦æ›´æ·±å…¥çš„é™æ€åˆ†æå’ŒåŠ¨æ€è·Ÿè¸ªï¼Œä½†åŸºæœ¬æ€è·¯ï¼ˆ**å®šä½ -> æ–­ç‚¹ -> è°ƒè¯• -> æ¨¡æ‹Ÿ**ï¼‰æ˜¯ä¸€è‡´çš„ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_289.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_291.png)

---

![](img/5ac33253800fc8478bbb1a1b9f61e303_293.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_295.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_297.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_299.png)

## ğŸ“ è¯¾ç¨‹æ€»ç»“

![](img/5ac33253800fc8478bbb1a1b9f61e303_301.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_303.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_305.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_307.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_309.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_311.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_313.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_315.png)

æœ¬èŠ‚è¯¾ä¸­æˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†ä¸¤ä¸ªå…³é”®çš„JSå®‰å…¨å®æˆ˜çŸ¥è¯†ç‚¹ï¼š

1.  **DOMæ“ä½œä¸å®‰å…¨**ï¼šç†è§£äº†DOMæ˜¯æµè§ˆå™¨æ“ä½œé¡µé¢çš„æ¥å£ã€‚**DOMå‹XSS**å‘ç”Ÿåœ¨å®¢æˆ·ç«¯JSä½¿ç”¨ä¸å¯ä¿¡æ•°æ®åŠ¨æ€æ›´æ–°DOMæ—¶ã€‚æµ‹è¯•æ—¶éœ€è¦å…³æ³¨æ•°æ®çš„æ¥æºå’Œç”¨æˆ·äº¤äº’äº‹ä»¶è§¦å‘çš„å®Œæ•´é“¾æ¡ã€‚
2.  **å‰ç«¯åŠ å¯†ä¸é€†å‘åˆ†æ**ï¼šè®¤è¯†åˆ°å‰ç«¯åŠ å¯†æ˜¯æµ‹è¯•ä¸­å¸¸è§çš„â€œéšœç¢â€ã€‚æŒæ¡äº†é€šè¿‡**æµè§ˆå™¨å¼€å‘è€…å·¥å…·**è¿›è¡Œé€†å‘è°ƒè¯•çš„åŸºæœ¬æµç¨‹ï¼š**ç½‘ç»œæŠ“åŒ… -> æœç´¢å®šä½ -> æ–­ç‚¹è°ƒè¯• -> æ§åˆ¶å°éªŒè¯**ï¼Œä»è€Œèƒ½å¤Ÿåˆ†æå‡ºåŠ å¯†é€»è¾‘ï¼Œä¸ºåç»­çš„æ¼æ´æµ‹è¯•é“ºå¹³é“è·¯ã€‚

![](img/5ac33253800fc8478bbb1a1b9f61e303_317.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_319.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_320.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_321.png)

![](img/5ac33253800fc8478bbb1a1b9f61e303_322.png)

è¿™äº›æŠ€èƒ½æ˜¯è¿›è¡Œç°ä»£Webåº”ç”¨å®‰å…¨æµ‹è¯•ï¼Œå°¤å…¶æ˜¯é»‘ç›’ä¸ç°ç›’æµ‹è¯•ä¸­ä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†ã€‚è¯·åŠ¡å¿…åœ¨å®éªŒç¯å¢ƒä¸­å¤šåŠ ç»ƒä¹ ï¼Œç†Ÿæ‚‰å¼€å‘è€…å·¥å…·çš„å„é¡¹åŠŸèƒ½ã€‚