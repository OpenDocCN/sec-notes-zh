# ğŸ›¡ï¸ è¯¾ç¨‹55ï¼šXSSé˜²å¾¡ä¸ç»•è¿‡å®æˆ˜

![](img/5e8e648caf87156c4c655b58f5248e45_1.png)

![](img/5e8e648caf87156c4c655b58f5248e45_3.png)

![](img/5e8e648caf87156c4c655b58f5248e45_5.png)

![](img/5e8e648caf87156c4c655b58f5248e45_7.png)

![](img/5e8e648caf87156c4c655b58f5248e45_9.png)

![](img/5e8e648caf87156c4c655b58f5248e45_11.png)

åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ä¸‰ç§ä¸»è¦çš„XSSå®‰å…¨é˜²å¾¡æ‰‹æ®µï¼šCSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰ã€HttpOnlyä»¥åŠä»£ç å±‚é¢çš„è¿‡æ»¤å™¨ã€‚æˆ‘ä»¬å°†äº†è§£å®ƒä»¬çš„å·¥ä½œåŸç†ã€å¦‚ä½•é˜²å¾¡XSSæ”»å‡»ï¼Œä»¥åŠåœ¨å®é™…åœºæ™¯ä¸­æ˜¯å¦å­˜åœ¨ç»•è¿‡è¿™äº›é˜²å¾¡çš„å¯èƒ½æ€§ã€‚è¯¾ç¨‹å†…å®¹å°†ç»“åˆæ¼”ç¤ºå’Œé¶åœºç»ƒä¹ ï¼Œå¸®åŠ©åˆå­¦è€…ç†è§£æ ¸å¿ƒæ¦‚å¿µã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_13.png)

![](img/5e8e648caf87156c4c655b58f5248e45_14.png)

![](img/5e8e648caf87156c4c655b58f5248e45_15.png)

![](img/5e8e648caf87156c4c655b58f5248e45_17.png)

![](img/5e8e648caf87156c4c655b58f5248e45_19.png)

![](img/5e8e648caf87156c4c655b58f5248e45_21.png)

![](img/5e8e648caf87156c4c655b58f5248e45_23.png)

![](img/5e8e648caf87156c4c655b58f5248e45_25.png)

## ğŸ“‹ æ¦‚è¿°ï¼šä¸‰ç§XSSé˜²å¾¡æ‰‹æ®µ

![](img/5e8e648caf87156c4c655b58f5248e45_27.png)

![](img/5e8e648caf87156c4c655b58f5248e45_29.png)

![](img/5e8e648caf87156c4c655b58f5248e45_31.png)

![](img/5e8e648caf87156c4c655b58f5248e45_33.png)

![](img/5e8e648caf87156c4c655b58f5248e45_35.png)

![](img/5e8e648caf87156c4c655b58f5248e45_37.png)

XSSçš„é˜²å¾¡ä¸»è¦æœ‰ä¸‰å—å†…å®¹ã€‚æœ¬è¯¾ç¨‹ä¸»è¦è®²è§£æœ€åä¸€å—ï¼Œå³ä»£ç å±‚é¢çš„è¿‡æ»¤ä¸ç»•è¿‡ã€‚å‰ä¸¤å—ï¼ˆCSPå’ŒHttpOnlyï¼‰è™½ç„¶ä¹Ÿæœ‰ç»•è¿‡æ‰‹æ³•ï¼Œä½†åœ¨å®æˆ˜ä¸­å¾ˆéš¾å®ç°ï¼Œå› ä¸ºæ¡ä»¶è‹›åˆ»ï¼Œå³ä½¿ç»•è¿‡ä¹Ÿä¸ä¸€å®šèƒ½å¸¦æ¥å®è´¨æ€§çš„å±å®³ã€‚å› æ­¤ï¼Œåœ¨å®æˆ˜ä¸­é‡åˆ°è¿™ç±»é˜²æŠ¤ï¼Œé€šå¸¸é€‰æ‹©æ”¾å¼ƒæˆ–ç®€å•å°è¯•çªç ´ã€‚è€Œä»£ç å±‚é¢çš„è¿‡æ»¤å’Œè¿‡æ»¤æ€§ä»£ç ï¼Œåˆ™æ˜¯å¯ä»¥å°è¯•çªç ´çš„é‡ç‚¹ã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_39.png)

![](img/5e8e648caf87156c4c655b58f5248e45_41.png)

![](img/5e8e648caf87156c4c655b58f5248e45_43.png)

![](img/5e8e648caf87156c4c655b58f5248e45_45.png)

![](img/5e8e648caf87156c4c655b58f5248e45_47.png)

![](img/5e8e648caf87156c4c655b58f5248e45_49.png)

![](img/5e8e648caf87156c4c655b58f5248e45_51.png)

## ğŸ”’ ç¬¬ä¸€éƒ¨åˆ†ï¼šCSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰

![](img/5e8e648caf87156c4c655b58f5248e45_53.png)

![](img/5e8e648caf87156c4c655b58f5248e45_55.png)

![](img/5e8e648caf87156c4c655b58f5248e45_57.png)

![](img/5e8e648caf87156c4c655b58f5248e45_59.png)

![](img/5e8e648caf87156c4c655b58f5248e45_60.png)

![](img/5e8e648caf87156c4c655b58f5248e45_62.png)

![](img/5e8e648caf87156c4c655b58f5248e45_64.png)

![](img/5e8e648caf87156c4c655b58f5248e45_66.png)

![](img/5e8e648caf87156c4c655b58f5248e45_68.png)

![](img/5e8e648caf87156c4c655b58f5248e45_70.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬æ¦‚è¿°äº†ä¸‰ç§é˜²å¾¡æ‰‹æ®µï¼Œæœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹ç¬¬ä¸€ç§ï¼šCSPã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_72.png)

![](img/5e8e648caf87156c4c655b58f5248e45_74.png)

![](img/5e8e648caf87156c4c655b58f5248e45_76.png)

![](img/5e8e648caf87156c4c655b58f5248e45_78.png)

![](img/5e8e648caf87156c4c655b58f5248e45_79.png)

CSPå…¨ç§°ä¸ºContent Security Policyï¼Œå³å†…å®¹å®‰å…¨ç­–ç•¥ã€‚å®ƒå¹¶éä¸“ä¸ºé˜²å¾¡XSSè€Œäº§ç”Ÿï¼Œè€Œæ˜¯ä¸€ç§ç­–ç•¥ï¼Œç”¨äºé™åˆ¶é¡µé¢å¯ä»¥åŠ è½½å“ªäº›å¤–éƒ¨èµ„æºã€‚å¼€å¯CSPåï¼Œä¼šé˜»æ­¢éåŒæºçš„å¤–éƒ¨èµ„æºåŠ è½½ï¼Œè¿™æ— æ„ä¸­ä¹Ÿé˜»æ­¢äº†å¤§å¤šæ•°XSSæ”»å‡»ï¼Œå› ä¸ºXSSæ”»å‡»è½½è·é€šå¸¸éœ€è¦ä»å¤–éƒ¨åŠ è½½ã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_81.png)

![](img/5e8e648caf87156c4c655b58f5248e45_83.png)

![](img/5e8e648caf87156c4c655b58f5248e45_85.png)

![](img/5e8e648caf87156c4c655b58f5248e45_87.png)

![](img/5e8e648caf87156c4c655b58f5248e45_89.png)

![](img/5e8e648caf87156c4c655b58f5248e45_91.png)

![](img/5e8e648caf87156c4c655b58f5248e45_93.png)

![](img/5e8e648caf87156c4c655b58f5248e45_95.png)

![](img/5e8e648caf87156c4c655b58f5248e45_97.png)

![](img/5e8e648caf87156c4c655b58f5248e45_99.png)

![](img/5e8e648caf87156c4c655b58f5248e45_101.png)

### CSPçš„æ ¸å¿ƒæ¦‚å¿µä¸æ¼”ç¤º

![](img/5e8e648caf87156c4c655b58f5248e45_103.png)

![](img/5e8e648caf87156c4c655b58f5248e45_105.png)

![](img/5e8e648caf87156c4c655b58f5248e45_107.png)

![](img/5e8e648caf87156c4c655b58f5248e45_109.png)

![](img/5e8e648caf87156c4c655b58f5248e45_111.png)

åœ¨PHPä¸­ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®å“åº”å¤´æ¥å¼€å¯CSPã€‚ä»¥ä¸‹ä»£ç æ¼”ç¤ºäº†å¦‚ä½•è®¾ç½®åªå…è®¸åŠ è½½æœ¬åœ°å›¾ç‰‡ï¼š

![](img/5e8e648caf87156c4c655b58f5248e45_113.png)

![](img/5e8e648caf87156c4c655b58f5248e45_115.png)

![](img/5e8e648caf87156c4c655b58f5248e45_117.png)

![](img/5e8e648caf87156c4c655b58f5248e45_119.png)

```php
header("Content-Security-Policy: img-src 'self'");
```

![](img/5e8e648caf87156c4c655b58f5248e45_121.png)

![](img/5e8e648caf87156c4c655b58f5248e45_123.png)

**æ¼”ç¤ºæ­¥éª¤ï¼š**
1.  æœªå¼€å¯CSPæ—¶ï¼Œé¡µé¢å¯ä»¥æ­£å¸¸åŠ è½½è¿œç¨‹å›¾ç‰‡ã€‚
2.  å¼€å¯ä¸Šè¿°CSPç­–ç•¥åï¼Œè¿œç¨‹å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œæµè§ˆå™¨æ§åˆ¶å°ä¼šæ˜¾ç¤ºCSPè¿è§„é”™è¯¯ã€‚
3.  å¯¹äºXSSæ”»å‡»ï¼Œå¦‚æœæ”»å‡»è½½è·ï¼ˆå¦‚çªƒå–Cookieçš„JSä»£ç ï¼‰éœ€è¦è¯·æ±‚å¤–éƒ¨æœåŠ¡å™¨ï¼Œåœ¨CSPå¼€å¯çš„æƒ…å†µä¸‹ï¼Œè¯¥è¯·æ±‚ä¼šè¢«é˜»æ­¢ï¼Œå¯¼è‡´æ”»å‡»å¤±è´¥ã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_125.png)

![](img/5e8e648caf87156c4c655b58f5248e45_127.png)

![](img/5e8e648caf87156c4c655b58f5248e45_129.png)

**CSPçš„å½±å“æ€»ç»“ï¼š** CSPé€šè¿‡é™åˆ¶å¤–éƒ¨èµ„æºåŠ è½½ï¼Œä½¿å¾—ä¾èµ–å¤–éƒ¨JSçš„XSSæ”»å‡»éš¾ä»¥ç”Ÿæ•ˆã€‚æ”»å‡»è€…åªèƒ½ä½¿ç”¨ç«™ç‚¹å†…éƒ¨çš„è„šæœ¬ï¼Œè€Œè¿™äº›è„šæœ¬é€šå¸¸æ— æ³•è¢«æ”»å‡»è€…æ§åˆ¶ã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_131.png)

![](img/5e8e648caf87156c4c655b58f5248e45_133.png)

![](img/5e8e648caf87156c4c655b58f5248e45_135.png)

![](img/5e8e648caf87156c4c655b58f5248e45_137.png)

![](img/5e8e648caf87156c4c655b58f5248e45_139.png)

### CSPçš„ç»•è¿‡å¯èƒ½æ€§

![](img/5e8e648caf87156c4c655b58f5248e45_141.png)

ç½‘ä¸Šå­˜åœ¨ä¸€äº›ç»•è¿‡CSPçš„æ–‡ç« ï¼Œä½†å¤§å¤šä¾èµ–äºé…ç½®ä¸å®Œæ•´æˆ–é—æ¼ã€‚ä¾‹å¦‚ï¼Œå¯èƒ½åªåœ¨æŸäº›é¡µé¢è®¾ç½®äº†CSPï¼Œè€Œå…¶ä»–é¡µé¢æ²¡æœ‰ï¼›æˆ–è€…ç­–ç•¥è®¾ç½®ä¸å¤Ÿä¸¥æ ¼ï¼Œå…è®¸äº†æŸäº›éé¢„æœŸçš„æ¥æºã€‚è¿™äº›ç»•è¿‡æ¡ä»¶åœ¨å®æˆ˜ä¸­å¾ˆéš¾æ»¡è¶³ã€‚å› æ­¤ï¼Œåœ¨å®æˆ˜ä¸­é‡åˆ°å®Œæ•´å¼€å¯çš„CSPï¼Œé€šå¸¸è®¤ä¸ºè¯¥ç‚¹æ— æ³•åˆ©ç”¨ã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_143.png)

![](img/5e8e648caf87156c4c655b58f5248e45_145.png)

![](img/5e8e648caf87156c4c655b58f5248e45_147.png)

![](img/5e8e648caf87156c4c655b58f5248e45_149.png)

![](img/5e8e648caf87156c4c655b58f5248e45_151.png)

![](img/5e8e648caf87156c4c655b58f5248e45_153.png)

## ğŸª ç¬¬äºŒéƒ¨åˆ†ï¼šHttpOnlyå±æ€§

![](img/5e8e648caf87156c4c655b58f5248e45_155.png)

![](img/5e8e648caf87156c4c655b58f5248e45_157.png)

![](img/5e8e648caf87156c4c655b58f5248e45_159.png)

![](img/5e8e648caf87156c4c655b58f5248e45_161.png)

![](img/5e8e648caf87156c4c655b58f5248e45_163.png)

![](img/5e8e648caf87156c4c655b58f5248e45_165.png)

![](img/5e8e648caf87156c4c655b58f5248e45_167.png)

![](img/5e8e648caf87156c4c655b58f5248e45_169.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†CSPï¼Œæœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹ä¸“é—¨ç”¨äºä¿æŠ¤Cookieçš„HttpOnlyå±æ€§ã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_171.png)

![](img/5e8e648caf87156c4c655b58f5248e45_173.png)

![](img/5e8e648caf87156c4c655b58f5248e45_175.png)

![](img/5e8e648caf87156c4c655b58f5248e45_177.png)

![](img/5e8e648caf87156c4c655b58f5248e45_179.png)

![](img/5e8e648caf87156c4c655b58f5248e45_181.png)

HttpOnlyæ˜¯è®¾ç½®åœ¨Cookieä¸Šçš„ä¸€ä¸ªæ ‡å¿—ï¼Œç”¨äºç¦æ­¢JavaScripté€šè¿‡`document.cookie` APIè®¿é—®è¯¥Cookieã€‚è¿™æ˜¯ä¸“é—¨ä¸ºå¢å¼ºCookieå®‰å…¨æ€§è€Œè®¾è®¡çš„ã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_183.png)

![](img/5e8e648caf87156c4c655b58f5248e45_185.png)

![](img/5e8e648caf87156c4c655b58f5248e45_187.png)

![](img/5e8e648caf87156c4c655b58f5248e45_189.png)

![](img/5e8e648caf87156c4c655b58f5248e45_191.png)

### HttpOnlyçš„è®¾ç½®ä¸æ•ˆæœ

![](img/5e8e648caf87156c4c655b58f5248e45_193.png)

![](img/5e8e648caf87156c4c655b58f5248e45_195.png)

![](img/5e8e648caf87156c4c655b58f5248e45_197.png)

![](img/5e8e648caf87156c4c655b58f5248e45_199.png)

![](img/5e8e648caf87156c4c655b58f5248e45_201.png)

åœ¨PHPä¸­ï¼Œå¯ä»¥é€šè¿‡`setcookie`å‡½æ•°è®¾ç½®HttpOnlyå±æ€§ï¼š

![](img/5e8e648caf87156c4c655b58f5248e45_203.png)

```php
setcookie("name", "xiaodi", time()+3600, "/", "", false, true); // æœ€åä¸€ä¸ªå‚æ•°trueè¡¨ç¤ºå¯ç”¨HttpOnly
setcookie("pass", "123456", time()+3600, "/", "", false, false); // falseè¡¨ç¤ºä¸å¯ç”¨HttpOnly
```

**æ¼”ç¤ºæ­¥éª¤ï¼š**
1.  åœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„â€œåº”ç”¨ç¨‹åºâ€ï¼ˆApplicationï¼‰æ ‡ç­¾é¡µä¸­ï¼Œå¯ä»¥æŸ¥çœ‹Cookieæ˜¯å¦å¯ç”¨äº†HttpOnlyï¼ˆæœ‰ä¸€ä¸ªå‹¾é€‰æ ‡è®°ï¼‰ã€‚
2.  å¯¹äºæœªå¯ç”¨HttpOnlyçš„Cookieï¼Œå¯ä»¥é€šè¿‡æ§åˆ¶å°æ‰§è¡Œ`document.cookie`è¯»å–ã€‚
3.  å¯¹äºå¯ç”¨äº†HttpOnlyçš„Cookieï¼Œ`document.cookie`æ— æ³•è¯»å–å…¶å€¼ã€‚
4.  åœ¨XSSæ”»å‡»ä¸­ï¼Œå¦‚æœçªƒå–Cookieçš„ä»£ç å°è¯•è¯»å–å—HttpOnlyä¿æŠ¤çš„Cookieï¼Œå°†æ— æ³•æˆåŠŸè·å–å…¶å†…å®¹ã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_205.png)

### HttpOnlyçš„ç»•è¿‡ä¸åº”å¯¹æ€è·¯

![](img/5e8e648caf87156c4c655b58f5248e45_207.png)

![](img/5e8e648caf87156c4c655b58f5248e45_209.png)

![](img/5e8e648caf87156c4c655b58f5248e45_211.png)

![](img/5e8e648caf87156c4c655b58f5248e45_213.png)

HttpOnlyçš„ç»•è¿‡æ‰‹æ®µéå¸¸æœ‰é™ä¸”æ¡ä»¶è‹›åˆ»ï¼ˆä¾‹å¦‚åˆ©ç”¨æŸäº›æ—§çš„PHPä¿¡æ¯é¡µé¢æ¼æ´ï¼‰ï¼Œåœ¨å½“ä»Šçš„äº’è”ç½‘ç¯å¢ƒä¸­åŸºæœ¬ä¸å¯è¡Œã€‚**ä¸»è¦çš„åº”å¯¹æ€è·¯æ˜¯è½¬æ¢æ”»å‡»æ–¹å¼**ï¼šæ—¢ç„¶æ— æ³•çªƒå–Cookieï¼Œå¯ä»¥å°è¯•å…¶ä»–åˆ©ç”¨æ–¹å¼ï¼Œä¾‹å¦‚ï¼š
*   ä½¿ç”¨XSSè¿›è¡Œé’“é±¼æ”»å‡»ã€‚
*   åˆ©ç”¨æµè§ˆå™¨æ”»å‡»æ¡†æ¶ï¼ˆå¦‚BeEFï¼‰æ§åˆ¶å—å®³è€…æµè§ˆå™¨ã€‚
*   ç›´æ¥æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œï¼ˆå¦‚ç¯¡æ”¹é¡µé¢å†…å®¹ã€å‘èµ·è¯·æ±‚ç­‰ï¼‰ã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_215.png)

![](img/5e8e648caf87156c4c655b58f5248e45_217.png)

![](img/5e8e648caf87156c4c655b58f5248e45_219.png)

![](img/5e8e648caf87156c4c655b58f5248e45_221.png)

![](img/5e8e648caf87156c4c655b58f5248e45_223.png)

![](img/5e8e648caf87156c4c655b58f5248e45_225.png)

![](img/5e8e648caf87156c4c655b58f5248e45_227.png)

HttpOnlyåªé˜²æŠ¤äº†Cookieçªƒå–è¿™ä¸€æ¡è·¯å¾„ï¼Œå¹¶æœªå®Œå…¨å°æ­»XSSçš„åˆ©ç”¨ã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_229.png)

![](img/5e8e648caf87156c4c655b58f5248e45_231.png)

![](img/5e8e648caf87156c4c655b58f5248e45_233.png)

![](img/5e8e648caf87156c4c655b58f5248e45_235.png)

![](img/5e8e648caf87156c4c655b58f5248e45_237.png)

![](img/5e8e648caf87156c4c655b58f5248e45_239.png)

## âš”ï¸ ç¬¬ä¸‰éƒ¨åˆ†ï¼šXSSè¿‡æ»¤å™¨ä¸é¶åœºå®æˆ˜

![](img/5e8e648caf87156c4c655b58f5248e45_241.png)

![](img/5e8e648caf87156c4c655b58f5248e45_243.png)

![](img/5e8e648caf87156c4c655b58f5248e45_245.png)

![](img/5e8e648caf87156c4c655b58f5248e45_247.png)

![](img/5e8e648caf87156c4c655b58f5248e45_249.png)

![](img/5e8e648caf87156c4c655b58f5248e45_251.png)

![](img/5e8e648caf87156c4c655b58f5248e45_253.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†æœåŠ¡ç«¯è®¾ç½®çš„é˜²æŠ¤ï¼Œæœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹åº”ç”¨ä»£ç å±‚é¢æœ€å¸¸è§çš„é˜²å¾¡ï¼šè¾“å…¥è¿‡æ»¤ä¸å‡€åŒ–ï¼Œå¹¶é€šè¿‡é¶åœºå­¦ä¹ ç»•è¿‡æŠ€å·§ã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_255.png)

![](img/5e8e648caf87156c4c655b58f5248e45_257.png)

![](img/5e8e648caf87156c4c655b58f5248e45_259.png)

![](img/5e8e648caf87156c4c655b58f5248e45_261.png)

![](img/5e8e648caf87156c4c655b58f5248e45_263.png)

![](img/5e8e648caf87156c4c655b58f5248e45_265.png)

![](img/5e8e648caf87156c4c655b58f5248e45_267.png)

![](img/5e8e648caf87156c4c655b58f5248e45_269.png)

XSSè¿‡æ»¤å™¨æŒ‡åœ¨æœåŠ¡å™¨ç«¯ä»£ç ä¸­å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œæ£€æŸ¥ã€è¿‡æ»¤æˆ–è½¬ä¹‰ï¼Œä¾‹å¦‚ç§»é™¤`<script>`æ ‡ç­¾ã€è½¬ä¹‰å°–æ‹¬å·ç­‰ã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_271.png)

![](img/5e8e648caf87156c4c655b58f5248e45_273.png)

![](img/5e8e648caf87156c4c655b58f5248e45_275.png)

![](img/5e8e648caf87156c4c655b58f5248e45_277.png)

![](img/5e8e648caf87156c4c655b58f5248e45_279.png)

### æ‰‹å·¥æµ‹è¯•ä¸ç»•è¿‡æ€è·¯

![](img/5e8e648caf87156c4c655b58f5248e45_281.png)

![](img/5e8e648caf87156c4c655b58f5248e45_283.png)

![](img/5e8e648caf87156c4c655b58f5248e45_285.png)

![](img/5e8e648caf87156c4c655b58f5248e45_287.png)

![](img/5e8e648caf87156c4c655b58f5248e45_289.png)

![](img/5e8e648caf87156c4c655b58f5248e45_291.png)

æ‰‹å·¥æµ‹è¯•XSSçš„æ ¸å¿ƒæ˜¯ï¼š**æ‰¾åˆ°é¡µé¢ä¸­æ‰€æœ‰ç”¨æˆ·å¯æ§çš„è¾“å…¥ç‚¹ï¼Œè§‚å¯Ÿå…¶è¾“å‡ºä½ç½®ï¼Œå¹¶å°è¯•æ„é€ Payloadä½¿å…¶ä¸­çš„JSä»£ç å¾—ä»¥æ‰§è¡Œã€‚**

![](img/5e8e648caf87156c4c655b58f5248e45_293.png)

![](img/5e8e648caf87156c4c655b58f5248e45_295.png)

ä»¥ä¸‹æ˜¯å…³é”®çš„æµ‹è¯•ä¸ç»•è¿‡æ­¥éª¤ï¼š

![](img/5e8e648caf87156c4c655b58f5248e45_297.png)

![](img/5e8e648caf87156c4c655b58f5248e45_299.png)

![](img/5e8e648caf87156c4c655b58f5248e45_301.png)

![](img/5e8e648caf87156c4c655b58f5248e45_303.png)

1.  **å¯»æ‰¾å¯æ§è¾“å…¥ä¸è¾“å‡ºç‚¹**ï¼šä¸ä»…åŒ…æ‹¬URLå‚æ•°ã€è¡¨å•å­—æ®µï¼Œè¿˜åŒ…æ‹¬HTTPè¯·æ±‚å¤´ï¼ˆå¦‚User-Agentã€Refererï¼‰ï¼Œä»¥åŠé¡µé¢ä¸­éšè—çš„è¡¨å•å­—æ®µã€‚
2.  **å°è¯•åŸºç¡€Payload**ï¼šè¾“å…¥å¦‚`<script>alert(1)</script>`ï¼Œæµ‹è¯•æ˜¯å¦è¢«ç›´æ¥æ‰§è¡Œã€‚
3.  **åˆ†æè¿‡æ»¤æœºåˆ¶**ï¼šå¦‚æœæœªæ‰§è¡Œï¼Œé€šè¿‡æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œåˆ†æè¾“å‡ºä½ç½®ã€‚å¸¸è§æƒ…å†µæœ‰ï¼š
    *   **è¾“å‡ºè¢«HTMLå®ä½“ç¼–ç **ï¼šå¦‚`<`è¢«è½¬ä¹‰ä¸º`&lt;`ã€‚è¿™é€šå¸¸éš¾ä»¥ç›´æ¥ç»•è¿‡ï¼Œéœ€å¯»æ‰¾æœªç¼–ç çš„è¾“å‡ºç‚¹æˆ–åˆ©ç”¨å…¶ä»–HTMLç‰¹æ€§ï¼ˆå¦‚äº‹ä»¶å¤„ç†å™¨ï¼‰ã€‚
    *   **è¾“å‡ºè¢«å¼•å·åŒ…è£¹åœ¨å­—ç¬¦ä¸²ä¸­**ï¼šå¦‚`value="ç”¨æˆ·è¾“å…¥"`ã€‚éœ€è¦é—­åˆå¼•å·ï¼Œç„¶åæ³¨å…¥HTML/JSä»£ç ã€‚
    *   **ç‰¹å®šå…³é”®å­—è¢«è¿‡æ»¤æˆ–åˆ é™¤**ï¼šå¦‚`script`ã€`on`ç­‰è¢«ç§»é™¤æˆ–æ›¿æ¢ã€‚
4.  **æ„é€ ç»•è¿‡Payload**ï¼šæ ¹æ®è¿‡æ»¤æƒ…å†µï¼Œé‡‡ç”¨ä¸åŒæŠ€å·§ï¼š
    *   **é—­åˆå¼•å·**ï¼š`"><script>alert(1)</script>`
    *   **åˆ©ç”¨HTMLäº‹ä»¶å¤„ç†å™¨**ï¼š`" onmouseover="alert(1)` ï¼ˆå½“é¼ æ ‡åˆ’è¿‡æ—¶è§¦å‘ï¼‰
    *   **ä½¿ç”¨å…¶ä»–æ ‡ç­¾**ï¼š`"><img src=x onerror=alert(1)>`
    *   **å¤§å°å†™ç»•è¿‡**ï¼š`<ScRiPt>alert(1)</sCrIpT>`
    *   **åŒå†™ç»•è¿‡**ï¼šå¦‚æœ`script`è¢«åˆ é™¤ï¼Œå°è¯•`<scrscriptipt>alert(1)</scrscriptipt>`
    *   **ç¼–ç ç»•è¿‡**ï¼šåœ¨æŸäº›ä¸Šä¸‹æ–‡ï¼ˆå¦‚URLï¼‰ä¸­ä½¿ç”¨URLç¼–ç æˆ–Unicodeã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_305.png)

![](img/5e8e648caf87156c4c655b58f5248e45_307.png)

![](img/5e8e648caf87156c4c655b58f5248e45_309.png)

![](img/5e8e648caf87156c4c655b58f5248e45_311.png)

![](img/5e8e648caf87156c4c655b58f5248e45_313.png)

### XSSé¶åœºï¼ˆXSS Labï¼‰å®æˆ˜ç¤ºä¾‹

![](img/5e8e648caf87156c4c655b58f5248e45_315.png)

![](img/5e8e648caf87156c4c655b58f5248e45_317.png)

![](img/5e8e648caf87156c4c655b58f5248e45_319.png)

æˆ‘ä»¬ä»¥å‡ å…³ä¸ºä¾‹ï¼Œæ¼”ç¤ºä¸Šè¿°æ€è·¯ï¼š

![](img/5e8e648caf87156c4c655b58f5248e45_321.png)

![](img/5e8e648caf87156c4c655b58f5248e45_323.png)

*   **ç¬¬1å…³**ï¼šæ— è¿‡æ»¤ï¼Œç›´æ¥æ³¨å…¥`<script>alert(1)</script>`å³å¯ã€‚
*   **ç¬¬2å…³**ï¼šè¾“å…¥è¢«æ”¾å…¥`value`å±æ€§ä¸­ï¼Œä¸”å°–æ‹¬å·è¢«å®ä½“åŒ–ã€‚éœ€è¦é—­åˆå¼•å·ï¼š`" onmouseover="alert(1)`ã€‚
*   **ç¬¬3å…³**ï¼šè¾“å…¥è¢«æ”¾å…¥`value`å±æ€§ï¼Œä¸”å¼•å·è¢«å®ä½“åŒ–ã€‚ä½¿ç”¨äº‹ä»¶å¤„ç†å™¨ï¼Œä¸”æ³¨æ„å¼•å·ç±»å‹ï¼š`' onmouseover='alert(1)`ã€‚
*   **ç¬¬5å…³**ï¼šè¿‡æ»¤äº†`script`å’Œ`on`å…³é”®å­—ã€‚ä½¿ç”¨`<a>`æ ‡ç­¾å’Œ`href`å±æ€§ï¼š`"><a href="javascript:alert(1)">click</a>`ã€‚
*   **ç¬¬10å…³**ï¼šè¾“å…¥è¢«èµ‹ç»™äº†ä¸€ä¸ªéšè—çš„è¾“å…¥æ¡†ï¼ˆ`type="hidden"`ï¼‰ã€‚éœ€è¦æ‰¾åˆ°è¯¥å‚æ•°åï¼Œæ‰‹åŠ¨æäº¤å¹¶åˆ©ç”¨äº‹ä»¶å¤„ç†å™¨ã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_325.png)

![](img/5e8e648caf87156c4c655b58f5248e45_327.png)

### è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ï¼šXSStrike

![](img/5e8e648caf87156c4c655b58f5248e45_329.png)

![](img/5e8e648caf87156c4c655b58f5248e45_331.png)

![](img/5e8e648caf87156c4c655b58f5248e45_333.png)

![](img/5e8e648caf87156c4c655b58f5248e45_335.png)

![](img/5e8e648caf87156c4c655b58f5248e45_337.png)

![](img/5e8e648caf87156c4c655b58f5248e45_339.png)

![](img/5e8e648caf87156c4c655b58f5248e45_341.png)

é™¤äº†æ‰‹å·¥æµ‹è¯•ï¼Œå¯ä»¥ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·å¦‚XSStrikeã€‚å®ƒèƒ½è‡ªåŠ¨çˆ¬å–é¡µé¢å‚æ•°ï¼Œä½¿ç”¨å¤§é‡é¢„å®šä¹‰çš„Payloadè¿›è¡Œæ¨¡ç³Šæµ‹è¯•ï¼Œå¹¶å°è¯•è¯†åˆ«WAFï¼ˆWebåº”ç”¨é˜²ç«å¢™ï¼‰å’Œå¸¸è§çš„è¿‡æ»¤è§„åˆ™ï¼Œç„¶åç”Ÿæˆç›¸åº”çš„ç»•è¿‡Payloadã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_343.png)

![](img/5e8e648caf87156c4c655b58f5248e45_345.png)

![](img/5e8e648caf87156c4c655b58f5248e45_347.png)

**åŸºæœ¬ä½¿ç”¨å‘½ä»¤ç¤ºä¾‹ï¼š**
```bash
python xsstrike.py -u "http://target.com/page?name=test"
```
å·¥å…·ä¼šæµ‹è¯•`name`å‚æ•°ï¼Œå¹¶æŠ¥å‘Šå¯èƒ½æˆåŠŸçš„Payloadã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_349.png)

![](img/5e8e648caf87156c4c655b58f5248e45_351.png)

![](img/5e8e648caf87156c4c655b58f5248e45_353.png)

![](img/5e8e648caf87156c4c655b58f5248e45_355.png)

![](img/5e8e648caf87156c4c655b58f5248e45_357.png)

![](img/5e8e648caf87156c4c655b58f5248e45_359.png)

**å·¥å…·å®šä½**ï¼šXSStrikeæ›´é€‚åˆç”¨äºè¾…åŠ©å‘ç°å’ŒéªŒè¯ï¼Œå°¤å…¶æ˜¯åœ¨é¢å¯¹å¤æ‚è¿‡æ»¤æ—¶å¯ä»¥æä¾›ç»•è¿‡æ€è·¯ã€‚ä½†æœ€ç»ˆPayloadçš„æœ‰æ•ˆæ€§å’Œåˆ©ç”¨æ–¹å¼ï¼Œä»éœ€ç»“åˆæ‰‹å·¥åˆ†æã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_361.png)

![](img/5e8e648caf87156c4c655b58f5248e45_363.png)

![](img/5e8e648caf87156c4c655b58f5248e45_365.png)

![](img/5e8e648caf87156c4c655b58f5248e45_367.png)

![](img/5e8e648caf87156c4c655b58f5248e45_369.png)

![](img/5e8e648caf87156c4c655b58f5248e45_371.png)

## ğŸ“ æ€»ç»“ä¸æ ¸å¿ƒè¦ç‚¹

![](img/5e8e648caf87156c4c655b58f5248e45_373.png)

![](img/5e8e648caf87156c4c655b58f5248e45_375.png)

![](img/5e8e648caf87156c4c655b58f5248e45_377.png)

![](img/5e8e648caf87156c4c655b58f5248e45_379.png)

![](img/5e8e648caf87156c4c655b58f5248e45_381.png)

æœ¬èŠ‚è¯¾æˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†ä¸‰ç§ä¸»æµçš„XSSé˜²å¾¡æ‰‹æ®µåŠå…¶ç»•è¿‡æ€è·¯ï¼š

![](img/5e8e648caf87156c4c655b58f5248e45_383.png)

![](img/5e8e648caf87156c4c655b58f5248e45_385.png)

![](img/5e8e648caf87156c4c655b58f5248e45_387.png)

1.  **CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰**ï¼šé€šè¿‡é™åˆ¶å¤–éƒ¨èµ„æºåŠ è½½æ¥é˜²å¾¡XSSã€‚é…ç½®å®Œæ•´æ—¶æéš¾ç»•è¿‡ï¼Œå®æˆ˜ä¸­é‡æ­¤é˜²æŠ¤é€šå¸¸æ”¾å¼ƒã€‚
2.  **HttpOnlyå±æ€§**ï¼šä¿æŠ¤Cookieä¸è¢«JSçªƒå–ã€‚æ— æ³•ç›´æ¥ç»•è¿‡ï¼Œä½†æ”»å‡»è€…å¯è½¬å‘å…¶ä»–åˆ©ç”¨æ–¹å¼ï¼ˆå¦‚é’“é±¼ã€æµè§ˆå™¨æ§åˆ¶ï¼‰ã€‚
3.  **ä»£ç å±‚è¿‡æ»¤å™¨**ï¼šæœ€å¸¸è§çš„é˜²æŠ¤ã€‚**æ ¸å¿ƒåœ¨äºâ€œè¾“å…¥-è¾“å‡ºâ€åˆ†æ**ï¼šæ‰¾åˆ°æ‰€æœ‰å¯æ§è¾“å…¥ç‚¹ï¼Œè§‚å¯Ÿå…¶è¾“å‡ºä¸Šä¸‹æ–‡ï¼Œæ ¹æ®è¿‡æ»¤ç±»å‹ï¼ˆå®ä½“åŒ–ã€å…³é”®å­—åˆ é™¤ã€å¼•å·åŒ…è£¹ï¼‰é‡‡ç”¨ç›¸åº”ç»•è¿‡æŠ€å·§ï¼ˆé—­åˆã€äº‹ä»¶å¤„ç†å™¨ã€ç¼–ç ã€å¤§å°å†™/åŒå†™ï¼‰ã€‚

![](img/5e8e648caf87156c4c655b58f5248e45_389.png)

![](img/5e8e648caf87156c4c655b58f5248e45_391.png)

![](img/5e8e648caf87156c4c655b58f5248e45_393.png)

**æœ€é‡è¦çš„æ€ç»´è½¬å˜**ï¼šXSSæ¼æ´çš„åˆ©ç”¨æˆåŠŸä¸å¦ï¼Œä¸ä»…å–å†³äºèƒ½å¦æ³¨å…¥ä»£ç ï¼Œè¿˜å–å†³äºå—å®³è€…æ˜¯å¦ä¼šè§¦å‘ï¼ˆå¯¹äºåå°„å‹/DOMå‹ï¼‰ï¼Œä»¥åŠæ˜¯å¦æœ‰ä¸¥å¯†çš„é˜²æŠ¤æªæ–½ã€‚åœ¨å®æˆ˜ä¸­ï¼Œéœ€è¦ç»¼åˆè¯„ä¼°æ¼æ´ä»·å€¼ã€é˜²æŠ¤å¼ºåº¦åŠåˆ©ç”¨æ¡ä»¶ã€‚