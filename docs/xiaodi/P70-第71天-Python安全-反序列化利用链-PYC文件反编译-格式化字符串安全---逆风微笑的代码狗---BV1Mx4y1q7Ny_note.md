![](img/a53f930152f1beb30c75097d9275ab2a_1.png)

![](img/a53f930152f1beb30c75097d9275ab2a_3.png)

![](img/a53f930152f1beb30c75097d9275ab2a_5.png)

![](img/a53f930152f1beb30c75097d9275ab2a_7.png)

![](img/a53f930152f1beb30c75097d9275ab2a_9.png)

# Pythonå®‰å…¨è¯¾ç¨‹ P70ï¼šååºåˆ—åŒ–ã€PYCåç¼–è¯‘ä¸æ ¼å¼åŒ–å­—ç¬¦ä¸² ğŸ”

![](img/a53f930152f1beb30c75097d9275ab2a_11.png)

![](img/a53f930152f1beb30c75097d9275ab2a_13.png)

![](img/a53f930152f1beb30c75097d9275ab2a_15.png)

![](img/a53f930152f1beb30c75097d9275ab2a_17.png)

![](img/a53f930152f1beb30c75097d9275ab2a_19.png)

![](img/a53f930152f1beb30c75097d9275ab2a_21.png)

![](img/a53f930152f1beb30c75097d9275ab2a_23.png)

![](img/a53f930152f1beb30c75097d9275ab2a_25.png)

åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ Pythonè¯­è¨€ä¸­ä¸‰ä¸ªç‰¹æœ‰çš„å®‰å…¨é—®é¢˜ï¼šPYCæ–‡ä»¶åç¼–è¯‘ã€ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨é“¾ä»¥åŠæ ¼å¼åŒ–å­—ç¬¦ä¸²å®‰å…¨ã€‚è¿™äº›çŸ¥è¯†ç‚¹åœ¨ä»£ç å®¡è®¡å’Œé€†å‘å·¥ç¨‹ä¸­è¾ƒä¸ºå¸¸è§ï¼Œæœ‰åŠ©äºæˆ‘ä»¬æ›´æ·±å…¥åœ°ç†è§£Pythonåº”ç”¨çš„å®‰å…¨é£é™©ã€‚

![](img/a53f930152f1beb30c75097d9275ab2a_27.png)

![](img/a53f930152f1beb30c75097d9275ab2a_29.png)

![](img/a53f930152f1beb30c75097d9275ab2a_31.png)

![](img/a53f930152f1beb30c75097d9275ab2a_33.png)

![](img/a53f930152f1beb30c75097d9275ab2a_35.png)

![](img/a53f930152f1beb30c75097d9275ab2a_37.png)

## ä¸€ã€PYCæ–‡ä»¶åç¼–è¯‘ ğŸ”„

![](img/a53f930152f1beb30c75097d9275ab2a_39.png)

![](img/a53f930152f1beb30c75097d9275ab2a_41.png)

![](img/a53f930152f1beb30c75097d9275ab2a_43.png)

![](img/a53f930152f1beb30c75097d9275ab2a_45.png)

![](img/a53f930152f1beb30c75097d9275ab2a_47.png)

![](img/a53f930152f1beb30c75097d9275ab2a_49.png)

![](img/a53f930152f1beb30c75097d9275ab2a_51.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†è¯¾ç¨‹æ¦‚è¿°ï¼Œæœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹PYCæ–‡ä»¶åç¼–è¯‘ã€‚æŸäº›ç¼–ç¨‹è¯­è¨€åœ¨å°†æºç ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶æˆ–åŒ…æ—¶ï¼Œä¼šç”Ÿæˆä¸­é—´æ–‡ä»¶ï¼ˆå¦‚Javaçš„`.class`ã€.NETçš„`.dll`ï¼‰ï¼Œè¿™äº›æ–‡ä»¶å¯ä»¥è¢«åç¼–è¯‘ä»¥è·å–æºç ã€‚Pythonä¹Ÿä¸ä¾‹å¤–ï¼Œå…¶ç¼–è¯‘åç”Ÿæˆçš„`.pyc`æ–‡ä»¶åŒæ ·å¯ä»¥åç¼–è¯‘ã€‚

![](img/a53f930152f1beb30c75097d9275ab2a_53.png)

![](img/a53f930152f1beb30c75097d9275ab2a_55.png)

![](img/a53f930152f1beb30c75097d9275ab2a_57.png)

![](img/a53f930152f1beb30c75097d9275ab2a_59.png)

ä»¥ä¸‹æ˜¯æ”¯æŒåç¼–è¯‘çš„è¯­è¨€åŠå…¶æ–‡ä»¶ç±»å‹ï¼š
*   **Java**: `.class`, `.jar` æ–‡ä»¶ï¼Œå¯ä½¿ç”¨JD-GUIç­‰å·¥å…·åç¼–è¯‘ã€‚
*   **.NET**: `.dll` æ–‡ä»¶ï¼Œå¯ä½¿ç”¨ `dnSpy` ç­‰å·¥å…·åç¼–è¯‘ã€‚
*   **Python**: `.pyc` æ–‡ä»¶ï¼Œå¯ä½¿ç”¨ `uncompyle6` ç­‰æ¨¡å—åç¼–è¯‘ã€‚

![](img/a53f930152f1beb30c75097d9275ab2a_61.png)

![](img/a53f930152f1beb30c75097d9275ab2a_63.png)

![](img/a53f930152f1beb30c75097d9275ab2a_65.png)

![](img/a53f930152f1beb30c75097d9275ab2a_67.png)

![](img/a53f930152f1beb30c75097d9275ab2a_69.png)

![](img/a53f930152f1beb30c75097d9275ab2a_71.png)

`.pyc`æ–‡ä»¶æ˜¯Pythonæºç ï¼ˆ`.py`ï¼‰ç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶ã€‚å½“Pythonç¨‹åºè¢«æ‰“åŒ…æˆç‹¬ç«‹å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆå¦‚`.exe`ï¼‰æ—¶ï¼Œé€šå¸¸ä¼šåŒ…å«`.pyc`æ–‡ä»¶ã€‚è·å–è¿™äº›æ–‡ä»¶åï¼Œå³å¯å°è¯•åç¼–è¯‘å‡ºåŸå§‹Pythonæºç ã€‚

![](img/a53f930152f1beb30c75097d9275ab2a_73.png)

![](img/a53f930152f1beb30c75097d9275ab2a_75.png)

**å¦‚ä½•è¿›è¡ŒPYCæ–‡ä»¶åç¼–è¯‘ï¼Ÿ**
1.  å®‰è£…åç¼–è¯‘å·¥å…·ï¼š`pip install uncompyle6`
2.  ä½¿ç”¨å·¥å…·è¿›è¡Œåç¼–è¯‘ã€‚ä¾‹å¦‚ï¼Œå¯¹ `gui.pyc` æ–‡ä»¶åç¼–è¯‘å¹¶è¾“å‡ºåˆ° `gui.py`ï¼š
    ```bash
    uncompyle6 -o gui.py gui.pyc
    ```

![](img/a53f930152f1beb30c75097d9275ab2a_77.png)

![](img/a53f930152f1beb30c75097d9275ab2a_79.png)

![](img/a53f930152f1beb30c75097d9275ab2a_81.png)

![](img/a53f930152f1beb30c75097d9275ab2a_83.png)

![](img/a53f930152f1beb30c75097d9275ab2a_85.png)

![](img/a53f930152f1beb30c75097d9275ab2a_87.png)

![](img/a53f930152f1beb30c75097d9275ab2a_89.png)

![](img/a53f930152f1beb30c75097d9275ab2a_91.png)

æ­¤æŠ€æœ¯ä¸»è¦ç”¨äºå¯¹Pythonç¼–å†™çš„å·¥å…·è¿›è¡Œé€†å‘åˆ†æå’Œä»£ç å®¡è®¡ã€‚åœ¨CTFçš„PWNï¼ˆé€†å‘å·¥ç¨‹ï¼‰æ–¹å‘ä¸­å¯èƒ½å‡ºç°ç›¸å…³é¢˜ç›®ï¼Œä½†åœ¨å¸¸è§„Webæ¸—é€æµ‹è¯•ä¸­å¹¶ä¸å¸¸è§ã€‚

![](img/a53f930152f1beb30c75097d9275ab2a_93.png)

![](img/a53f930152f1beb30c75097d9275ab2a_95.png)

![](img/a53f930152f1beb30c75097d9275ab2a_97.png)

![](img/a53f930152f1beb30c75097d9275ab2a_99.png)

![](img/a53f930152f1beb30c75097d9275ab2a_101.png)

![](img/a53f930152f1beb30c75097d9275ab2a_103.png)

![](img/a53f930152f1beb30c75097d9275ab2a_105.png)

![](img/a53f930152f1beb30c75097d9275ab2a_107.png)

![](img/a53f930152f1beb30c75097d9275ab2a_109.png)

## äºŒã€Pythonååºåˆ—åŒ–æ¼æ´ â›“ï¸

![](img/a53f930152f1beb30c75097d9275ab2a_111.png)

![](img/a53f930152f1beb30c75097d9275ab2a_113.png)

![](img/a53f930152f1beb30c75097d9275ab2a_115.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†PYCåç¼–è¯‘ï¼Œæœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹Pythonä¸­çš„ååºåˆ—åŒ–æ¼æ´ã€‚åºåˆ—åŒ–æ˜¯å°†å¯¹è±¡çŠ¶æ€è½¬æ¢ä¸ºå¯å­˜å‚¨æˆ–ä¼ è¾“çš„å­—èŠ‚æµçš„è¿‡ç¨‹ï¼Œååºåˆ—åŒ–åˆ™æ˜¯å…¶é€†è¿‡ç¨‹ã€‚Pythonä¸­å†…ç½®çš„`pickle`æ¨¡å—å¸¸ç”¨äºåºåˆ—åŒ–ã€‚

![](img/a53f930152f1beb30c75097d9275ab2a_117.png)

![](img/a53f930152f1beb30c75097d9275ab2a_119.png)

![](img/a53f930152f1beb30c75097d9275ab2a_121.png)

![](img/a53f930152f1beb30c75097d9275ab2a_123.png)

![](img/a53f930152f1beb30c75097d9275ab2a_125.png)

![](img/a53f930152f1beb30c75097d9275ab2a_127.png)

![](img/a53f930152f1beb30c75097d9275ab2a_129.png)

![](img/a53f930152f1beb30c75097d9275ab2a_131.png)

![](img/a53f930152f1beb30c75097d9275ab2a_133.png)

**Pythonä¸­å¸¸è§çš„åºåˆ—åŒ–/ååºåˆ—åŒ–å‡½æ•°åŠæ¨¡å—ï¼š**
*   `pickle.dump()` / `pickle.load()`: æ“ä½œæ–‡ä»¶ã€‚
*   `pickle.dumps()` / `pickle.loads()`: æ“ä½œå­—èŠ‚æµï¼ˆæ›´å¸¸ç”¨ï¼‰ã€‚
*   `json.load()` / `json.loads()`: JSONæ¨¡å—çš„ååºåˆ—åŒ–ã€‚
*   `yaml.load()`: YAMLæ¨¡å—çš„ååºåˆ—åŒ–ï¼ˆéœ€æ³¨æ„å®‰å…¨é£é™©ï¼‰ã€‚

![](img/a53f930152f1beb30c75097d9275ab2a_135.png)

![](img/a53f930152f1beb30c75097d9275ab2a_137.png)

![](img/a53f930152f1beb30c75097d9275ab2a_139.png)

![](img/a53f930152f1beb30c75097d9275ab2a_141.png)

![](img/a53f930152f1beb30c75097d9275ab2a_143.png)

ååºåˆ—åŒ–æ¼æ´çš„æˆå› åœ¨äºï¼Œå¦‚æœç¨‹åºååºåˆ—åŒ–äº†ç”¨æˆ·å¯æ§çš„æ¶æ„æ•°æ®ï¼Œå¹¶ä¸”è¯¥æ•°æ®æŒ‡å‘çš„ç±»ä¸­å®šä¹‰äº†ç‰¹æ®Šçš„é­”æœ¯æ–¹æ³•ï¼ˆ`__reduce__`, `__setstate__`ç­‰ï¼‰ï¼Œé‚£ä¹ˆåœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­å°±å¯èƒ½æ‰§è¡Œè¿™äº›æ–¹æ³•ä¸­çš„ä»»æ„ä»£ç ã€‚

![](img/a53f930152f1beb30c75097d9275ab2a_145.png)

![](img/a53f930152f1beb30c75097d9275ab2a_147.png)

![](img/a53f930152f1beb30c75097d9275ab2a_149.png)

![](img/a53f930152f1beb30c75097d9275ab2a_151.png)

![](img/a53f930152f1beb30c75097d9275ab2a_153.png)

![](img/a53f930152f1beb30c75097d9275ab2a_155.png)

![](img/a53f930152f1beb30c75097d9275ab2a_157.png)

![](img/a53f930152f1beb30c75097d9275ab2a_159.png)

![](img/a53f930152f1beb30c75097d9275ab2a_161.png)

![](img/a53f930152f1beb30c75097d9275ab2a_163.png)

![](img/a53f930152f1beb30c75097d9275ab2a_165.png)

![](img/a53f930152f1beb30c75097d9275ab2a_167.png)

**å…³é”®çš„é­”æœ¯æ–¹æ³•ï¼š**
*   `__reduce__()`: ååºåˆ—åŒ–æ—¶è‡ªåŠ¨è°ƒç”¨ã€‚
*   `__setstate__()`: ååºåˆ—åŒ–æ—¶è‡ªåŠ¨è°ƒç”¨ã€‚
*   `__getstate__()`: åºåˆ—åŒ–æ—¶è‡ªåŠ¨è°ƒç”¨ã€‚

![](img/a53f930152f1beb30c75097d9275ab2a_169.png)

![](img/a53f930152f1beb30c75097d9275ab2a_171.png)

![](img/a53f930152f1beb30c75097d9275ab2a_173.png)

![](img/a53f930152f1beb30c75097d9275ab2a_175.png)

![](img/a53f930152f1beb30c75097d9275ab2a_177.png)

![](img/a53f930152f1beb30c75097d9275ab2a_179.png)

![](img/a53f930152f1beb30c75097d9275ab2a_181.png)

![](img/a53f930152f1beb30c75097d9275ab2a_183.png)

![](img/a53f930152f1beb30c75097d9275ab2a_185.png)

**æ¼æ´åˆ©ç”¨æ¼”ç¤ºï¼š**
1.  **æ„é€ æ¶æ„ç±»**ï¼šåˆ›å»ºä¸€ä¸ªåŒ…å«`__reduce__`é­”æœ¯æ–¹æ³•çš„ç±»ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å…ƒç»„ã€‚
    ```python
    import pickle
    import os

    class Exploit:
        def __reduce__(self):
            # è¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯å¯è°ƒç”¨å¯¹è±¡ï¼ˆos.systemï¼‰ï¼Œç¬¬äºŒä¸ªæ˜¯å‚æ•°å…ƒç»„
            return (os.system, ('calc.exe', ))

    # åºåˆ—åŒ–æ¶æ„å¯¹è±¡
    exp = pickle.dumps(Exploit())
    print(exp) # è¾“å‡ºåºåˆ—åŒ–åçš„å­—èŠ‚æµ
    ```
2.  **è§¦å‘æ¼æ´**ï¼šå½“å­˜åœ¨æ¼æ´çš„ä»£ç å¯¹ä¸Šè¿°å­—èŠ‚æµè¿›è¡Œååºåˆ—åŒ–æ—¶ï¼ˆä¾‹å¦‚`pickle.loads(user_controlled_data)`ï¼‰ï¼Œä¾¿ä¼šå¼¹å‡ºè®¡ç®—å™¨ã€‚
    ```python
    pickle.loads(exp) # ååºåˆ—åŒ–ï¼Œæ‰§è¡Œå‘½ä»¤
    ```

![](img/a53f930152f1beb30c75097d9275ab2a_187.png)

![](img/a53f930152f1beb30c75097d9275ab2a_188.png)

![](img/a53f930152f1beb30c75097d9275ab2a_190.png)

![](img/a53f930152f1beb30c75097d9275ab2a_192.png)

![](img/a53f930152f1beb30c75097d9275ab2a_194.png)

![](img/a53f930152f1beb30c75097d9275ab2a_196.png)

![](img/a53f930152f1beb30c75097d9275ab2a_198.png)

![](img/a53f930152f1beb30c75097d9275ab2a_200.png)

![](img/a53f930152f1beb30c75097d9275ab2a_202.png)

![](img/a53f930152f1beb30c75097d9275ab2a_204.png)

![](img/a53f930152f1beb30c75097d9275ab2a_206.png)

![](img/a53f930152f1beb30c75097d9275ab2a_208.png)

![](img/a53f930152f1beb30c75097d9275ab2a_210.png)

![](img/a53f930152f1beb30c75097d9275ab2a_212.png)

![](img/a53f930152f1beb30c75097d9275ab2a_214.png)

![](img/a53f930152f1beb30c75097d9275ab2a_216.png)

![](img/a53f930152f1beb30c75097d9275ab2a_217.png)

**é»‘ç›’æµ‹è¯•ç‰¹å¾ï¼š**
åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œ`pickle`åºåˆ—åŒ–çš„æ•°æ®å¸¸ç»è¿‡Base64ç¼–ç ã€‚å…¶ç¼–ç åçš„ç‰¹å¾æ˜¯ä»¥ `gASV` æˆ–ç±»ä¼¼å˜ä½“å¼€å¤´ã€‚å¦‚æœåœ¨è¯·æ±‚å‚æ•°ï¼ˆå¦‚Cookieï¼‰ä¸­å‘ç°æ­¤ç±»ç‰¹å¾å€¼ï¼Œä¸”ç›®æ ‡ä¸ºPythonåº”ç”¨ï¼Œåˆ™å¯å°è¯•ååºåˆ—åŒ–æ¼æ´æµ‹è¯•ã€‚

![](img/a53f930152f1beb30c75097d9275ab2a_218.png)

![](img/a53f930152f1beb30c75097d9275ab2a_219.png)

![](img/a53f930152f1beb30c75097d9275ab2a_221.png)

![](img/a53f930152f1beb30c75097d9275ab2a_223.png)

![](img/a53f930152f1beb30c75097d9275ab2a_224.png)

![](img/a53f930152f1beb30c75097d9275ab2a_226.png)

![](img/a53f930152f1beb30c75097d9275ab2a_228.png)

![](img/a53f930152f1beb30c75097d9275ab2a_230.png)

![](img/a53f930152f1beb30c75097d9275ab2a_232.png)

![](img/a53f930152f1beb30c75097d9275ab2a_233.png)

## ä¸‰ã€Pythonæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ ğŸ“

![](img/a53f930152f1beb30c75097d9275ab2a_235.png)

![](img/a53f930152f1beb30c75097d9275ab2a_237.png)

![](img/a53f930152f1beb30c75097d9275ab2a_239.png)

![](img/a53f930152f1beb30c75097d9275ab2a_241.png)

![](img/a53f930152f1beb30c75097d9275ab2a_243.png)

![](img/a53f930152f1beb30c75097d9275ab2a_244.png)

![](img/a53f930152f1beb30c75097d9275ab2a_245.png)

![](img/a53f930152f1beb30c75097d9275ab2a_247.png)

![](img/a53f930152f1beb30c75097d9275ab2a_249.png)

![](img/a53f930152f1beb30c75097d9275ab2a_250.png)

![](img/a53f930152f1beb30c75097d9275ab2a_252.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†ååºåˆ—åŒ–æ¼æ´ï¼Œæœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹Pythonç‰¹æœ‰çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²å®‰å…¨é—®é¢˜ã€‚Pythonæä¾›äº†å¤šç§å­—ç¬¦ä¸²æ ¼å¼åŒ–æ–¹æ³•ï¼Œå…¶ä¸­åœ¨3.6ç‰ˆæœ¬å¼•å…¥çš„`f-string`ï¼ˆæ ¼å¼åŒ–å­—ç¬¦ä¸²å­—é¢å€¼ï¼‰è‹¥ä½¿ç”¨ä¸å½“ï¼Œå¯èƒ½é€ æˆä¸¥é‡çš„å®‰å…¨é—®é¢˜ã€‚

![](img/a53f930152f1beb30c75097d9275ab2a_254.png)

![](img/a53f930152f1beb30c75097d9275ab2a_256.png)

![](img/a53f930152f1beb30c75097d9275ab2a_258.png)

![](img/a53f930152f1beb30c75097d9275ab2a_260.png)

![](img/a53f930152f1beb30c75097d9275ab2a_262.png)

![](img/a53f930152f1beb30c75097d9275ab2a_264.png)

![](img/a53f930152f1beb30c75097d9275ab2a_266.png)

![](img/a53f930152f1beb30c75097d9275ab2a_268.png)

![](img/a53f930152f1beb30c75097d9275ab2a_270.png)

![](img/a53f930152f1beb30c75097d9275ab2a_272.png)

**Pythonå­—ç¬¦ä¸²æ ¼å¼åŒ–æ–¹æ³•ï¼š**
1.  **ç™¾åˆ†å· `%` æ ¼å¼åŒ–**ï¼š`"Hello, %s" % name`
2.  **`str.format()` æ–¹æ³•**ï¼š`"Hello, {}".format(name)`
3.  **`string.Formatter` ç±»**
4.  **f-string (Python 3.6+)**ï¼š`f"Hello, {name}"`

![](img/a53f930152f1beb30c75097d9275ab2a_274.png)

![](img/a53f930152f1beb30c75097d9275ab2a_276.png)

![](img/a53f930152f1beb30c75097d9275ab2a_278.png)

![](img/a53f930152f1beb30c75097d9275ab2a_280.png)

![](img/a53f930152f1beb30c75097d9275ab2a_282.png)

![](img/a53f930152f1beb30c75097d9275ab2a_284.png)

![](img/a53f930152f1beb30c75097d9275ab2a_286.png)

![](img/a53f930152f1beb30c75097d9275ab2a_288.png)

![](img/a53f930152f1beb30c75097d9275ab2a_290.png)

**æ¼æ´åŸç†ï¼š**
å½“æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å†…å®¹ï¼ˆç‰¹åˆ«æ˜¯`f-string`ä¸­èŠ±æ‹¬å·`{}`å†…çš„è¡¨è¾¾å¼ï¼‰å¯ç”±ç”¨æˆ·æ§åˆ¶æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„è¡¨è¾¾å¼ã€‚

![](img/a53f930152f1beb30c75097d9275ab2a_292.png)

![](img/a53f930152f1beb30c75097d9275ab2a_294.png)

![](img/a53f930152f1beb30c75097d9275ab2a_295.png)

![](img/a53f930152f1beb30c75097d9275ab2a_297.png)

![](img/a53f930152f1beb30c75097d9275ab2a_299.png)

![](img/a53f930152f1beb30c75097d9275ab2a_300.png)

![](img/a53f930152f1beb30c75097d9275ab2a_302.png)

![](img/a53f930152f1beb30c75097d9275ab2a_304.png)

![](img/a53f930152f1beb30c75097d9275ab2a_305.png)

![](img/a53f930152f1beb30c75097d9275ab2a_307.png)

**å±é™©ç¤ºä¾‹ï¼š**
```python
# å‡è®¾æ¨¡æ¿å­—ç¬¦ä¸²æ¥è‡ªç”¨æˆ·è¾“å…¥
user_input = "{__import__('os').system('calc.exe')}"
# ä½¿ç”¨f-stringè¿›è¡Œæ ¼å¼åŒ–
result = f"Result: {user_input}" # è¿™ä¸ä¼šæ‰§è¡Œå‘½ä»¤ï¼Œå› ä¸ºuser_inputæ•´ä½“è¢«å½“ä½œå­—ç¬¦ä¸²

![](img/a53f930152f1beb30c75097d9275ab2a_309.png)

![](img/a53f930152f1beb30c75097d9275ab2a_311.png)

![](img/a53f930152f1beb30c75097d9275ab2a_312.png)

![](img/a53f930152f1beb30c75097d9275ab2a_314.png)

![](img/a53f930152f1beb30c75097d9275ab2a_316.png)

![](img/a53f930152f1beb30c75097d9275ab2a_318.png)

![](img/a53f930152f1beb30c75097d9275ab2a_320.png)

![](img/a53f930152f1beb30c75097d9275ab2a_322.png)

![](img/a53f930152f1beb30c75097d9275ab2a_324.png)

![](img/a53f930152f1beb30c75097d9275ab2a_326.png)

![](img/a53f930152f1beb30c75097d9275ab2a_328.png)

![](img/a53f930152f1beb30c75097d9275ab2a_330.png)

# å±é™©çš„æ­£ç¡®ç¤ºä¾‹ï¼šç›´æ¥æ§åˆ¶f-stringè¡¨è¾¾å¼éƒ¨åˆ†
code = "__import__('os').system('calc.exe')"
# å¦‚æœç¨‹åºè¿™æ ·æ„é€ f-stringï¼ˆæåº¦å±é™©ï¼Œä»…ä½œæ¼”ç¤ºï¼‰ï¼š
eval(f"f'{{{code}}}'") # è¿™å°†æ‰§è¡Œå‘½ä»¤
```
æ›´å®é™…çš„æ¼æ´åœºæ™¯å¯èƒ½å‡ºç°åœ¨æœåŠ¡ç«¯ä½¿ç”¨`eval()`æˆ–`exec()`åŠ¨æ€æ‰§è¡ŒåŒ…å«ç”¨æˆ·å¯æ§å†…å®¹çš„f-stringæ¨¡æ¿æ—¶ã€‚

![](img/a53f930152f1beb30c75097d9275ab2a_332.png)

![](img/a53f930152f1beb30c75097d9275ab2a_334.png)

![](img/a53f930152f1beb30c75097d9275ab2a_336.png)

![](img/a53f930152f1beb30c75097d9275ab2a_338.png)

![](img/a53f930152f1beb30c75097d9275ab2a_340.png)

![](img/a53f930152f1beb30c75097d9275ab2a_342.png)

![](img/a53f930152f1beb30c75097d9275ab2a_344.png)

![](img/a53f930152f1beb30c75097d9275ab2a_346.png)

![](img/a53f930152f1beb30c75097d9275ab2a_348.png)

![](img/a53f930152f1beb30c75097d9275ab2a_350.png)

**`format()`æ–¹æ³•çš„å®‰å…¨é—®é¢˜ï¼š**
`str.format()`æ–¹æ³•å…è®¸é€šè¿‡ä½ç½®æˆ–å…³é”®å­—è®¿é—®å±æ€§ã€‚å¦‚æœæ ¼å¼åŒ–æ¨¡æ¿å¯æ§ï¼Œæ”»å‡»è€…å¯èƒ½è®¿é—®åˆ°ä¸åº”æš´éœ²çš„å¯¹è±¡å±æ€§ã€‚
```python
class User:
    def __init__(self):
        self.secret = "Sensitive Data"
        self.name = "Alice"

![](img/a53f930152f1beb30c75097d9275ab2a_352.png)

![](img/a53f930152f1beb30c75097d9275ab2a_354.png)

![](img/a53f930152f1beb30c75097d9275ab2a_356.png)

![](img/a53f930152f1beb30c75097d9275ab2a_358.png)

user = User()
# ç”¨æˆ·å¯æ§çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²
malicious_template = "{0.secret}"
print(malicious_template.format(user)) # è¾“å‡º: Sensitive Data
```

![](img/a53f930152f1beb30c75097d9275ab2a_360.png)

![](img/a53f930152f1beb30c75097d9275ab2a_362.png)

![](img/a53f930152f1beb30c75097d9275ab2a_364.png)

![](img/a53f930152f1beb30c75097d9275ab2a_366.png)

æ­¤æ¼æ´é€šå¸¸éœ€è¦åœ¨ä»£ç å®¡è®¡ï¼ˆç™½ç›’ï¼‰ä¸­å‘ç°ï¼Œé»‘ç›’æµ‹è¯•éš¾ä»¥ç›´æ¥åˆ©ç”¨ã€‚åœ¨å®¡è®¡Pythonä»£ç æ—¶ï¼Œåº”é‡ç‚¹å…³æ³¨ç”¨æˆ·è¾“å…¥æ˜¯å¦ç›´æ¥ç”¨äºæ„é€ `f-string`æˆ–ä¼ é€’ç»™`format()`æ–¹æ³•ï¼Œç‰¹åˆ«æ˜¯ä¸æ•æ„Ÿå‡½æ•°ï¼ˆå¦‚`eval`ï¼‰ç»“åˆä½¿ç”¨æ—¶ã€‚

![](img/a53f930152f1beb30c75097d9275ab2a_368.png)

![](img/a53f930152f1beb30c75097d9275ab2a_370.png)

![](img/a53f930152f1beb30c75097d9275ab2a_372.png)

![](img/a53f930152f1beb30c75097d9275ab2a_374.png)

![](img/a53f930152f1beb30c75097d9275ab2a_376.png)

![](img/a53f930152f1beb30c75097d9275ab2a_378.png)

![](img/a53f930152f1beb30c75097d9275ab2a_380.png)

![](img/a53f930152f1beb30c75097d9275ab2a_382.png)

![](img/a53f930152f1beb30c75097d9275ab2a_384.png)

![](img/a53f930152f1beb30c75097d9275ab2a_386.png)

## æ€»ç»“ ğŸ“š

![](img/a53f930152f1beb30c75097d9275ab2a_388.png)

![](img/a53f930152f1beb30c75097d9275ab2a_390.png)

![](img/a53f930152f1beb30c75097d9275ab2a_392.png)

![](img/a53f930152f1beb30c75097d9275ab2a_394.png)

![](img/a53f930152f1beb30c75097d9275ab2a_396.png)

![](img/a53f930152f1beb30c75097d9275ab2a_398.png)

![](img/a53f930152f1beb30c75097d9275ab2a_400.png)

![](img/a53f930152f1beb30c75097d9275ab2a_402.png)

![](img/a53f930152f1beb30c75097d9275ab2a_404.png)

æœ¬èŠ‚è¯¾æˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†Pythonå®‰å…¨ä¸­çš„ä¸‰ä¸ªå…³é”®çŸ¥è¯†ç‚¹ï¼š
1.  **PYCæ–‡ä»¶åç¼–è¯‘**ï¼šäº†è§£äº†`.pyc`æ–‡ä»¶çš„ä½œç”¨ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨`uncompyle6`å·¥å…·å°†å…¶åç¼–è¯‘ä¸ºPythonæºç ï¼Œè¿™ä¸»è¦ç”¨äºé€†å‘åˆ†æå’Œä»£ç å®¡è®¡ã€‚
2.  **Pythonååºåˆ—åŒ–æ¼æ´**ï¼šæ·±å…¥æ¢è®¨äº†`pickle`æ¨¡å—çš„ååºåˆ—åŒ–æœºåˆ¶ï¼Œç†è§£äº†å¦‚ä½•é€šè¿‡æ„é€ åŒ…å«`__reduce__`ç­‰é­”æœ¯æ–¹æ³•çš„æ¶æ„ç±»æ¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå¹¶æŒæ¡äº†é»‘ç›’æµ‹è¯•ä¸­çš„ç‰¹å¾è¯†åˆ«ï¼ˆBase64ç¼–ç åçš„`gASV`å‰ç¼€ï¼‰ã€‚
3.  **æ ¼å¼åŒ–å­—ç¬¦ä¸²å®‰å…¨**ï¼šè®¤è¯†äº†Pythonä¸­å‡ ç§å­—ç¬¦ä¸²æ ¼å¼åŒ–æ–¹æ³•ï¼Œé‡ç‚¹åˆ†æäº†`f-string`å’Œ`str.format()`åœ¨ç”¨æˆ·è¾“å…¥å¯æ§æ—¶å¯èƒ½å¸¦æ¥çš„å®‰å…¨é£é™©ï¼Œå¦‚ä¿¡æ¯æ³„éœ²æˆ–ä»£ç æ‰§è¡Œã€‚

![](img/a53f930152f1beb30c75097d9275ab2a_406.png)

![](img/a53f930152f1beb30c75097d9275ab2a_408.png)

![](img/a53f930152f1beb30c75097d9275ab2a_410.png)

![](img/a53f930152f1beb30c75097d9275ab2a_412.png)

![](img/a53f930152f1beb30c75097d9275ab2a_414.png)

![](img/a53f930152f1beb30c75097d9275ab2a_416.png)

![](img/a53f930152f1beb30c75097d9275ab2a_418.png)

è¿™äº›çŸ¥è¯†æœ‰åŠ©äºæˆ‘ä»¬åœ¨è¿›è¡ŒPythonåº”ç”¨å®‰å…¨è¯„ä¼°æ—¶ï¼Œä»ä»£ç å±‚é¢å’Œè¿è¡Œå±‚é¢å‘ç°æ›´æ·±å±‚æ¬¡çš„å®‰å…¨éšæ‚£ã€‚