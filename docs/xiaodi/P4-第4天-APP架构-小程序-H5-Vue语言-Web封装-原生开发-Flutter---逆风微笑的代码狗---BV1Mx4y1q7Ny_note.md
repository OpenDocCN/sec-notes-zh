# 🚀 移动应用安全基础：APP架构与小程序开发入门（P4）

![](img/c76cc4c10db2f51a99b1b53767648187_1.png)

![](img/c76cc4c10db2f51a99b1b53767648187_3.png)

在本节课中，我们将学习移动应用（APP）和小程序的基本架构。了解这些知识是为后续学习移动安全和小程序安全测试做准备。课程内容以演示为主，我们将通过实例对比，帮助你理解不同开发方式的特点及其对安全测试的影响。

![](img/c76cc4c10db2f51a99b1b53767648187_5.png)

![](img/c76cc4c10db2f51a99b1b53767648187_7.png)

![](img/c76cc4c10db2f51a99b1b53767648187_9.png)

## 📱 APP开发的四种主要架构

![](img/c76cc4c10db2f51a99b1b53767648187_10.png)

![](img/c76cc4c10db2f51a99b1b53767648187_12.png)

![](img/c76cc4c10db2f51a99b1b53767648187_14.png)

![](img/c76cc4c10db2f51a99b1b53767648187_16.png)

![](img/c76cc4c10db2f51a99b1b53767648187_18.png)

![](img/c76cc4c10db2f51a99b1b53767648187_20.png)

上一节我们介绍了课程目标，本节中我们来看看APP开发的几种主要方式。根据开发技术和实现原理，APP的架构大致可以分为四类。

![](img/c76cc4c10db2f51a99b1b53767648187_22.png)

![](img/c76cc4c10db2f51a99b1b53767648187_23.png)

![](img/c76cc4c10db2f51a99b1b53767648187_25.png)

![](img/c76cc4c10db2f51a99b1b53767648187_27.png)

![](img/c76cc4c10db2f51a99b1b53767648187_29.png)

以下是四种主要的APP开发架构：

![](img/c76cc4c10db2f51a99b1b53767648187_31.png)

![](img/c76cc4c10db2f51a99b1b53767648187_33.png)

![](img/c76cc4c10db2f51a99b1b53767648187_35.png)

![](img/c76cc4c10db2f51a99b1b53767648187_37.png)

![](img/c76cc4c10db2f51a99b1b53767648187_38.png)

![](img/c76cc4c10db2f51a99b1b53767648187_39.png)

![](img/c76cc4c10db2f51a99b1b53767648187_40.png)

1.  **原生开发**：使用平台特定的语言进行开发。
    *   **安卓 (Android)**：主要使用 **Java** 或 **Kotlin** 语言。
    *   **苹果 (iOS)**：主要使用 **Objective-C** 或 **Swift** 语言。
2.  **H5语言开发**：使用 **HTML5**、**CSS** 和 **JavaScript** 等前端技术进行开发。
3.  **Flutter开发**：使用 **Dart** 语言和Flutter框架进行跨平台开发。
4.  **Web封装开发**：将现有的网站直接封装成一个APP应用。

![](img/c76cc4c10db2f51a99b1b53767648187_42.png)

![](img/c76cc4c10db2f51a99b1b53767648187_44.png)

![](img/c76cc4c10db2f51a99b1b53767648187_45.png)

## 🌐 第一种架构：Web封装开发

现在，我们来详细看看第一种架构——Web封装开发。这种方式的核心是将一个完整的网站直接“套”在一个APP的外壳里。

![](img/c76cc4c10db2f51a99b1b53767648187_47.png)

![](img/c76cc4c10db2f51a99b1b53767648187_49.png)

![](img/c76cc4c10db2f51a99b1b53767648187_51.png)

为了直观演示，我们首先需要搭建一个网站。以下是搭建网站的基本步骤：

![](img/c76cc4c10db2f51a99b1b53767648187_53.png)

![](img/c76cc4c10db2f51a99b1b53767648187_55.png)

![](img/c76cc4c10db2f51a99b1b53767648187_57.png)

1.  购买一台云服务器，选择最低配置和按流量计费。
2.  为服务器设置密码并完成购买。
3.  在服务器上安装宝塔面板，用于快速部署网站。
4.  通过宝塔面板一键部署一个商城网站源码（例如ShopEx）。

![](img/c76cc4c10db2f51a99b1b53767648187_59.png)

![](img/c76cc4c10db2f51a99b1b53767648187_60.png)

![](img/c76cc4c10db2f51a99b1b53767648187_61.png)

![](img/c76cc4c10db2f51a99b1b53767648187_62.png)

![](img/c76cc4c10db2f51a99b1b53767648187_64.png)

网站搭建完成后，其界面在电脑和手机浏览器上访问时，会根据设备类型自动适配显示。

![](img/c76cc4c10db2f51a99b1b53767648187_66.png)

接下来，我们将这个网站封装成APP。以下是使用在线封装平台将网站转为APP的步骤：

![](img/c76cc4c10db2f51a99b1b53767648187_68.png)

![](img/c76cc4c10db2f51a99b1b53767648187_70.png)

1.  访问如“一门APP”或“变色龙”等在线封装平台。
2.  输入我们刚搭建的网站地址。
3.  配置APP的名称、图标和启动图等基本信息。
4.  平台会自动生成安卓（APK）或iOS安装包。

![](img/c76cc4c10db2f51a99b1b53767648187_72.png)

![](img/c76cc4c10db2f51a99b1b53767648187_74.png)

![](img/c76cc4c10db2f51a99b1b53767648187_76.png)

![](img/c76cc4c10db2f51a99b1b53767648187_78.png)

生成的APP安装到手机或模拟器后，打开它，你会发现其内容与直接用手机浏览器访问该网站几乎一模一样。这说明此类APP的本质就是一个内置了浏览器内核的容器，加载并显示了指定的网页。

![](img/c76cc4c10db2f51a99b1b53767648187_80.png)

![](img/c76cc4c10db2f51a99b1b53767648187_82.png)

![](img/c76cc4c10db2f51a99b1b53767648187_84.png)

**核心概念**：这种APP的**源码**就是其封装的网站源码。例如，我们部署的商城网站是基于PHP的，那么封装出的APP核心就是那些PHP文件。

![](img/c76cc4c10db2f51a99b1b53767648187_86.png)

![](img/c76cc4c10db2f51a99b1b53767648187_88.png)

**安全测试思路**：由于这种APP完全等同于其背后的网站，因此对其的安全测试就等同于对**常规网站（Web应用）** 进行渗透测试，方法完全一致。

## ⚙️ 第二种架构：原生开发

上一节我们了解了Web封装开发，本节中我们来看看功能更强大、也更复杂的原生开发。原生开发是指使用平台官方推荐的语言和工具，从零开始编写APP。

![](img/c76cc4c10db2f51a99b1b53767648187_90.png)

![](img/c76cc4c10db2f51a99b1b53767648187_92.png)

我们以一个仿网易云音乐的开源安卓APP为例。将其源码在 **Android Studio**（安卓官方开发工具）中打开，可以看到其项目结构完全由Java代码、XML布局文件等原生组件构成。

与封装APP不同，原生APP的界面、逻辑和数据交互都是独立编写的，不依赖于某个现成的网站。它的界面切换流畅，功能集成度高。

![](img/c76cc4c10db2f51a99b1b53767648187_94.png)

**核心概念**：原生APP的**源码**是平台特定的代码，例如安卓APP的Java代码。

![](img/c76cc4c10db2f51a99b1b53767648187_96.png)

![](img/c76cc4c10db2f51a99b1b53767648187_98.png)

![](img/c76cc4c10db2f51a99b1b53767648187_100.png)

![](img/c76cc4c10db2f51a99b1b53767648187_102.png)

![](img/c76cc4c10db2f51a99b1b53767648187_104.png)

**安全测试思路**：对原生APP的安全测试，重点在于**信息收集**。主要手段有两种：
*   **抓包分析**：使用抓包工具（如Burp Suite、Fiddler）拦截APP与服务器通信的数据流，从中发现API接口、域名等资产。
*   **反编译分析**：使用反编译工具（如Jadx、JEB）将APP安装包还原成近似源码，从中静态查找硬编码的密钥、接口地址、敏感逻辑等资产。

![](img/c76cc4c10db2f51a99b1b53767648187_106.png)

![](img/c76cc4c10db2f51a99b1b53767648187_108.png)

收集到的资产（如API接口、后台域名）将成为后续安全测试（如漏洞扫描、渗透测试）的目标。

![](img/c76cc4c10db2f51a99b1b53767648187_110.png)

![](img/c76cc4c10db2f51a99b1b53767648187_112.png)

![](img/c76cc4c10db2f51a99b1b53767648187_114.png)

![](img/c76cc4c10db2f51a99b1b53767648187_116.png)

![](img/c76cc4c10db2f51a99b1b53767648187_117.png)

![](img/c76cc4c10db2f51a99b1b53767648187_119.png)

## 🎨 第三种架构：H5 + Vue 开发

![](img/c76cc4c10db2f51a99b1b53767648187_121.png)

![](img/c76cc4c10db2f51a99b1b53767648187_123.png)

![](img/c76cc4c10db2f51a99b1b53767648187_125.png)

![](img/c76cc4c10db2f51a99b1b53767648187_127.png)

![](img/c76cc4c10db2f51a99b1b53767648187_129.png)

![](img/c76cc4c10db2f51a99b1b53767648187_131.png)

除了原生开发和Web封装，还有一种流行的混合开发模式，即使用 **H5（HTML5）** 配合前端框架（如 **Vue.js**、**React**）来开发APP。

![](img/c76cc4c10db2f51a99b1b53767648187_133.png)

![](img/c76cc4c10db2f51a99b1b53767648187_135.png)

![](img/c76cc4c10db2f51a99b1b53767648187_137.png)

![](img/c76cc4c10db2f51a99b1b53767648187_139.png)

![](img/c76cc4c10db2f51a99b1b53767648187_141.png)

我们使用 **HBuilderX** 这类开发工具可以快速创建此类项目。工具提供了许多模板，生成的项目源码主要由 `.vue` 文件、HTML和CSS组成。这类项目有一个显著特点：**一套代码，多端发布**。同一套Vue代码，可以编译发布为：
*   Web网站
*   安卓APP
*   iOS APP
*   各类小程序（微信、支付宝等）

![](img/c76cc4c10db2f51a99b1b53767648187_143.png)

![](img/c76cc4c10db2f51a99b1b53767648187_145.png)

![](img/c76cc4c10db2f51a99b1b53767648187_147.png)

![](img/c76cc4c10db2f51a99b1b53767648187_149.png)

**核心概念**：此类应用的**源码**是 **Vue组件**（由`<template>`、`<script>`、`<style>`构成）和相关的JS文件。

![](img/c76cc4c10db2f51a99b1b53767648187_151.png)

![](img/c76cc4c10db2f51a99b1b53767648187_153.png)

**安全测试思路**：这类应用属于**前后端分离**架构。前端（Vue）负责展示和交互，数据通过API接口与后端通信。因此，安全测试重点关注：
1.  **前端框架自身的安全问题**（较少见）。
2.  **API接口的安全**：这是主要风险点，测试方法与测试Web API相同，需关注鉴权、参数注入、逻辑漏洞等。
3.  同样需要配合**抓包**来发现和分析API接口。

![](img/c76cc4c10db2f51a99b1b53767648187_155.png)

![](img/c76cc4c10db2f51a99b1b53767648187_157.png)

![](img/c76cc4c10db2f51a99b1b53767648187_159.png)

![](img/c76cc4c10db2f51a99b1b53767648187_161.png)

## 📲 小程序的两种实现方式

![](img/c76cc4c10db2f51a99b1b53767648187_163.png)

![](img/c76cc4c10db2f51a99b1b53767648187_165.png)

![](img/c76cc4c10db2f51a99b1b53767648187_167.png)

![](img/c76cc4c10db2f51a99b1b53767648187_169.png)

![](img/c76cc4c10db2f51a99b1b53767648187_171.png)

小程序（如微信小程序、支付宝小程序）的实现方式与APP类似，主要也有两种。

![](img/c76cc4c10db2f51a99b1b53767648187_173.png)

![](img/c76cc4c10db2f51a99b1b53767648187_175.png)

以下是两种常见的小程序开发方式：

![](img/c76cc4c10db2f51a99b1b53767648187_177.png)

1.  **网站封装模式**：与APP的Web封装类似，一些平台支持将网址直接打包成小程序。需要在平台配置小程序密钥等信息。
2.  **原生开发模式**：使用小程序官方框架（如微信小程序的WXML、WXSS）或使用 **Uni-app**（基于Vue语法）等跨端框架进行开发。开发者需要使用**微信开发者工具**等官方IDE进行开发和调试。

![](img/c76cc4c10db2f51a99b1b53767648187_179.png)

![](img/c76cc4c10db2f51a99b1b53767648187_181.png)

**安全测试思路**：
*   对于**网站封装型**小程序，测试目标就是其封装的网站。
*   对于**原生开发型**小程序，测试思路与“H5+Vue”开发的APP类似，重点在于抓包分析其网络请求，测试后端API接口的安全性。小程序的前端代码可以更容易地被获取和审查。

![](img/c76cc4c10db2f51a99b1b53767648187_183.png)

![](img/c76cc4c10db2f51a99b1b53767648187_185.png)

![](img/c76cc4c10db2f51a99b1b53767648187_187.png)

## 💡 课程总结与思考

![](img/c76cc4c10db2f51a99b1b53767648187_189.png)

本节课我们一起学习了移动应用和小程序的四种主要架构：**Web封装**、**原生开发**、**H5+Vue开发**以及**小程序的两种形态**。

![](img/c76cc4c10db2f51a99b1b53767648187_191.png)

![](img/c76cc4c10db2f51a99b1b53767648187_193.png)

![](img/c76cc4c10db2f51a99b1b53767648187_194.png)

![](img/c76cc4c10db2f51a99b1b53767648187_196.png)

理解这些架构对于安全测试至关重要，因为它决定了我们的测试入口和方法：
*   遇到一个**Web封装**的APP，你应该直接将其视为网站进行测试。
*   遇到一个**原生开发**的APP，你需要使用抓包和反编译技术先提取资产（接口、域名）。
*   遇到一个**H5/Vue开发**的应用或小程序，你应该重点关注其API接口的安全。

如何快速判断一个APP属于哪种类型？这通常需要经验：
*   **观察交互**：界面是否粗糙，滑动是否卡顿，是否带有明显的浏览器特征（如地址栏闪现）。
*   **分析功能**：功能是否强烈依赖网络，是否与某个已知网站功能完全一致。
*   **技术验证**：最准确的方式是反编译查看源码结构。

![](img/c76cc4c10db2f51a99b1b53767648187_198.png)

![](img/c76cc4c10db2f51a99b1b53767648187_200.png)

![](img/c76cc4c10db2f51a99b1b53767648187_202.png)

通过本课的学习，希望你能够建立起对移动应用底层架构的基本认知，为后续学习具体的移动安全测试技术打下坚实的基础。