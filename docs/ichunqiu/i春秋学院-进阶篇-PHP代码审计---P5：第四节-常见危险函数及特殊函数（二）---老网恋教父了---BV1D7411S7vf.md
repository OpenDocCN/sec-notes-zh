# i春秋学院 进阶篇 PHP代码审计 - P5：第四节 常见危险函数及特殊函数（二） - 老网恋教父了 - BV1D7411S7vf

![](img/32bf2e0564967235d25e07b5238ab36b_0.png)

。我们再来看。变量覆盖相关的一些函数。他是STR好这些函数都是把啊把字符串。转化为。啊，变量。并设置到当前域。如果哦我们来说这个pasTR这个函数。如果我们后面定义了一个。啊，数组传递一个数组进来。

那么它解析的变量就会啊设置到数主数主域里面。如果没有设置的话，他就会设置到当前域。我们还是来看代码。

![](img/32bf2e0564967235d25e07b5238ab36b_2.png)

嗯，首先复制STR哎这一串字符串。嗯，很明显，这一上支付算就是我们post或者get内容的那种形式。嗯，首先我们就。嗯，把它尽量解析到数组里面。好，我们输出这个数组。嗯，再判断一下。

first这个变量是否存在？Yeah。然后我们再再用一下这个paSTR这个函数嗯，解析这一个字符串，但没有设置啊这个数组，它就解析到当前域。我们再一次判断它这个或是否存在。好，后面是输出。

后面啊它的三个变量。来执行。首先就啊。也击到速度，同时输出速度也确实是啊两个。一个是。普通的是不算，一个是速度。好，他就判断fors不存在，因为它已经复制复到了数度里面，而没有在当前域。好。

第二次设置的时候。然后这个fort就存在了。嗯，把它设置到当前域了，后面输出的成功了。啊，所以说我们如果遇到这种变量，可能导致变量覆盖的函数。啊，就可能会把某一些变量覆盖掉。这成我们特定的值。

从而导致可能会geel之类的。

![](img/32bf2e0564967235d25e07b5238ab36b_4.png)

然后。是其他的一些。海珠莲目录。然后这个函数。呃，比较少见。嗯。类似的链目录有也不少有类。类方法也有cancanDIR。Oh， globalbal。啊，却是一种呃使用规则去寻找匹配的文件路径。

像筛选一样。

![](img/32bf2e0564967235d25e07b5238ab36b_6.png)

然后我们来看具体代码。啊，这里就是。嗯，筛选当前目录下点PP结尾的所有文件。好，再输出执行。输出了9个文件，也就当前目录下。嗯。有9个PP文件。然后我们来设再设置一下T开头。啊，并且点PP结尾的有几个。



![](img/32bf2e0564967235d25e07b5238ab36b_8.png)

啊说错了俩。

![](img/32bf2e0564967235d25e07b5238ab36b_10.png)

好，这里就是这两个。这个函数呃在一些函数被禁用，它就被忽略的时候，你就可以用这个函数去读类目录。

![](img/32bf2e0564967235d25e07b5238ab36b_12.png)

。然后是一些无参数获取信息的函数。啊，第1个PP info我已经说了，所以说这里列出几个都是。返回到数度里面的一些。我觉得比较有用的汉语。啊，这里的第一个就是。列出所有已定义的变量。

这所谓的变量就是我们输入的啊get post。还有c之类的。我们传递过去的一些变量，或者是当前页面所定义的变量。第二个获取定义的常量。嗯，这个就是。会搜出。啊，系统的一些内置的常量或者是自定义的常量。

然后第3个。呃，输出所有已定义的函数，这个也是分系统定义的函数，以及用户自定义的函数。好，最后一个就输出我们所包含的文件。我们包含了多少个，他就会输出多少个，同时他会优先输出本身。



![](img/32bf2e0564967235d25e07b5238ab36b_14.png)

那我们去看具体的代码。首先第一个是输出变量。嗯，我们来这里。啊，定义一个变量。好，同西也是输出所有的变量。



![](img/32bf2e0564967235d25e07b5238ab36b_16.png)

好，我们到网页上去执行。我们这里啊get了一个V。然后可以post一个A等于TS。没。嗯，这里就是我们get一个V，po一个A以及coy上面的。KHP says saysID。好，因为我们没有上传。

它这里就是空。

![](img/32bf2e0564967235d25e07b5238ab36b_18.png)

随后是我们自定义的tt。这就是或许一定有变量。嗯。然后是。获取定义的长量。首先它会我们先定义一个常量，然后再输出这个输出会把先输出所有的系统内定的一些PP内置的常量。

然后再是我们输出的一些我们自定义的常量。

![](img/32bf2e0564967235d25e07b5238ab36b_20.png)

Yeah。他们还是。行。他这一大堆都是系统内置的啊，我们在最后再找到。Hep。到时我们。啊，自定义的。嗯，这里有一个后面有一还有一个参数。啊，可有可无的参数。这个应该就是过滤掉系统的这些层量。



![](img/32bf2e0564967235d25e07b5238ab36b_22.png)

![](img/32bf2e0564967235d25e07b5238ab36b_23.png)

我们来试试当等于Q的时候。

![](img/32bf2e0564967235d25e07b5238ab36b_25.png)

来，小心。好，这是分出来了目录，分出了用户的定义的，以及这些是扩展里面的。这样我们找的时候可以把它的返回值复制到一个数组里面，然后我们再输出user速度，就是我们输出自自定义的。



![](img/32bf2e0564967235d25e07b5238ab36b_27.png)

然后是或许。没定义的。函数。我们这里定义了一个ABC的函数。

![](img/32bf2e0564967235d25e07b5238ab36b_29.png)

然后再输出已定义的函数，我们还是看效果。Yeah。首先它是输出内置的一些函数。好，我们继续看到最下面。这是就是输出我们用户自定义的函数。



![](img/32bf2e0564967235d25e07b5238ab36b_31.png)

ABC。好，我们改一下看看TST。

![](img/32bf2e0564967235d25e07b5238ab36b_33.png)

我们再刷新。那就变成text。

![](img/32bf2e0564967235d25e07b5238ab36b_35.png)

あ。再看到最后包含文件。然，我们先包含一个文件，然后这里再输出我们所有已包含包含的文件。

![](img/32bf2e0564967235d25e07b5238ab36b_37.png)

转新。他这里是包含了文件，然同时他输出了这个包含的文件。好，他还先输出了自身。基本上嗯我需要讲的这些函数都讲完了啊，还有更多的函数等着我们去挖掘。本节课到此就结束了，谢谢大家的观看。



![](img/32bf2e0564967235d25e07b5238ab36b_39.png)