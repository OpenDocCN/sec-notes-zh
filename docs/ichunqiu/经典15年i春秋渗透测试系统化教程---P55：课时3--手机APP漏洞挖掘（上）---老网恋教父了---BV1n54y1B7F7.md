# 经典15年i春秋渗透测试系统化教程 - P55：课时3  手机APP漏洞挖掘（上） - 老网恋教父了 - BV1n54y1B7F7

Okay。好，大家好，今天我们这节课给大家讲解一下手机这个APP这个内动挖掘前面都是讲解了这个微博这一块。那么现在这个移动这个发展啊呃比较迅速。那么这个APP它的安全性也是比较弱的啊。

现在APP就是说几乎每一款APP软件都存在一定的漏动。而且那洞数量比较多。那么我们就是这节课就给大家就是认识带领大家就是说认识这个APP它的一些具体的一些安全性啊，怎么去做这个安全。

但是我们大概一两节课就是不可能把这个移动APP的安全全部讲解完。但是我会把这个流程啊，就是说根具啊怎么做啊，手工怎么做啊，去把这个过程给大家全部讲完，并且演示一部分啊，演示一部分啊。

其他的呢还是靠大家自己去做啊，或者今后会单独做一套这个移动APP的这个课程啊，给大家学习。呃，这个跟微博一样啊，有很多一些需要我们自己来手工操作的一些部分。好，我们来看一下本章内容。

就是我们这个安全检测的必要性啊，移动这个安全。第二部分就是购厂商的安检这个平台对比，就目前就是做这个移动这一块的啊，移动APP这一块的，大概有哪些厂商，大家大在心里面有数。

而且这些厂商这个大概的一个情况。第三部分就是APP的安全检测这个流程大概是什么样子？就是说一般。根据他是怎么样去做的。第四部分就是手工检测。好，我们来看一下第一部分。那么现啊就是我们当前的一个行业。

就是国内的这个移动APP的一个情况，就是在互联网发展过程中，PC。互联网。已经日意饱和。那么移动互联网却呈现这个井喷式的一个发展，就是说刚刚发展。突突飞猛进啊突飞猛进。就以前啊就是大家拉这个手机啊。

以前不是手机，不是智能的，就说原上网上比较少，现在智能手机的发展这个。大部分呢就是说。都用手机上网了啊，电脑上网也反而越来越少。这个手机。上地铁呀然上班的时候在路上都是用手机啊，在家里面在场上睡觉。

也是用着手机啊，看看网页，打打游戏。那么据这个工信部啊公布这个20112015年2月份就是通信这个通信业的这个经济运行情况。就要截止到2015年2月份呃，我国这个移动用户总数达到了12。9亿用户。

你像这个数量有多大，有几乎只要用手机的，会用手机，几乎都会拿这个手机上上网。那么这个google play和这个APP story这个数量已经接近这个300万个。

那么各行业都纷纷进入了这个移动互联网的浪潮中。然而，APP的开发比较简单，开发往后，产品的安全性、可用性、稳定性、兼容性，包括建造性等问题，给企业和这个给个人跟企业造成了一个很大的困难。一个完善的产品。

那么给这个后期推广使用，这个造成了很大的一个障碍。那么这个就是我们当前的一个现状啊，行业的一个现状。那接着我们来看一下这个厂商的一个检测一个平台对比。我们首先目前就是在国内来讲。呃，知名度比较高的。

一些厂餐。那有哪些厂商？那第一就是艾加密邦邦。童富蛋。腾讯员还有阿里阿里聚安全。那么大概有这么几家啊，当然还有360啊，有些我没列入进来哈。那么我们来看一下哈，它这个原单或者是产品。

还是直接是一个产品部署在本地啊，还是服务器上面，还是采用原的方式啊？I加密一般它是产品形式的，邦邦它也原装，也有产品的。那么它的检测功能，它一般是分为应用安全、源码安全、数据安全、动态调试等等。

它也可以检测病毒，家可识别都可以做。那么它的主要特点是。呃，他是首家提供IOS安卓捐加密的服务商，包括SO文件啊、H5啊、协议加密啊等其他厂商是没有的加密项目。主要以检测漏洞为主。他有一些案例。

大家可以看一下。那么帮邦他也爷他是。主要是做安全加固的。那么提供这个移动应用渗透测试服务啊，安全开发咨询等等等等等。所以说这个移动啊跟微博渗透测试也一样差不多。

也就是说也是有大量的团队公司一个公司来去做的呀，这个安全也渗透等等。所以大家接触到的基本上现在目前接触到的都是微博上置设试，没有听过这个移动APP上置设试是吧？就是APP现在也好多企业去在做这一块。好。

这些对比我就不一一给大家嗯说了哈，这个是我自己就是写出来的，自己写出来的一个当然写的也有通过他们的官网进行一个，就是他的介绍啊，功能对比啊，大概我就写了一下，不一定就是说。呃，首先我们我可以保证的是。

他这个地方就是说这些文字都来自他们官方啊，这一点是毫无疑问的，是没有没有错误的啊，除非他们官网自己写错了。我么他的一个你看这个通货带。它是分为什么应用层，网络程序层、数据程序层、服务器站。

通过这几块来进行一个它的功能是通过这几块的。那么它的主要特点大家可以过一下哈。我们大概就是说有这么几家，大家心里面有清楚就行了。那么关于这些。详细的一些情况啊，一些对比。

我们大大概就是说我把这个功能介绍啊也列了一下。我们来看一下A加V它的功能介绍。嗯，它主要分为六大块检测，它6种扫描被使坏，一个是组件。啊，组件有intelnet啊、微波微流啊等一些组件进行安全分析啊。

是否有漏洞，是否没有安全加固，它得扫描。他的产扫描产品啊都会检测出来，包括组件啊是否被监听啊、劫持啊，权限乱用啊。这是组件，还有它的安全性增强。就是检测是否这个权限滥用。

机密性就是反编译检测代码是否混淆去的啊。DEX是否。做加密保护，还有这个数据存取。啊，就是检测应用对这个敏感数据和加密过程中是否存在这个加密对动啊。全需这个数据全需。

就是说检测这个应用程序与呼务器通信是否有证书。现在。同时，检测应用程序与服务器通信的这个敏感数据是否存在加密漏动。就是他的调试信息。啊，就是说检测这个程序要是否具具备这个抵抗的这个动态调试能力。

那么大家就是说对于初学生来讲，大家只要了解一下，就是说。呃，I加密它是怎么划分的？就是说大概就是说通过5个方面啊，六个方面啊组建。安全增强程序的机密，数据程序、数据传序调试信息。每一家厂商都不一样哈。

就划分的层次不一样。他对这个内动扫描。那么我们来看一下这个帮邦，帮邦它是主要从四个上的四个方面来进行。那对这个APK啊，就是说移动APP的APK这个本身的这个安全进行一个检测过程。

他是只是从四个方面检测，一个是数据安全，第二个是这个程序安全、业务安全，系统环境安全。所以他们的这个方向不一样哈。但是他们的这个内容。差不多啊差不多检测的这个内容啊几乎相差不是很大。啊。

就像跟微博扫描器一样，你说安恒的绿蒙的呀，起名的呀等等。还有什么APPca，你说他们这个扫描的东西更量选项是否差不多都差不多，这个也是一样的，只是这个。就是换分的时候有一定的这个。区分啊不一样啊不一样。

但是里面的具体的详细信息啊相差不大。我们来看一下啊，那么同负蛋它是这么划分的啊，数据安全它这他同负蛋还是给这个。呃呃。帮妈。哦，还是有很大的区别，数据安全嗯差不多。

那么还有一个什么按这个网络层来进行划分这个网络全序层数据程序层是吧？服务器层。啊，缩计就是交互式的啊交互式的一个检测。呃，这个是它通复蛋的一个亮点。你像邦帮爱加蜜，目前还没有。

包括其他的厂商还没有服务器，服务器才检测。就是说。他这个APK放传到这个他的平台上进行运行检测的时候。主要检测它本身的安全，但是没有检测它的这个交互式的安全。那么服务器层就是交互式的安全。

移动APP无非就是两点，记住无非就是两点，哪两点，一个是APK自身安全。第二个就是他的交互是，就如说打开之后，它不是访问微博站点吗？啊，比如说在这一块，就是对微博这个站点，它这个注入啊。

叉SS啊这一块其实跟这个我们的这个什么。外博生透一块一样的。但是我们用电脑去打开哈。如果你电脑模拟手机去，就正常情况下去访问的话，如果你不用一些火糊里面啊clo的一些插件，伪绕一下。你是打不开这些。

APP上点的啊，这个是毫无疑问的。所以它这个是它这个产品啊，同时类这个产品啊，它多了一个这样的功能。啊，这样的话，他直接把这个。嗯，交互式的安全也做了啊，本身安全也检测了。但是经过我的测试啊。

对通负带的一些测试，它这几块功能，它就是说对APK的自身的安全检测，它比这个I加密要弱一些哈。邦邦呢也是一样，邦邦的这个检测的这个也是比这个I加蜜稍微啊这个检测。检测功能这一块就是。

同时对他的这个免费的产品进行检测的话。也是弱稍微露一点点，就是说大家可以拉同1个APK。嗯，上传，因为他们这些平台都提供了这个免费检测嘛，就是在网上他提提供了大家可以自己注册账号。

就是把你公司的APK上传到他们的平台进行检测。但是他们还是有一定的差距的，各有各的优点缺点在这里我不再做太多的一个评价太多的评价。啊，腾讯员流动扫描有这些。主要是什么病毒检测啊。啊。

防动塔跟踪检测原码检测DEX安全检测。包括这个盗版APP呀啊这个也是这个是它的一个亮点。呃，这个相当于属于什么监控这一块哈。这一块就是监控这一块，这个相当于这个就是。同一监控吧。

也也不是说针对这个漏洞的这一块啊，就是漏洞扫描，就主要是这几块。啊，比较糯。但是他多了一个这个。钓鱼这个监测啊监测。那这一块是腾讯源的一个亮点，当然其他的厂商也都有哈。什么包包啊、爱家面啊，他们也有啊。

但是它没有就是整合在一起啊，这个是单独购买的，你要花钱购买。那人家公司啊要监控这个互联网有没有钓鱼网站啊，有没有盗版的APP啊。那么这个你要单独花钱给他。他把你监控大会通知你。

它可以解决这个盗版的一些危险啊，就是你这个APP。APK被别人破解了，破解之后上传到其他的网站上面。那用户下载。那后但是上传到其他的网站上面之后呢，这个APK上放了一些广告里面又创过了一些资料。

放了一些木马。因为这个现在我说过百七八十的这个。移动这个。这一块都存在一一定的安全漏洞。所以说大部分人都可以被破解，360的360就被破解了。啊，这个邦邦的呀挨加V一点，现在我都看见都。

就是提供的加密技术啊，都被人搞，都破解了。所以说它这个安全性就是说你做了安全加固也是可以被破解。啊，也是可以被不科解。所以说这个。防不胜访啊，这个因为你这个APK它就是一个相当于一个软件一样。

你在它的官方站里下载下来之后。那些黑那些搞攻击的人下载下载之后，进行防编译，在里面植入一些木马后门程序，一些广告程序，在到其他的网上到处发布。那用户呢下载呢也不会去跑到官方去下载。

那有的时候在官网找都找不到。啊，有的有的网那官网都没有。啊，但是他其他的网上可以下载到。所以一下一下载，其实下载一个盗版的，这个盗版呢有很多木码在里面，但是用户是一使用的就上当了。啊。好。

我们接着看一下啊，这个是阿里居安全。他有也有六大块检测啊功能，就是恶意这个代码检测啊，一些零备啊。他这个7秒7毫秒扫描时间。呃在70毫秒之间呢也可以扫描啊，千万记这个样本库漏灯扫描有。

多样化的这个检测技术。北旺记的这个。内洞苦啊百分之百。以致这个内动覆盖啊，那这个基本上是假的啊，就是说任任何一款扫描器啊，就是外部扫描器也好这个。APP也好。啊你一定APP这一块也好，这些扫描器啊。

每一款就是说你百分之百。啊，一知的热洞可以覆盖，就是说检测有的漏洞就是说你这个热洞库里面有。那对方这个漏灯啊要有的需要是手工过造。但是也是这个漏洞，但是你就是检测不出来，就是胃部这一块也也是一样的哈。

所以说没有百分之百，所以你按我的扫描器百分之百没有误保率，一天都是吹牛的啊，都是假的。啊，应用加固。呃，这个大家也可以看就是阿里的这个巨安全应用加固，针对这个移动这个应用的安全包啊，直接可以进行加固。

无需开发者修改这个源源代码或者是S2次开发是一种这个它也是提供一个免费的哈。它是一种什么低成本的安全防护方案。他主要是通过什么加口加密。陆级混淆代码隐场。等等一些加固的方法。作用呢主要是为了防止这个。

反编译逆向分析，二次打包植入木马，主要是。防御这些。呃，这些技续其实这个相当于大家做过免杀的都非常清楚。就是我们一个软件。有一个木马大家做过秒杀就知道这个木马就是说我们脱完口之后，我们要对它做秒杀。

一般呢我们就是说对它加花，或者对这个部分代码进行加密。会做一些SES这个异常混淆反编译，包括对部分代码隐藏。最后我们再进行一个加可改合。啊，口也是可以改的哈。

可以加了加了之后我们再改加加口的作用呢主要是。减少这个软件。背这个什么？减消软件的一个体积，加口也加密口压缩口，它有很多口类型。所以说取了这个本来一个软件下载下来之后有5兆。

我压缩之后也许变成了一兆或者两兆。减少了这个体积。第二个呢，加壳之后呢，你要反变异的，你要必须要偷壳。因为这个壳啊把它包起来，就起到一个保护作用，就像一颗种子一样。它有个外壳就保护里面核心的东西。

那么这个也是一样的，加密的主要是就是说。房子调试。这房子被破解。他也有这个渠道监测哈，还有这个监控都有。一般的他这些产品都是原装的哈。他好像是单独不购买，比如说你我你说我要卖你这套产品卖过来，我自己用。

好像是。不买的。呃，这个腾圆园也是一样的，同富带也是一样。但是其他的厂商都愿意啊，就是说你有钱。给我10万块钱，我把这套产品卖给你。都可以买的。我自己用，当然他一般的他本身就是提供免费的。

就是检测这个内灯扫描啊，都是免费的。呃，等一下我会给大家演示一下。好，我们来看一下他的一个服务方式对比。包括他的这个最套。最大的这个特点对比。那么这些呢我们我在这里不再做太多的讲解。嗯。

大家还是自己看一下啊，服务对比。因为这个东西我还没有写完好。所以说嗯相当于一个产品的一个调研吧，就大家在学习过程中啊，今后大家会在企业也会用到。就说你企业需要卖产品的话，卖一个产品自己用的话。嗯。

上面上面上面都会告诉你啊，你给我先调研一下哪个产品好啊，一般的卖产品你不可能卖一个。功能比较小，没什没什么功量的产品吧，功能比较弱的产品吧，都是卖功能强大的嘛，卷贴性比较高嘛。雷东面比较强嘛。

那么你大概就是一个这样的方式啊，大家就说写一下。我么店我们介着看一下这个移动APP的这个安全的一个检测流程。那么一般情况下，就是说我们大家在网上。啊，在互联网上遇到的一种情况，就是说。

遇到的情况就是这个平台检测。我们首先打开用百度打开一下，随便找一个例如艾加密。啊，就这个吧。你打开了在官网嗯。官方网络打不开了吗？



![](img/c4ddc9a6b1a99e987e852baf36917c68_1.png)

我打来看下。他这里你看啊他这个是。

![](img/c4ddc9a6b1a99e987e852baf36917c68_3.png)

我看他这里要不要注车呀，应该是有。

![](img/c4ddc9a6b1a99e987e852baf36917c68_5.png)

![](img/c4ddc9a6b1a99e987e852baf36917c68_6.png)

![](img/c4ddc9a6b1a99e987e852baf36917c68_7.png)

![](img/c4ddc9a6b1a99e987e852baf36917c68_8.png)

他这个是免费的，你看他写了免费，还加密APP这动分析平台。他这里有什么文件检测，什么漏动扫描，后面检测一键生成。



![](img/c4ddc9a6b1a99e987e852baf36917c68_10.png)

你看这这些功能。那么在这里的地方。就选择你的APK。

![](img/c4ddc9a6b1a99e987e852baf36917c68_12.png)

我们随便找1个APK上传上去，他会马上检测哈。

![](img/c4ddc9a6b1a99e987e852baf36917c68_14.png)

检测做完之后注意。

![](img/c4ddc9a6b1a99e987e852baf36917c68_16.png)

嗯，太会申请一个报告。那么这个报告是个什么样的形式，是个这样的形式。所以说你你看他写的还是很详细的哈。嗯。那么通过你的手工进行修补那洞就行了。它这一部分代码也会载露出来啊载露出来。



![](img/c4ddc9a6b1a99e987e852baf36917c68_18.png)

在哪个地方有漏洞，他会告诉你跟微博扫描题一样，他这个报告还是挺正规的。

![](img/c4ddc9a6b1a99e987e852baf36917c68_20.png)

嗯。大家可以在这里可以看一下。

![](img/c4ddc9a6b1a99e987e852baf36917c68_22.png)

他这个检测。

![](img/c4ddc9a6b1a99e987e852baf36917c68_24.png)

嗯，你看啊。列线推送这个接入检测。他这里有说明。也说明也有漏洞解析在这里。你看哪些是安全，哪些是不安全，我们主要是看不安全的。在这个地方有生产报告。生产报告，那我们在这里点个生成呃。

当然你在这里注册一个用户名哈，就可以把这个报告下载下来。我这里已经下好了。

![](img/c4ddc9a6b1a99e987e852baf36917c68_26.png)

![](img/c4ddc9a6b1a99e987e852baf36917c68_27.png)

嗯。他这也单表偏到这个。在这里你看啊他这个。他会把部分代码，就说你这个它在这个它其实就是把这个APK上传上去了哈，上传上去的。



![](img/c4ddc9a6b1a99e987e852baf36917c68_29.png)

嗯，就是这种的形式。好，这个大家自己回去之看，回去之后自己去看啊，我在这里不再做太多的赘去。

![](img/c4ddc9a6b1a99e987e852baf36917c68_31.png)

这个我在这里列出来这么多这个。免费的这个产品就是网上在线免费怎么去检测APK。啊，都是给大家列出来了，就是说大家自己去看一下。



![](img/c4ddc9a6b1a99e987e852baf36917c68_33.png)

好，我们主要看一下这一部分。就是说这个平台就是我们刚才上传了一个。APK上去去一个检测，看到一个就是说这个检测是不需要收费的，就是一般的这个。现在针对移动这个内动内动扫描这一块啊，就是各类这个产品啊。

还是原装产品啊。那么这一块都是。一般情况是免费的，只是做安全这一块，手工涉及到手工检测。那么这一块是收费料，那些厂商是收费的。那么根据检测一般是免费的。但是根具咱完成百分7七八十的这个安全漏洞扫描检测。

而且这个移动APP这一块哈跟外博不一样，它这个平台扫描检测的误报率是极低极低的。经过我们就是内动验站这一块，能达到了97%98的几乎是没有误报的啊，这一点是毫无疑问的啊，经过多家厂商对比。

他这个东西因为它这个为什么没有这个误报呢。因为它这个检测不一样跟外博不一样。他上传上去之后，也就是说我们看一下他这个流程，你就知道了。就是说我们一般的上传APP啊，APK1样的嘛哈。

我就得我们一般的扩展名都是APK结尾的嘛。他有一个黑白名单，这个屁呗。黑白名单匹配。再接着来到这个，如果是的话，就反馈他这个黑白名单匹配是什么意思？也就是说哎有大家也许不明白啊，他其实很简单理解。

就说他这个我们上传的APK是否在这他本身就是有其他用户上传了没有，所以在这个平台已经有了呢？如果有了，那么他会告诉你。啊，我这个已经在这个平台已经有了，就是说你不需要再上传了，是这么回事的。

那么如果否的话，它的验战它开始就是验战这个应用是否加密。啊，是否加密？如果已经加密，那么它是会念在应用使用的这个加密层上。所以大家会发现哈大得大家回去之后，自己随便再管拿几个站点往上去下载几个APK啊。

上传到这个我刚才给大家介绍的这些站点去检测一下。大家会发现一个问题。就有些APK它是加密了或者加壳了啊，用的是什么嗯邦邦的加密，或者有的是用的360的。嗯，有的是阿里聚的。等等，或者说帮棒。

都有可能啊都有可能。所以说他这个。在这个地方，他就是说如果碰了已经加密了，它解密不了啊，就是说。他会告诉你啊，我这个APK。是360加密的。那么过厂生的一个安全数据分析接着来的啊，总结数据。

再接着到这个数学程储这里生产报告。更新黑白名单反馈给这个结果。直接给这个。用户因为这个一般的这个扫描上，它不针对这个已经加口加密的这个APK。进行一个内动扫描。一般情况下。

它如果要做的就是只是一个动态的，就加载到内存的时候进行一个漏动，大概一个检测啊大概一个检测。第2块是。就是说这个。黑白米单的一个匹配。这个如果是没有进行加密或者加考。

那么他开始进行个检测验证这个应用程序啊，如果没有加密的时候。他开始对应用程序进行一个静态分析啊，动态分析人工分析啊，一般人工分析一个是。在这一块是平台是没法做的哈，一般后面前面2块静态和动态方便。

那么对应用程序进行一个压缩，反编译区理。接着来自自里。二是打包呃，他那么到了这一块之后，那么。它涉及到这三三个方面的一个安全性，有应用安全性。那么应用有业务安全，组渐安全发布规范，应用管理。

这就是原模的一个安全性啊，程序的完整性啊，机密性啊，再是数据的一个安全性。有这么几来块啊，最后再来到这个数据程序，返回这个报告给这个用户大概是这样的过程。那么这里呢我在这里解释了一下。



![](img/c4ddc9a6b1a99e987e852baf36917c68_35.png)

大家可以看一下啊。这个大概六步啊六部我在这里大概的都写了一下啊，用文字描述了一下，大家可以去看一下。

![](img/c4ddc9a6b1a99e987e852baf36917c68_37.png)

啊。那么我在这里就大概就先把这一部分教程暂停一下。接着我们来到这个等一下会讲一下第二部分，就APP手工检测的这个分类啊，就是自身安全跟这个交互式的运行。

