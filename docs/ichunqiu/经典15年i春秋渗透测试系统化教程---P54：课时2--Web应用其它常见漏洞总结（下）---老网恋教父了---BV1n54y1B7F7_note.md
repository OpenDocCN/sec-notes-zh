# 经典15年i春秋渗透测试系统化教程 - P54：课时2 Web应用其它常见漏洞总结（下） 🔍

在本节课中，我们将继续学习Web应用中其他几种常见的漏洞类型。这些漏洞虽然可能不像SQL注入或XSS那样广为人知，但在实际的渗透测试中同样频繁出现，了解它们对于构建完整的Web安全知识体系至关重要。

## IIS短文件名泄露漏洞 📂

![](img/afb4c9acf64c6f4ef691b773f5ef5c61_1.png)

![](img/afb4c9acf64c6f4ef691b773f5ef5c61_2.png)

上一节我们介绍了多种Web漏洞，本节中我们来看看IIS短文件名泄露漏洞。该漏洞主要存在于微软IIS服务器（特别是早期版本，如IIS 6.0）中，由于服务器在处理文件请求时存在缺陷，攻击者可以利用特定的字符模式来枚举服务器上的部分文件名。

![](img/afb4c9acf64c6f4ef691b773f5ef5c61_4.png)

**危害**：攻击者可以利用此漏洞探测或遍历服务器上的文件名，或对使用.NET框架的IIS服务器发起拒绝服务攻击。其主要价值在于辅助发现网站后台等敏感文件。

![](img/afb4c9acf64c6f4ef691b773f5ef5c61_6.png)

![](img/afb4c9acf64c6f4ef691b773f5ef5c61_7.png)

![](img/afb4c9acf64c6f4ef691b773f5ef5c61_8.png)

**验证过程**：
以下是验证该漏洞存在的基本思路：

![](img/afb4c9acf64c6f4ef691b773f5ef5c61_9.png)

![](img/afb4c9acf64c6f4ef691b773f5ef5c61_10.png)

1.  使用扫描工具（如Burp Suite）或手动构造特定格式的URL进行探测。
2.  例如，尝试访问类似 `http://target.com/*~1*/.aspx` 的路径。
3.  如果服务器返回错误信息（如404）与正常访问不存在的文件时不同，则可能表明短文件名枚举是可能的。
4.  通过自动化脚本可以更高效地尝试常见后台文件（如`admin~1`）的短文件名形式。

![](img/afb4c9acf64c6f4ef691b773f5ef5c61_12.png)

**核心概念**：该漏洞的利用依赖于IIS对DOS 8.3格式短文件名的支持。构造的探测请求模式通常为：`http://目标URL/*~1*/.aspx`。

![](img/afb4c9acf64c6f4ef691b773f5ef5c61_14.png)

> **注意**：此漏洞利用价值有限，通常作为信息收集的辅助手段，报告中常被定为中低危。

## JQuery库低版本XSS漏洞 🧩

接下来，我们关注一个由第三方库引发的安全问题——JQuery库低版本XSS漏洞。当网站使用的JQuery版本低于1.7时，其用于过滤用户输入的正则表达式存在缺陷，可能导致跨站脚本攻击。

**危害**：攻击者可以构造恶意输入，绕过JQuery的过滤机制，在页面上执行任意JavaScript代码，从而盗取用户Cookie、进行钓鱼等。

**验证与报告**：
验证此漏洞相对直接：

1.  查看网页源码，找到引用的JQuery库文件（通常是`.js`文件）。
2.  检查该文件的版本号。如果版本号低于1.7（例如1.6.x），则存在风险。
3.  在渗透测试报告中，可以直接根据版本信息进行说明。

**核心概念**：漏洞根源于JQuery `$.html()`、`$.append()`等方法在旧版本中未能正确过滤特定HTML标签和属性。

## 目录浏览漏洞 👀

目录浏览漏洞是由于Web服务器（如Apache、IIS、Nginx）配置不当，未禁用目录列表功能所导致。

**危害**：攻击者可以直接访问网站的目录路径，服务器会以列表形式返回该目录下的所有文件和子目录。这可能导致敏感文件（如备份文件、配置文件、源代码）被直接下载。

**验证方法**：
验证方法非常简单：

1.  在浏览器中访问疑似存在漏洞的目录，例如：`http://target.com/images/` 或 `http://target.com/js/`。
2.  如果页面显示了该目录下的文件列表，而非预期的网页或403错误，则存在目录浏览漏洞。

> **注意**：此漏洞通常被定为中危，但若泄露了数据库配置文件或源码，其危害等级会显著升高。

## URL跳转与框架钓鱼漏洞 🎣

URL跳转和框架钓鱼漏洞都可能导致用户被导向恶意网站，是网络钓鱼攻击的常用手段。

**URL跳转漏洞**：网站应用程序对用户传入的跳转URL参数（如`redirect`、`url`、`to`）未做严格校验和限制。

*   **危害**：攻击者可以构造恶意链接，例如 `http://trusted-site.com/redirect.php?url=http://evil-phishing-site.com`。用户点击后，浏览器会从可信站点跳转到攻击者控制的钓鱼网站。
*   **利用方式**：攻击者常对恶意URL进行编码（如URL编码、双URL编码）以增加迷惑性。

**框架钓鱼漏洞**：网站未对用户输入进行有效过滤，允许攻击者注入`<iframe>`标签。

*   **危害**：攻击者可以在正常网页中嵌入一个不可见或伪装过的`<iframe>`，其`src`指向钓鱼页面。用户可能在不知不觉中在嵌入的框架内输入敏感信息。
*   **核心概念**：注入的恶意代码形如：`<iframe src="http://evil-phishing-site.com" width="0" height="0" style="border:none;"></iframe>`。

## 未加密登录请求 🔓

许多Web应用在用户登录时，以明文形式传输用户名和密码。

**危害**：攻击者若通过网络嗅探（如ARP欺骗）、中间人攻击等手段截获登录请求数据包，可以直接获取用户的明文凭证。

**验证方法**：
1.  使用代理工具（如Burp Suite、Fiddler）拦截登录过程的HTTP请求。
2.  查看`POST`数据中的密码字段（通常是`password`、`pwd`等）。如果其值为明文，则存在此漏洞。

**防护建议**：登录请求应始终使用HTTPS协议，或至少对密码进行前端加密后再传输。

## 链接注入漏洞 ⛓️

链接注入漏洞与框架钓鱼类似，允许攻击者在页面中插入可点击的恶意链接。

**危害**：攻击者可将恶意链接的文本伪装成“提交”、“登录”、“详情”等可信按钮或链接，诱使用户点击后跳转到钓鱼页面。

**核心概念**：例如，在用户可控的输入点（如评论、个人信息）插入：`<a href="http://evil-site.com">点击领取奖品</a>`。页面渲染后，会出现一个指向恶意网站的链接。

## HTTP报头追踪漏洞 📨

![](img/afb4c9acf64c6f4ef691b773f5ef5c61_16.png)

HTTP报头追踪漏洞涉及`TRACE`或`TRACK`等HTTP方法。

**危害**：如果服务器启用了`TRACE`方法，攻击者可以构造恶意请求，利用客户端脚本（如JavaScript）通过`TRACE`请求来获取敏感的HTTP报头信息，例如Cookie。

**验证与防护**：使用工具发送`TRACE`请求到目标服务器，如果返回了完整的请求信息，则存在此漏洞。服务器应禁用不必要的HTTP方法。

## DNS区域传输漏洞 🌐

DNS区域传输漏洞发生在DNS服务器配置不当，允许任意客户端进行区域传输操作。

![](img/afb4c9acf64c6f4ef691b773f5ef5c61_18.png)

**危害**：攻击者可以获取目标域名下的所有子域名记录。这有助于攻击者发现隐藏的、安全性较弱的子站点（如`test.example.com`， `admin.example.com`），从而扩大攻击面。

**验证方法**：
可以使用`nslookup`或`dig`命令进行测试：
```bash
nslookup
> server <目标DNS服务器IP>
> set type=any
> ls -d <目标域名>
```
如果命令返回了大量的域名记录，则可能存在漏洞。

## 信息泄露漏洞 🗂️

信息泄露是一个宽泛的类别，指网站意外地向用户暴露了敏感信息。

**常见泄露点包括**：
*   **错误信息**：详细的异常堆栈跟踪，可能包含服务器路径、数据库语句、代码片段。
*   **注释信息**：开发者留在HTML、JS源码中的注释，可能包含后台地址、测试账号。
*   **备份文件**：`.bak`， `.swp`， `.git`目录等。
*   **配置文件**：直接通过浏览器访问到了`config.php`， `web.config`等文件。
*   **重装页面**：网站安装程序`install.php`在安装后未被删除。

**危害**：泄露的信息可能直接包含凭证，或为其他攻击（如SQL注入、文件包含）提供关键路径和参数。

## 任意文件下载漏洞 ⬇️

任意文件下载漏洞是指Web应用程序对用户请求的文件路径参数未做限制，允许用户通过目录遍历符号下载服务器上的任意文件。

**危害**：攻击者可以下载系统敏感文件，如：
*   `/etc/passwd`（Linux用户信息）
*   `C:\windows\system32\drivers\etc\hosts`
*   网站配置文件（`config.inc.php`， `web.config`）
*   数据库备份文件（`.sql`， `.mdb`）

**利用方式**：通常通过修改`filename`、`file`、`path`等参数实现。
例如：`http://target.com/download.php?filename=../../../../etc/passwd`

**核心概念**：利用路径遍历符号`../`（Linux/Unix）或`..\`（Windows）来向上跳转目录。

![](img/afb4c9acf64c6f4ef691b773f5ef5c61_20.png)

---

![](img/afb4c9acf64c6f4ef691b773f5ef5c61_22.png)

本节课中我们一起学习了Web应用中多种其他常见漏洞，包括IIS短文件名泄露、低版本库漏洞、目录浏览、各类钓鱼跳转漏洞、信息泄露以及文件下载漏洞等。这些漏洞虽然原理和危害各不相同，但都强调了安全开发中**输入验证**、**输出编码**、**最小权限原则**和**错误处理**的重要性。在渗透测试中，善于发现并组合利用这些“小”漏洞，往往能打开获取系统权限的突破口。