# i春秋学院 进阶篇 PHP代码审计 - P10：课程：登录密码爆破 - 老网恋教父了 - BV1D7411S7vf

我s啊，这节课给大家带来的是登录密码爆破。啊，本节课内容就是登录密码爆破的问题。啊，登录密码爆破啊，属于撞库一类啊，通过弱口令字典啊去暴力破解。啊，尝试登录已达到拆解用户密码的。一种方式。那么一般。

管理员登录都需要验证码。来突破验证码的方式主要有两种，一种是绕过验证码。另外就一种就是自动识识别那个验证码啊，识别的还有一种是人工打码的方式。啊，今天我们要讲的就是绕过验证码。

绕过验证码的方式呢啊就是因为它的session不更新。或者是啊逻辑上有缺陷。让我们绕过它。

![](img/bbade17e6f6b96877a1833a37491c78e_1.png)

那我们们来看代码。啊，因为我们基本上啊user该看的都看了。普通文件该看的也都。审绩过了。似乎已经没有什么漏洞了。啊，进入后台呢。哦，没有权限进去。那我们就尝试一下爆破进去。Yeah。

这是没有办法中的办法。

![](img/bbade17e6f6b96877a1833a37491c78e_3.png)

我们看网页啊，管理员登录还需要获取一个啊需要填写验证码。那么验证码从哪里来呢？

![](img/bbade17e6f6b96877a1833a37491c78e_5.png)

我们来访问一下这个验证码。啊，他是cach这个PHP。

![](img/bbade17e6f6b96877a1833a37491c78e_7.png)

从这里来的。

![](img/bbade17e6f6b96877a1833a37491c78e_9.png)

我们回到代码去找到这个capture。啊，这里就是啊开启了一个session。然后随机生成了一串字符串啊，4个。然后把这个日付串复制到session里面。然后就是添加一些扰乱码。扰乱的什么东西。

然后是输出。啊，他是这样输出的一个。呃，验证码。而他的。嗯，验证码的内容啊是在这个文件里面复制到section的。好，我们来再来看啊他的登录的地检测的地方。啊，首先他是判断你是否传输了这三个pos。啊。

存在的话。然就开始去判断验证码。啊，验证码和session的验证码不同，它就回到这个。标进这个页面哎，如果匹配的话呢，他就继续往下去走。然后是。登录成功。他就跳转到manage这个页面。啊。

不成功也就回到这个loging这个页面。嗯。啊，那么这里。看我们并没有看到。有验证码的要求，他只是在这里需要一个session。诶session capture这里。那我们是不是可以想象到。啊，不访问。

那个capture啊，它就不生成验证码。啊，不生成的话，那这里的在线capture。啊，他就。是等于空的。嗯。他是空的，什么都没有。他们。post时候啊也不输入，让它也等于空。这样空等于空匹配了。

那他就继续执行了啊，这样就可以绕过去了。那我们来试一下是否这样。然后我们这里。啊，加一个输出信息。啊，就是嘎吃挨饿。就这样。



![](img/bbade17e6f6b96877a1833a37491c78e_11.png)

我们来测试一下。那我们要在登录这个页面抓一个包。然后。随便说。ABC。AB。好，你就在这里。我们把它放到重放。嗯。那么我们这里是有一个嗯筛选筛选IB的。啊，这是表示他已经有了session的一些信息。

那我们把这句删掉的话。那就是没有消息信息了。没有筛选信息，它就会重新生成，重新生成就是空的。然后我们这里把capture这里删掉。他们就不传送这个信息。这样子。我们来测试一下。嗯。

我们再把代码再稍稍微改一改。

![](img/bbade17e6f6b96877a1833a37491c78e_13.png)

Flf。抽出一个。啊，正确的。

![](img/bbade17e6f6b96877a1833a37491c78e_15.png)

Succeed。Yeah。我们来访问一下。他缺 a。啊，成功通过了。这样我们就。照过了这个验证码。

![](img/bbade17e6f6b96877a1833a37491c78e_17.png)

好，接下来我们就可以开始爆破了。😊。

![](img/bbade17e6f6b96877a1833a37491c78e_19.png)

啊，包括的话呢，我们就用pro。嗯，所以它有一个包破的工具。我把它用按 country。加上I。把它放到。啊，这个包破的地方。啊，我们清理一下我们要包括的密码。我们就这里添加。嗯。然后我。

添啊添加了一个测试账户。Yeah。对呀adminadminister。这样这个账户我们来包括他的密码。然后他配load。可lo我们这里添加一个自带的啊热口令字典。有3424个绕口令。我们再到。嗯。

选项这边配置一下。啊，开启多线程，我们要开启100个线程吧。嗯，其他的一些配置呢可以自行去研究，我们就开始攻击。这样就包括。那么包括需要花费一定的时间啊，我这里就暂停一下。现在啊就包括结束了。啊。

因为这种包括是根据它返回长度啊进行判断是否成功的。那我们现在在长度这里啊，我们。按啊修改它的排序方式，双击啊，这样我们可以看到。它长度不同，一个是啊2032，一个是两呃2031啊。这个与众不同。啊。

也就是说。他密码可能就是这个。啊，我们现在还不能啊判断，我们再看它的返回。啊location到manager。哎，这应该嗯应该是成功了的。啊，他密码啊正确，所以说会跳转到manage页面。Yeah。啊。

这个差别很细微啊，差一点就不能够判断了啊，主要的原因就是。啊，它的返回的值基本上是一样，就是location不同啊，manage和logging啊这两个它啊相差了一个字符啊，如果它相同的话啊。

这种包破的方式啊，似乎也就是不可能了。那么现在我们包括的结果是啊password。好，我们现在去验证一下。这里先解除代理。然后。我们重新打开这个页面。How administration。

A administrator。然后密码是classword。R eat。登录。啊，正确登录。也就是我们包括成功了。这样的一种方式需要依靠的是啊管理员的绕口令。啊，如果啊管理员机智一点。哎。

密码强度大一点就爆破不可能爆破成功了。

![](img/bbade17e6f6b96877a1833a37491c78e_21.png)

好，现在我们再来回到代码，我们要怎么修复？首先我们可以啊在它的判断加一个。啊，就是判断他capture有没有啊传送过来。我加一个 capture。诶。然后也可以在这里。加一个。呃，加一个什么呢？

Yeah。在这里加一个判断啊，这个session是不为空。嗯session capture不为空。Yeah。啊，这里也可以判断它的长度。啊，它验证码不是4位吗？啊，取下它的长度不等于4啊。

基本上就也是错的。

![](img/bbade17e6f6b96877a1833a37491c78e_23.png)

好，我们现在再来看。这里我们就不不报过来来试一下能不能绕过。

![](img/bbade17e6f6b96877a1833a37491c78e_25.png)

嗯。Yeah。

![](img/bbade17e6f6b96877a1833a37491c78e_27.png)

Yeah。Yeah。

![](img/bbade17e6f6b96877a1833a37491c78e_29.png)

啊，明显出现了错误。啊，没有传输这个信息，他就跳到了输出404信息。

![](img/bbade17e6f6b96877a1833a37491c78e_31.png)

嗯。

![](img/bbade17e6f6b96877a1833a37491c78e_33.png)

所以说这样基本上就杜绝了啊验证码绕过。

![](img/bbade17e6f6b96877a1833a37491c78e_35.png)

好，我们再回到总结一下。Yeah。我们是。一般正常情况下去登录。然，他会请求一个呃t页面，然后返回的是验证码，需要我们填写。好，我们。直接去访问这个cheick页面的话。然后他就。啊。

将那个pos过来的capture和sction里面的capture进行比较。啊，正确就继续执行，不正确就结束。啊，我们直接访问的话啊，让他不让它生成。他就啊两个都等于空，也是正确。这样的绕过。

那么这节课就到这里结束了，感谢大家的观看。😊。

![](img/bbade17e6f6b96877a1833a37491c78e_37.png)