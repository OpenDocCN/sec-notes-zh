![](img/8e501e750fff3551fd15f9e6a9bf179e_1.png)

# 经典15年i春秋渗透测试系统化教程 - P57：课时5 企业渗透测试方案讲解（上） 📋

在本节课中，我们将要学习如何撰写一份专业的企业渗透测试方案。这是渗透测试工程师必须掌握的核心技能，其最终目的是将测试发现的问题、结果和建议，以结构化的报告形式交付给客户企业。

![](img/8e501e750fff3551fd15f9e6a9bf179e_3.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_4.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_5.png)

一份完整的渗透测试方案通常包含四个主要部分：**任务简介**、**测试综述**、**测试结果**和**整改建议**。虽然不同企业的报告模板在细节上略有差异，但整体框架基本一致。接下来，我们将通过分析真实的企业方案模板，逐一讲解每个部分的构成与撰写要点。

![](img/8e501e750fff3551fd15f9e6a9bf179e_7.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_9.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_10.png)

## 第一部分：任务简介 📝

任务简介部分旨在清晰界定测试的基本信息，主要包括以下四个要素：

![](img/8e501e750fff3551fd15f9e6a9bf179e_12.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_13.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_15.png)

以下是任务简介包含的四个核心部分：

![](img/8e501e750fff3551fd15f9e6a9bf179e_17.png)

1.  **测试对象**：明确列出本次渗透测试的目标，例如官方网站、邮件系统、后台管理系统等。需要详细记录每个目标的网站名称、网页地址（URL）和对应的IP地址。**必须严格在授权范围内进行测试，不得测试未明确授权的目标。**
2.  **测试时间**：标明渗透测试的起始时间和结束时间。这有助于客户了解测试周期，并且服务器日志也会记录相关活动时间，保持一致性很重要。
3.  **测试人员**：列出项目负责人及测试组成员的姓名、联系方式和工作职责（如沟通协调、远程渗透、文档编写等）。这便于客户在后续有疑问时能够联系到对应人员。
4.  **测试地点**：说明测试进行的地点，例如“北京XX安全研究中心”。这明确了测试活动的物理或逻辑发起位置。

## 第二部分：测试综述 🔍

上一节我们介绍了方案的基本信息，本节中我们来看看如何描述测试的整体过程和方法，即测试综述。

测试综述部分需要向客户说明测试的环境、流程和采用的技术手段。

### 网络环境

需要说明本次渗透测试采用的方式（如远程测试），并模拟来自互联网的黑客攻击环境。例如，可以描述为：“测试人员通过拨号接入互联网，并可能使用代理服务器对目标系统进行访问。” 这有助于客户在日志中识别出授权的测试IP，避免与真实攻击混淆。

![](img/8e501e750fff3551fd15f9e6a9bf179e_19.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_21.png)

### 流程与内容

以下是本次渗透测试的主要流程概述：

1.  **任务目标与信息收集**：这是所有测试的基础。如果此阶段未发现问题，则直接进入报告输出阶段。
2.  **普通检测**：基于信息收集的结果，进行常规漏洞检测。
3.  **深度检测（如授权）**：在发现漏洞后，尝试提升权限、进行内网横向移动等更深层次的测试。
4.  **痕迹清除**：测试结束后，清除在测试过程中留下的任何后门、脚本或日志文件，防止被其他攻击者利用。
5.  **检测结束与报告输出**：整理所有发现，形成最终的渗透测试报告。

整个流程可以概括为：**信息收集 -> 漏洞检测 -> (深度利用) -> 清除痕迹 -> 输出报告**。

### 测试层面详解

渗透测试主要从三个层面展开，以下是每个层面的测试重点：

*   **网络层**：探测网络设备（如路由器、防火墙）、通信协议及网络接口的漏洞。例如，检查设备是否存在默认口令、未修复的路由协议漏洞或不当的网络隔离策略。
*   **主机层**：探测目标主机的开放端口、运行的服务、操作系统及软件版本信息。通常使用漏洞扫描器（如Nessus, 绿盟极光, 启明天镜）进行自动化扫描。
*   **应用层**：这是渗透测试投入时间最多的层面。包括Web服务器指纹识别、网站后台查找、目录遍历、源代码分析、DNS信息探测等。例如，即使更改了远程桌面服务的默认端口（3389），通过指纹识别仍可能被发现。

### 渗透测试具体内容

![](img/8e501e750fff3551fd15f9e6a9bf179e_23.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_25.png)

基于第一阶段的信息收集，测试人员会从多个方面开展渗透测试。以下是常见的七个测试方向：

![](img/8e501e750fff3551fd15f9e6a9bf179e_27.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_28.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_29.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_31.png)

1.  **网络脆弱性**：包括ARP欺骗、DDoS攻击测试等。**注意**：此类测试对业务影响较大，必须获得客户的书面明确授权方可进行。
2.  **数据有效性**：涵盖最常见的Web漏洞，如SQL注入、跨站脚本（XSS）、文件上传、代码注入、缓冲区溢出等。
3.  **认证与会话**：测试身份验证机制，包括密码绕过、密码找回逻辑漏洞、越权访问、文件包含、暴力破解、会话管理不当（如注销功能、会话固定）等。
4.  **已知漏洞**：检测操作系统（Windows/Linux）、通用软件（如Struts2, ThinkPHP）的已知公开漏洞。
5.  **系统配置**：检查服务器、应用程序的配置错误，如目录索引开启、SSL/TLS密钥强度弱、不安全的HTTP方法等。
6.  **人为因素**：测试是否存在恶意代码、钓鱼链接等。
7.  **业务逻辑**：针对网站特定的业务流程进行测试，寻找逻辑缺陷。

![](img/8e501e750fff3551fd15f9e6a9bf179e_32.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_34.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_35.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_37.png)

### 测试深度与痕迹清除

![](img/8e501e750fff3551fd15f9e6a9bf179e_39.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_40.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_42.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_43.png)

*   **测试深度**：普通检测通常以发现漏洞为止。深度检测则会在获取权限（如Webshell）后，尝试提权并进一步渗透内网，这需要客户的特别授权。
*   **痕迹清除**：**至关重要**。测试完成后，必须清除所有上传的后门、测试脚本和可能暴露漏洞的日志，避免给客户系统留下安全隐患。

![](img/8e501e750fff3551fd15f9e6a9bf179e_45.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_47.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_48.png)

## 第三部分：测试结果 📊

![](img/8e501e750fff3551fd15f9e6a9bf179e_50.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_51.png)

在完成了测试流程和方法综述后，我们需要将具体的发现整理成文，这就是测试结果部分。这部分需要清晰、直观地展示每一个发现的安全问题。

![](img/8e501e750fff3551fd15f9e6a9bf179e_53.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_54.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_56.png)

测试结果的撰写通常针对每个目标系统单独列出。对于每一个发现的漏洞，应包含以下要素：

![](img/8e501e750fff3551fd15f9e6a9bf179e_58.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_60.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_62.png)

1.  **漏洞名称**：例如，“跨站脚本攻击（XSS）”。
2.  **漏洞描述**：简要说明漏洞成因。例如：“由于未对用户输入进行有效过滤，攻击者可插入恶意脚本代码。”
3.  **漏洞地址**：提供存在漏洞的URL。可以直接将包含攻击代码的POC（Proof of Concept）链接列出，也可以先列出原始地址，再备注构造攻击的方法。
    *   示例（带POC）：`http://target.com/search.php?keyword=<script>alert(1)</script>`
    *   示例（备注型）：`http://target.com/search.php?keyword=test` （参数`keyword`存在XSS，可构造`<script>alert(1)</script>`进行测试）
4.  **漏洞证明**：**必须附上截图**。一张清晰的漏洞复现截图（如弹窗、目录列表）是最直接的证据。
5.  **其他存在点**：如果同一漏洞在系统内多处存在，应一并列出。
6.  **漏洞危害**：阐述该漏洞可能造成的具体影响，例如盗取用户Cookie、篡改网页内容、获取敏感信息等。

![](img/8e501e750fff3551fd15f9e6a9bf179e_64.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_66.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_67.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_69.png)

**高效撰写技巧**：可以将常见漏洞（如XSS, SQL注入, 信息泄露）的描述、危害和修复建议预先整理在一个文档中。撰写报告时直接复制粘贴，再填入具体的漏洞地址和截图，可以极大提升效率。

![](img/8e501e750fff3551fd15f9e6a9bf179e_71.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_72.png)

## 第四部分：整改建议 🛠️

![](img/8e501e750fff3551fd15f9e6a9bf179e_74.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_76.png)

本节课的最后一部分，我们将学习如何根据测试结果提出有效的整改建议。这部分旨在为客户提供明确的修复方向，是方案的价值所在。

![](img/8e501e750fff3551fd15f9e6a9bf179e_77.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_79.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_80.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_82.png)

整改建议应针对第三部分列出的每一个漏洞或每一类问题，给出具体的修复方案。

![](img/8e501e750fff3551fd15f9e6a9bf179e_84.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_86.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_88.png)

以下是撰写整改建议的通用结构：

![](img/8e501e750fff3551fd15f9e6a9bf179e_90.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_92.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_94.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_96.png)

1.  **关联系统**：明确指出存在该问题的具体系统（如`www.example.com`官网）。
2.  **漏洞名称**：重复漏洞名称（如跨站脚本攻击）。
3.  **可能危害**：简要重申该漏洞的危害。
4.  **解决/修复建议**：提供具体、可操作的技术建议。
    *   **例如对于XSS**：建议对用户输入进行过滤或转义，过滤或转义的关键字符包括：`<`, `>`, `”`, `’`, `&` 以及 `javascript`, `vbscript` 等脚本关键字。
    *   **例如对于目录遍历**：建议参考微软官方方案修复IIS配置，或部署Web应用防火墙（WAF）拦截包含`../`等特殊字符的请求。
    *   **例如对于敏感信息明文传输**：建议采用HTTPS协议对通信进行加密。

![](img/8e501e750fff3551fd15f9e6a9bf179e_98.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_100.png)

## 附件与总结 📎

![](img/8e501e750fff3551fd15f9e6a9bf179e_102.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_103.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_104.png)

一份专业的方案通常还包含附件，例如**威胁分类表**，将发现的所有漏洞按照风险类型（如恶意攻击、认证不充分、信息泄露等）和风险等级（高、中、低）进行归类，并说明等级划分依据，使报告更加体系化。

![](img/8e501e750fff3551fd15f9e6a9bf179e_105.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_106.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_107.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_109.png)

![](img/8e501e750fff3551fd15f9e6a9bf179e_110.png)

**本节课中我们一起学习了**：一份标准企业渗透测试方案的核心结构，包括任务简介、测试综述、测试结果和整改建议四大部分。我们详细探讨了每个部分的撰写要点、必备元素以及高效完成的技巧。掌握这套方法论，是成为一名合格渗透测试工程师的关键一步。在后续课程中，我们将继续深入讲解方案的其他细节和实战案例。