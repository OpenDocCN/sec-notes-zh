# i春秋零基础入门Android逆向 - P34：课时9 Android dvm 脱2 - 老网恋教父了 - BV1sg4y1B7zB

🎼。大家好，我是讲师艾巴。那么今天的话就来讲一个DVN脱壳的第二课。这节课的话将会以现在目前来说比较新的一个呃课来进行一个演示，来看一下我们如何去对个壳来进行一个分析来进行一个脱壳。



![](img/af56b23c185d36a4a6a0055ca288591f_1.png)

嗯，这一节课的目标目标文件的话是这1个APP文件，前面就已经出现过了，这是一个360加固保所加固保护的一个课。那么是比早几个月前的一个版本。那么就算现在有变化的话，哎，总体来说变化有不大。

如果即使就算是有变化的话，那么大家来跟着啊里面的一些分析的话，我相信也是能够把它的一个东西给搞出来的。那么首先我们来完成这一个交层的一个分析。

我们来看一下整一个东西整一个课它是怎么样去完成一个文件的一个保护的。我们打开它，那么要分析可况，先来看它入口点。这时候我们应该先来找这一个安roid many文件。

第一步先查它的一个application的一个入口。我们来看一下，找到一个application的一个标签。

这是它的入口点接着往右找来找到这样一个安卓那后这么看一下安卓就是它的一个plication的一个入口点可以发现这是一个C然后奇虎要 applicationplication。

就证我明了这是一个360加固法所加固保护的一个东西。然后它的版本的话这时不知道我们那么我们就已经知道这次通过这一个加固，然后它的一个外壳是在这个这个地方。

然后在GEB中咋入这个地这个plication来进行分析。直接进行一个反应例。那么在下面的下面一块，我们就要注意了去查找一下它到底是加载哪1个SO，然后来进行一个分析的。那么大致来看一下的话。

首先这里第一步第一个函数我经说过了，每个plication的第一个函数肯定是这样一个attach base。对于每一个加固的一个可核都是这样的。好，那么在这里它会首先判断我们机器的一个版本。

是一个64位的，还是一个S86位的。那么下面的话还会有一个AAIM的判断，还是一个ART的还是一个DVM的一个东西，啊这些都判断出来以后的话，就可以从相应的资源目录中给拷贝我们这里就是拷贝了。

给拷贝上相应的一个SO文件。那么在这里由于我是运行在一个DVM模式下的哎，并且是一个超86的，那么那么这是一个M哎，那么它就可以释放这个这个SO文件。假如是ART模式下话。

那么就可以直接加载这样一个文件的。好，那么在这里我们就来分析这样一个SO文件。那么这个SO。这块它是对个思审段有处理过的。那么在这里呃前几节课中的话就已经演示过了，怎么去对它进行一个修复。

那么在这里的话，就直接使用前几节课的一个。内容直接打开修录完以后的1个SO文件。那么可以看到的话大概是这种形式的，大概是这么么一种形式的。好，那么这里看完以后呢。这是第一步。第一步。内部的话就是查看。

今か？这是第一步查看obplicationation用好以后，查找那个SO文件。然后找到它对应的1个SO来进行一个修复分析。这是第一步。然后第二步的话就是一个。查找太搜的。超载体的函数。

我们要知道整一个。整个SO文件，它里面到底存储了哪一些netick函数来让我们的一个交层来调用来进行一个接口。我们要查找也是很简单的，直接在我们的一个application中在这里搜索。那。

那么这里就能够把当前的一个net层的函数都记录下来。我们把这些东西做一个记录。那么后边的话或多或少也是有可能会得大的。好，那么在这这里的话，就只有这么两行数据是一个letage层的一个位置上了。把。

把这些东西都搞搞好以后呢，我们就开始尝试追加一个SO来完成一个静态分析。啊，第一步可以尝试去找一下这些呃read层上的函数，来找一下它是不是在用于对class load来进行1个DS的解码的。

我们可以尝试去这么做一下。那而大家的话这里的话就不是这块并不是。好，我们来开始分析吧。呃对于这样一个文件的话，我们来找它的一个入口点。嗯，每一个用口点的话都是一个。好，我们刚才出了出了一点意外。

那么这里我们我们就找到我们修复过的1个SO文件来开始进行一个分析。那么在这里分析的话，最主要是查看它到底有没有一个。啊，解解可的一个函数其实就是它的1个INID函数。还有说有没有哎其他的一些函数。

我在这里找一下的话，它这里发现了一个比较特别的区段，是1个UP叉点击区段。那这个区段的话是比较重要的。因为因为证明了这个函数。这个SO的话，里面是使用了它的1个UP叉压缩的相关数据的。

实际上这个SO文件，并下运行的时候释放相当有一定量的一个程序一个函数来完成一个解可的一个操作的。那么在这里先点击一下。那么下面的它这些时候可能会有回到。好。

我们来查看它的一个入口点来看一下它有没有解可相关的一个函数。啊，希望大家还记得我们要怎么分析S和文件，好好起我们的一个vitEF工具。



![](img/af56b23c185d36a4a6a0055ca288591f_3.png)

然后。哦。有这样。或许当前SO中的时候。

![](img/af56b23c185d36a4a6a0055ca288591f_5.png)

所有数据在这样的1个SOC把它全都都给获取掉。然后我们看一下它的一个动态节，有没有一个初始化的一个函数。哦我大致找一下，发现是没有的，发现是没有的。那么它就没有那个初始化的一个函数。

接着我们来看一下它IITRV里面的一个数据。好，所您过去看一下，里面的话就只有一个函数会被掉。这个函数非常刺的它名字就是这样一个余娲富的。我们看到上60，他写这样一个可，人非常自信的。

就把这个函数给写上去了好。那么看一下它实际上这个函数里面什么都没做，就直接返回了，这是一个空的函数。好，那老所以可以看得到，哎，其实这个360它在IIT区段是什么都没做的。好，那么分析完IIT渠段以后。

我们就来跑下一个函数。那么对于SO文件来说，特别是一个安卓SO文件来说的话，有一个比较特别的一个函数，就是这样一个GI和漏函数。这是再说了初始化函数调用完以后会被优先调用的一个函数。

那么大致来看一下的话，IDA分析的结果是这么一回事的。哎，至于直接使用一个F5法变译是这种情况是怎么回事呢？因为这个函数的话，带带来一点额混淆。哎，既然如此，我们就来开始了手动进行下调试。

我们来看一下它是怎么跑起来了。好，把断点下好，然后进行一个调试加载。

![](img/af56b23c185d36a4a6a0055ca288591f_7.png)

首先安装好这个程序。

![](img/af56b23c185d36a4a6a0055ca288591f_9.png)

好，360。加固。好，我们安装好这个程序，然后然后下面就开始进行一个调试。由于整个程序它解口的时候，哎像这种SO加起来的时候就会同时完成解口。

那么在这里我们应该调在一个star application的方式来进行一个调试。所以这里这种情况下就不能够使用挂机的情况了。我希望大家还记得我们的怎么样去进行一个star application吧。



![](img/af56b23c185d36a4a6a0055ca288591f_11.png)

好，先来跑到需要中来开启它的一个调试端口。

![](img/af56b23c185d36a4a6a0055ca288591f_13.png)

接着来完成一个端口上的一个转发。看下这三纹。

![](img/af56b23c185d36a4a6a0055ca288591f_15.png)

然后完成一个端口上转发。

![](img/af56b23c185d36a4a6a0055ca288591f_17.png)

然后把它这个文件调色方式来进行一个打开。好，这第一个是一个package line，然后第二个参数是一个baation name。



![](img/af56b23c185d36a4a6a0055ca288591f_19.png)

啊，那么这么一来，整一个程序的话，就可以一个调试的方式打开，打开monet来看一下，它是不是处于一个调试的一个状态。好，找到这个函数，打开一个发起里面的端口，然后ID直接挂接上去。



![](img/af56b23c185d36a4a6a0055ca288591f_21.png)

哎，那么这里注意一下，由于我们是在调S文件，这里要进行一个设置，当在1个S文件加载的时候同时断下来好。然后进行个挂件。好，那么在这里选中我们想要调色程序进行一个调试。然后JDB完成一个挂接。

那那么这么一来就能够正常的一个调试起来了。那么在这里我们就调一起来以后，我们就可以直接进行一个运行。那么在这里如果是像我上一节课那样，已经买一个调湿器的名称，还有什么一些其他东西都改过以后的话呢。

那么在这里何化生那的可是应该不会被检测到的。如果这里还是被检测到以后被强行终止一个程序的话，那么希望大家一定要把上一节课所说到一个修改内何被搞定。不然的话以后什么可不是非难以进行一个脱掉的。哦。

我们在这里我们已经把呃这一个可的一个调试给干掉了。如果然后并且已经下好断点，在下好断点的情况之下的话，就能够直接来进行一个运行进行一个调试了。假如说没有下好的话呢，哎也不要紧。

那么在这里哦在这种情况看到了吧。在它显示已经加载完我们的1个SO程序了。下载完以后可以找到这样一个模块，嗯，已经把它一个机子，还有它的一个大小给一个弄出来了。

那么在这种情况下可以找到我们对应函数的一个相对地址，然后加上这样一个极地址也能够在对应的地方给加好一个断点的。好，那么鉴于我们的断点已经下好，直接运行起来。对。

这样一然外块已经在接下来我们漏了这一个函式中给放下来了。那么建议大家都比较喜欢来进行一个。来进行一个F5的反编译操作。那么在这里我也进行一个F55来看一下有什么效果。哎。

那么这里就是一个F5所看到的一个情况。哎，没错这它只定了一个函数跳过去，哎，你是一个jo跳过去，哎，又回到J no。哎，这是为什么这个这样的F55的一个数据肯定是不不正确的。因为这样的一个数据的话。

实际上是被一个被它的一个混淆给干掉。360的话，它是带有一定的一个混淆的一个功能的。所以在这种情况之下的话，我们能够做呢就只有去干它的一个汇编代码。

那么在这时候就必须一定要对个汇编代码有一定程度上的一个熟悉，不然的话是没有办法给分析出它的一个操作的。好，那么在这里我们就来看一下它的一个会编，来看一下这样一个圈n区段中到底干了一些什么东西。

我们一步一步跑下来进行一个分享。首先这一步是保存1个250的一个数据，到一个对象之中。现在是20是这样，然后追账是这样跑过来，然后把一个对账的一个值，哎，把2尔的值给用到对战是冲去了，然后把一个地址。

某某一个地址赋予给220。好，那么220变成这一个地址了，然后220减去4直接跳转到这个地址中去。好，这是下一块递址确的地址了。派回来以后，就把二老人给还原过来了。我们把最前面这几个段给记录下来。

因为这几个跳转实际上是非常有意思的非常有意思的。我们来看一下这几个跳转的一个作用，它是不是与某一句相当于类似。哎，这几句之后是不是和一个跳转强行跳转，它的那置呢？相当于一个低差点后跳转到这个地方，对吧？

哎，是不是等价于这句代码，大家看一下是不是等价于这个代码。首先呃保持220，然后下面有一个还原220，然后前面呃有一个对220进行一个。呃，下一个模块，这些电址与过去检视跳转过去。

然后那下面又进行了还原。哎，实际上这5句代码就和这样一个跳转的一个代码是啊等等价了。那么它跳转过去以后又干又干了些什么东西呢？我们来看一下，然后跳转过去以后，它就进行了这样一句操作。

然后下一步它又是一个保存220，然后给220下一个地址地址，哎，下一段截体地址，然后又是一个减，然后进行一个跳转。跳转过去以后，又是进行1个220的一个还原。那么这几句又相当于另外一个B叉跳转了。

实际上这里就是把下一个模块其实电子给算出来，然后进行一个跳转。然后在每一个模块的每一个跳转之中呢，都会兼杂一句真实的一个代码。我们在这里我们可以说这句代码是一个真实代码。

然后这里都是一个跳转至中间的一个代码。那么这么多跳转的代码的话，实际上就是对这样一个B叉跳转进行了一个啊扩扩展。那么这就是一种乱序的一个混淆，那是一个乱序的混淆。嗯。

可以可以达到把IIDF干掉的一个效果。好，我这是下一个模块的第一个地址，我跳转过去还原120。那么中间这一块是一个真实地址，真实指令。然后又是下一条模块的一个计算地址啊。好。又是一个还原。

然后这一条又是一条真色的一个指令。那么这样给个360的JR耳梦的话，它就是通过这样一个乱序的一个混淆呢来达到一个耳音，影响我们分析的一个效果。当然像这种混淆的一个特征码还是比较明显的。

而且这一句函数的长度比较也比较短。所以呃这样一来的话是完全可以进行一个手动分析也没有什么问题的。啊，注意一下，这里我们完全可以进行一个手动的一个分析，把它的呃这个GR里面所有函数给全部给搞出来。

那当然这样手动分析的话，就是这不是我们程序员应该做的一个事情了。我们身为一个程序员的话，就应该想尽一些办法来把它的一个工作量给降低来加快我们一个行业营业的速度。那么证明我前面所说过，对这样一个东西。

这样一个上面的一个可它的一个特征码是非常明显的。特别是这样一个跳转的一个分块的话，那它是具有明显的一个特征。那么那么在这种情况之下的话，我们就可以尝试写一块小小标本来对它进行一个还原了。



![](img/af56b23c185d36a4a6a0055ca288591f_23.png)

![](img/af56b23c185d36a4a6a0055ca288591f_24.png)

![](img/af56b23c185d36a4a6a0055ca288591f_25.png)

那么这样的一个脚本的话，可以参考一下我第二上的一个项目，就是1个DCRVN。那么它里面的话唉，那么在这里我也写一个对抗360的一个乱性混淆的一个脚本。



![](img/af56b23c185d36a4a6a0055ca288591f_27.png)

就像这种情况，找到找出这一组分块，然后直接跳过它。哎，这是我自己写了一个脚本，可以跳过360的这样一个壳。好，我们再跑一下这个脚本来看一下它跳过以后还是什么情况的。



![](img/af56b23c185d36a4a6a0055ca288591f_29.png)

好，我们调一个文件。在在在在在这里，然后啊这这。在这个地方好像是。这里我们跑一下脚本。那么等脚本跑完以后，我们来看一下它动出来的一个数据什么样子的。好，那么这就是我这个脚本所跑出来的一个数据。

我在这里唉就是把这整一个函数中的所有数据可以看到这些数据话还是比较简短，比较精简的啊。这个函数实际上也也没有多长。嗯，在这里也可以对比一下，我们手动找出来数据，和脚本跟踪出来数据是不是一样的？

然后第一步是一个把2425还有L8给保存到一个对账工序，然后把20给24，然后在对账中创建一块计时空间，减少基本21给25哎对一下，是不是完全一样的，证明我们脚本的话是的确是可行的。我看一下啊。

这个函数这样一个JI耳络函数，实际上并不长，大概也就只有230行代码不到。那么在这里我们就可以尝试着去对它的每一个会编代码进行一个分析。那那么首先它是进行这样的一个操作的。

那么我们记住一下它的2504它D参，地参的话是一个加RVN的一个结构体。然后把它给放到1个LL4中去进行一个临时的一个保存。然后下面的话就创建一个对象了。然后LL机是一个vis结构体。

这个是不会被使用的，可以放心的不用管。然后下面的话就是这一个价VN中的值给取出来。然后下面的话就是把它的一些函数地址。把它地址给取出来，然后把一个函数地址，哎是拼1元0叉18的这样一个函数。

一个地址给取出来，然后进行一个函数的一个调。那么这一个函数的话呢，如果大家比较熟悉的话，就能够知道这个函数的话，实际上就是把一个加GNI的一个版本给放过去，然后获取一个GNI结构体的一个函数的。

那么这个函数实际上并不重要，我们可以直接忽略掉。然后下面又调用到这样一个函数，这个函数到底做了什么，我们暂时不关心，我们慢慢的往下看。好，那么下面调到这个函数，调完后这样完以后就直接哎进行一个返回了。

那么这也就是一个返回的一个操作。我们大致浏浏览一下，确认一下它的一个关键点。那么在这里我们也可以看到这个函数比较关键，很有可能是存放着某一些呃特别重要的一个数据了。我们看一下它的一个名称。

虽然它的名称是这样一个奇怪的一个样子，名叫C叉A然后4加0仓，但是它的参数化非常奇特。那它就是一个价VR的结构体，然后是一个word的一个指针。那果写的话，实际上这里又是另外一个JI的一个函数。

只是它的名称被360给改过了而已。这里实际上就是另外一个JI的一个函数啊。我既然知道这一个比函数比较重要的话，我们就跳到这里来进行一个分析。在对应的地方给下好一个断联。呃。

这个名字这个的话是一个ja网漏。2楼2好我们下了断点，然后进行另外一步新的一个调试。好，这样把它关净净一点，别找出来以后再来一遍重调。进行一个挂街。那么对我们要不要重新来一遍了。

那么像我们这样调它是壳的时候的话，是遇到非常多次需要重来的一个情况的啊，这是非常正常。还可的话一般带一些反潮式啊或者什么之类的。有时候某一些函数跑过来，要重新来一遍，这都是非常正常的一个情况的。

所以在在这种情况一定要有耐心，一定要有耐心。好，我们好这个函数要骑过去。那么在这对这个函数来说的话，哎，它就没有带个混淆了，可以直接使用1个F5进行一个反变译。

那么这里将是已经是G24D第一个参数是一个加VN结构体，第二个结构是一个vis的一个结构体。那么我们就把相应的一个结构给导入进去来进行一个F5反变义分析。好。把它的结构给导入一下。这是加因2是一个。

加加盐。好，那么前面啊这个也进行一个主命名。呢个插出四个 b m 最高。好，那么这里我们就来一步步一步一步的进行一个分析。好，这里的话这个函数本身也比较精简。我们来看一下它到底干了一些什么东西。啊。

首先它列不出来一个结，一块结构，它大小是这么多，你看这里就是列出来的数据。然后下面就对这样的一个流出来数据给拷贝一段内容过去了。那么他拷贝了这样一个快，这样一个地址是什么东西，我们跳过去看一下。看到吧？

UP叉。1，你看UP叉。1，前面我已经说过了，这个壳跨是带有1个UP叉的一个压缩的。那么在这里他既然把这样1个UP叉的一个数据给拷过去以话。哎，这然把这样么一个UP叉数据给拷过去。

那么他自然哎自然而就是准备来进行一个解压缩相关的一个操作了。那么这也就是为加缩进行一个准备了。既然知道这然，那么下面的这个函数哎很显然就是进行一个解压操作，看一下，把我们UP叉数据送过去。

然后它第二个参是它的一个大小，哎，这上面的一个大小。哎，那么下面这个数据很你很显然是进行一个解压。但如果不相信的话，我们也可以。录相线的话，我们也可以进行一个单步跟踪，来看一下它是不是进行一个解缩。好。

首先第一步是进行一个另个操作，获取到一个地址。丢出来又丢出来一个地址。然后把一P叉杠一的数据给拷过来。然后下面就到这个函数理论上进行1个UP差异的解码，我们弹过去看一下。哎，可以发现呢。

他把这一块数据哎过了以后，这块数据变成这个样子了，就是显是一个结安管理后的一个样子了。接着往下跑，我们来看一下它下面就干了什么，下面它又列了一块内存出来，那么它长度就这么多。

这个长度的话是从刚才解码出来的数据中取出第一个底ward来组成的，也就是取出这样一个底or来组成的。我们可以看过去看一下好，准备6的时候，它的差度是1个CA54A582的数据，哎，等于这一块数据了。啊。

我这里也就是说这样一个解码出来的一个数据的话，它第一个底我的长度是它目标解压完以后这一个长度的。然后溜出来这样一个数字以后。然后下面就把呃逆算数据给自0给自0。好，给志玲好，全部清空以后Q加一个函数。

这个函数它到底做来什么呢？我们跟过去看一下。哎，这个函数比较简短，可以看一下，它首先可以加载1个LBC的一个压缩文件，然后给定位到里面的一个encompress函数。那么这样1个LBC是什么东西呢？

实际上这就是安卓它官方提供的一个压缩解压缩的一个函数库。它里面的话就存放的一系列来进行一个压缩解压缩的功能的一个地方。啊，那么实际上它就是一个传说中的一个lib 啊。

那么这个函数它最要就是获取到一些lab为中的一个uncomppress的个函数。好，我们既然知道它是获取以后，我们就可以直接跳过了。哎，看到了吧。

已经把一个uncomppress函数给赋予到20中去做一个参数返回。那么这里就是一个Zlib中的一个uncomp函数，可以看到这是使用1个102。8的一个exlib的。好，获取到这个函数以后。

就叫它这个函数这个解压缩的一个函数来进行一个呃解码解压缩的一个操作。那么前面的一些东西我们来看一下前面的N我是刚才列出来的一个NN属。那么这里呃在这里就是它的一个呃原来的一个数据的一个地址了。

我们在这里就写个解码，然后这是一个地址，然后这是一个呃解压缩的一个长度。然后这里就是一个原始长数，这是原始长度，然后这是一个解压缩以后的一个长度，而是解压缩以后还给存放的一个地址。好，你写一个重命名。

那么这里就是完成一个解压缩的一个操作。我们慢慢走过去看一下它解压收完以后的数据是怎么样，长什么样子的。好，它把解压以后数据存放到这个地方走过去。好，那么这一块这一块就是它解压完以后的一个数据了。

我们慢慢的跑下去慢慢看。它只要把以后它就调到这个函数，来注一下这个N什么，这个N是抵扣的长度。这是 thecom lens。然后NN2的话是这个是解解码以后数据。那么在这里哎有调要弄这个函数。

对这我们解压以后的一个枢纽进行一个操作。嗯，很显然就是进行某些还原的操作之类的一个地方。对啊，从理论上来说，哎理理论上来说，这个样子有兴趣的话，可以登一下，可以发现的话，这也就是传传递一些密钥进去。

然后比如说这个地址我们登一下的话。就能够发现哎是在一个函数的一个地址。里面的话是存放着一些必要的一个数据。然后这个地址又是另外一个关键 key的一个地址。那么他通过把这些数据给传递过去的框，哎。

就能够完成一些类似于解码的一些东西了。当然这里我我们并不关心它是如何随着去完成一个解码的。所以站到这里我们就直接进行一个跳过。跳过完以后，哎，他就对这个地址完成一个判断。这个地址是什么东西啊。

我们再转过去看一下。这是一个啊只上一个函数的一个地址，然后里面把它的一个值给赋予过来，然后下面就对这一节进行了调了。我们来看一下它传递的参数。第一个参数是我们刚才的1个VI结构体。

它的第二个参数的话实际上就是一个re一个结构体。好。那么谁呀？这里又是再一次对于一个加来进行一个转发。实接上对这样直接跳过去的一个函数地址的话，它就是它解压出来的一个数据，解压出来的一个函数了。

那我们来看一下这样哎准备调位调的时候，我们来看一下253的一个地址是怎么一个回事。好，我们来看一下奥尔三的地址转过去。哎，可以看到这是处于一个debug的区段。这个底报渠段函驱段是表明什么意思呢？

表明这是一个经过释放以后，经过解压完以后的一个数据。那么这个解码数据的话，是根据刚才那个函数和我们解压说以后的数据来进行进行一个混合，然后给6出来的一个渠段的一个数据。

那么这个数据的话里面在这个地方里面的话，实际上就是一个中央路3的一个量。那么整个生它那的壳框就可以带这个函数来完成我们的1个DS的一个数据的一个解码的一个释放。好，那么看里面到底到底是怎么解码。

怎么释放一个数据的哈。然后呢那么在这两块也需要我们去进行来另外一步的一个分析了。好，我们来看一下这样1个23的一个数据。那么在这里我们要注意一下，这里的1个2楼3的话。

它是一个呃这个地址是这样一个地回式的。我们来看一下。好，它的一个个位数是一个基数，基数什么意思啊？那么跳过去的时候，既然它个数是基数，那么跳过去的时候，自然会转成一个创的一个模式下啊。

所以在这里实际上是一个创入的，我们要改一下。它改成一个畅的形式。那么这里又是另外一个加on弄的一个函数，那么可以直接转成一个函数。然后使用一段复之前的反面一。这是一个加al3。好。

那么它第一个它就是一个加耳的一个参数。第一个参数是一个的一个结构体。那么这样转一下，哎，就会把发现它的一些基础基础基本的数据给全部给还原回来了。

那么在这一步实际上这一步的话才是真正的一个就是说前面我分析了这么大一块。比如说它从混分析开始，然后要说开始进行一个分析。那么前面这么一块这么一串操作。

实际上就是为了还原出这样一个真实的一个解码的一个操作。看一下这开始注册一个然后下面就获获取到我们那个一个class数据，就这样一个数据来进行一个let函数一个注册，对吧？下面的话都是一些注册相关的啊。

甚至是甚至是准备释放一个DNS文件相关的一个数据了。好，我来把这些东西给了。进行一个命名，然后进行一个。组合？好，那么它的第二个参数类是这样一万本结构。我的最爱姨万的几分。

那么下面就开始注册一个let体函数了。前面这块就是一个对fine class，这是一个fin class操作。从新加文，还有我们的一个class数据来获取获取到我们的一个class的一个文件。好。啊。

在这个地方就是就是一个findcast。获取到这样一个看数据以后的话，哎，那么他就开始进行其他的一些东西啊之类的，唉，什么东西都有都有可能。呃，既然如此，我们知道这么一这么一块区段非常重要以后的话。

我们就需要把这个区段给倒下来。因为因为IDA一旦它呃。ID的数据呃，比如说从这里调试结束以后的话，那么这一段数据呃，这样1个23数据的话，它都会变得没有了，都会会会可清空了。

所以我们要把这样一个Dbug091这么一段区段给下来。们那么那么既然要的话，我们就来看一下，我们就来跑一个脚本，我们现在找到这个地方啊一个758B然D这个地址，我们都把它给记录一下。

然后进行一个我们加找到它一个区段排下去。然后找到一个这样一个758B的这个那个地址，也就是Dg91的个地方。好，是在这里。嗯么在这里的话哎可以看到话，在这块地方。

那么理论上我们只需要把这个区段给弄出来就可以了。但实际上在你这里的话，我建议都要把它相离的这么多区段都同时给动出来一遍，会比较好。那么但一来的话是比较符合一个呃。状态，毕竟它并不一定只出现这样一个区段。

很有可能他的其他信息哎也都会在他一个其他地方给得到某种程度上的一个保存。那么在这里我们就把它隔壁的一些东西，一个地址都给弄出来来看一下哈。呃在这里的话，由为它都是相邻的话。

可以把这里这里的一个全部从这里092到1个079哎，把这块地址都弄出来啊，这里弄大一点的话是不怕的。因为它这个是相邻，弄大一点，我们能够获取到它内存的数据也比较多也比较多，对吧？好。

我们在这里我们就从一个以一个呃我们LD加固的1个079，这里开始。进行一个托。好，我们把它的地址也记录一下是75560000。那么它结束地址是1个758FA00，就这个数据了，然后把它动到这个me中序。

然后进行一个调取。他说的句给弹不出来。那这里动出来的一个好处就是可以让它不要在我们停止调试以后，哎，突然发现它当中的时候数据都不见了，那就很浪漫了。

这像这种新建出来的数据的块IDA是不可以保存它的一个参数的。所以像这种新出新建出来的参数，我们一般都是放在另外一个map中进行一个调试了。No。我们把他的地址给放出来。那么这由于我选的地方比较大的话。

那么这个脚本可能要跑一个挺久的一个时间了。如果是想快点的话，哎，但是我刚才所说，只需要把这么1个091呃这一段给弄出来就完事了。好，我们在这里我们等他1个IDA脚本给先跑完。那么接下来分析的话。

我们将会另外开1个IDA，然后同时也要在一个正态IDA中，还有一个动态IDA中来同时完成啊，那么这样才能搞定它的。那么现在脚本已经跑完了，我们可以看到啊在这个地方我们也经把我们数据给倒下了，大概3M多。

那么这时候我们再另开一个ID来载入这样一个do下数据进行一个分析。拖过去一个石6定制门方式打开，你后在这里选下我们的一个法贝器的类型。这里是选择1个AIM找一下。你好，在这里ARND特一的。我们选中它。

那么这里的话可以有一些核心选项可以进行一些设置。那么一般来说的话呃都不用管啊，我们确定。后载右这里的块一切都按照默认来搞。那么在这里录ing了卷子里面的话，我们就改一下它的一个及时地址，改成是这个地方。

好，那么加载大小以前呢默来搞，我们加载。看一下还这样。在老里就是被老头玩这不。好，这也不用管，我们直接加油先。那么假如果按数据的话，它就是像啊这种样子的，像这种样子的。对吧那么里面的一些函数。

它已经给我们分析出来了。那么这些函数里面的话，当然也包含这样一个将load的一个地址啊，那么在这里为了和我们的这个登出来地址相匹配。因为这里我们开始进行一个大的时候的一个起始地址，是这么一个一回事了。

那么我们接样去进行一个床垫位吧。那么等它进行一个分析完成好，分析完成以后，我们进行一个分析的嘛。好，你个记的地址横这个地方。好，这是一个陈经位。好那么查不座嘛，其些地址都改改掉了。我这么一来。

就能够开始进行个分析了。那么记录一下这个2这个23地址是这么一个地方。好吧，跳过去。好，那么这个地址就是这里的1个23地址，记录一下223其实的第一位是1个DMOP通过B要插跳转过来时候的话。

是可以从1个IIM状态转成一个chm状态的。那后大家已经改成这个样子，按P找出来。好，就是。那么这里找出来数据的话，哎，就是和我们的这个地方可对应的。来看一下是不是对应的。

对吧因为这里我们已经把它一个从定位相关的所有数据都已经给弄完了。那么在这里我们转成一个函数。进行一个反编译来进行一些数据的查看。嗯，那么这样一来哎，这还是已经弄出来。

那么具体的分析的话就留到下一节课再讲。那么这节课话呢就到此为止，谢谢大家。

![](img/af56b23c185d36a4a6a0055ca288591f_31.png)

![](img/af56b23c185d36a4a6a0055ca288591f_32.png)