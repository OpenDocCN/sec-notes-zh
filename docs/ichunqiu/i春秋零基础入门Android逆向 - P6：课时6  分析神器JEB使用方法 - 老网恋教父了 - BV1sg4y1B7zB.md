# i春秋零基础入门Android逆向 - P6：课时6  分析神器JEB使用方法 - 老网恋教父了 - BV1sg4y1B7zB

🎼。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_1.png)

嗯，好的，大家好，我是讲师艾瓜。那么今天就来讲第六课，就是关于安卓是mar代码，还有教va代码的今介绍的最后一节课了。那么讲完这一节课，第一部分算是政治的完完全完完结了。那么我希望大家在听完第义部分。

也就是前六节课以后呢，能够对安卓的一个版面，还有毕语有一个最为基本的了解，然后知道一些分析的一些小技巧，能够自己主动的去分析一些简单的一些小程序之类的。啊。呃，那么当然效果如何的话。

还是得看呃知大家自身的一个努力吧。好那么就来正式开始这一节课课程吧。这一节课的话，我就来打算重点的去介绍一个这样1个GEB的一个工具。啊，这一个工具的话在前几节课中都已经有提到过了。

但是并没有真正上自身的意义上的一个讲解。关于它的一什么怎么样去使用，或者说它的一些高级的意见的一个技巧之类的都还没有去说过，所以这一节课的话就打算来正式重点的去讲一下这一个程序。

它在安卓立项中是怎么怎么样的一个应用的。嗯，那当然这一节课的话就特别一点。这节课的话我我们的目目标程序并不是ABC程序，反而是在一个java程序。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_3.png)

啊，今天我们的目标的话是这样1个GEB2的一个demo吧。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_5.png)

这是一个demo版，和我们平时然后完全节课杰课一直在用的框是这样1个JEBE的1个正式版是频较泄露出来的一个程序。好好，那么这一节课的话我们就是分析这样1个GDB2程序，也。

可以看到这里它需要我们输入一个注册用的一个key才能够去正常的一个使用。那么这一节课的话我们就要分析它的一个注册算法，然后获得它的一个key key的一个数据了好。我废话的话就来少说。

我们来正式的去算吧。好，先来整体的去分析一下这样1个GBL程序吧。呃，它实际上的话是一个java程序，可以看到这里有1个EX的外壳。然后它实际上的话就是呃调用这样1个JL文件来进行一个。呃。

应用的你性的课我们也可以用JD来打开这样1个JR文件。来进行一个分析的。呃，最近最近的话在java的立项中用的也算是比较多的。好，我们打开。哎，可以看到这里就是长期的一些实现的一个代码，有这么多。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_7.png)

那当然这一节课的话并不是讲最低，而是讲呃就EB。我们就用JB来打开我们我们的这些文件。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_9.png)

唉，可以看到这里是有这么一段话，这么是一一段话啊，这是因为这样一个我们2GEP它是并不识别JI文件的。所以在这里我们要先把这样1个JR文件给转换成一个dash文件才行。啊。

实际上的话在按卓呃哎在按卓的SDK中就有提供了这样的1个DX的工具来为我们去把1个JAR代码来转成1个dashde码了。啊，现在呢等先安卓的话也是这样一个，它并并列时候，也是先编成1个JI文件。

然后再转成一个ds文件的。好，那么在这里我们现在定位到它的一个位置吧。呃，它就在这样一个地方，安卓SDK的一个beautth目录像，里面有一个一个版本，然后是一个DX点det，我们定位到这个目录项。

SDK然后是blueooth，然后是我们的一个版本，看到这里有一个des点，然后一个点b，这一个就是我们的dess工具。我们我们再在一个命令行中进行一个打开。ます。我是有点池。

可以看到啊它这里有这么多的一个选项，有这么多选项。那么这里的话我们最主要还是使用这样一句代码来完成1个JAR到DEX的一个转换吧。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_11.png)

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_12.png)

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_13.png)

先呃DX，然后杠杠DX，然后是一个out outputput输出。然后后面跟的是我们输出的目标的一个ges文件的一个路径。最后的话才是跟着我们的1个JAR包外回车。

那那么这里就是让它来自动的去完成这样一个呃编译了。好，这样编译完就是进行一个输出的一个d词文件。那么这一个袋词文件的话才是我们的GED可以去进行一个分析的一个最终目目标文件。好，拖进去进行一个分析。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_15.png)

嗯。然后我们先来讲一下这样最一B的一个基本操作吧。它呢是有这么多的一个功能，还有对应着这么多的的一个快捷键。如果你们比较熟悉IDA的话就会知道啊。其实这些快捷接的话和IDA是非常非常的相似的。

我们先来实际的去操盐操练一下吧。先来找到它的一个呃组类，也就是我们的一个呃如果他这如果大家比较熟悉呃java程序要开放的话，就会知道啊。

每一个java程序它都会有一个入口点和这样一个入口点它都是对应对应着一个t的一个ma函数。在这里在这里我们找到这样一个la的类，按tab键就就能对它进行一个反定率。好，可以看到这里就是它的一个入口点了。

那么对应的下面有这么多的一个代码，哎，可以找一下有一个list，其就是它的一个呃注册码的一个关键词之类的。然后这里会有一个生成呃lista information的一个地方。我们找到自己关心的一个方法。

或者一个类，双击就能够呃跳转到它它的一个地方，或者我们按键盘上的回收也是可以的。好，我们跟踪进去。可以看到我们就跟到这样一个方法。如果这时候发现方法不对，你可以按DSC来进行一个返回。

你你除了返回它当然还有前进，对吧？我们也可以按ctrl加enter来进行一个前进。好。进行一个这次返回，还有前径的一个跳转。哎，这个时候如果我们觉得这句代码是真的是很有用，跳上了进去，哎。

发现这是它生成一些呃注册信息相关的地方。所要只要有用的话，就可以生成一个注释。按基盘上的一个C或者说是一个分号来生成一个注释代码。比如说我们这里打入我们的注释。好，按确定可以看到啊。

这里就能够生成我们的一个注释的一个代码了。这是一个呃一些基本的一个操作。呃，这里的话还可以按一下其他的一些信息来获得更多的一个内容。好，我们就废话少说就来进一步的分析吧。我们看一下这一期函数。

也就是说我们只要有觉得家有点关系的这些函数来对它进行看一下。哎，可以看到它里面有句大有一个类，我们非常的关心这个lia。如果对英英文比较好的话，哎，或者说是比较有那个什么的话就可以很敏感注意到啊。

这肯定是和我们那个注册有关的一个内容。我们双击进去看一下。哎，可以看到，这也就存放着我们一些呃注册相关的一些信息了。这里还有一些呃什么一些常数之类的一些fag。

我们可以按键盘上的一个B来改变它的一个进制数。也就是这里是从一个十进制到16进制的一个转换。可以自己按照自己的需要来进行一个转换。对吧好。很B。然后这里我们可以找到自己关心的一个地方，哎。

大概的翻翻一下，浏览一下，看一下有没有有没有什么有有有用的一些信息。哎，可以看到啊，这里有一个这里就是一个ge，然后看一下的话，这里有一些有一句代码非常的奇怪啊，什么SIL点OD呃，传入这样一些数据。

哎，这些数据是什么，我们看不懂我们真心看不懂它到底代代表什么样的意思啊。对吧，我们。可以大大致的来猜想一下，他是不是他是不是把它的它的一些关键字符串给加密了，然后在运行的时候才动快解密呢？

它是不是这样来的？我们先可以大致的猜想一下，然后这里可以双击跳进去来看一下这个函数的作用，是不是我们所想象中的一个解密的一个作用。双击跳了跳进去。哎，发现它下面真的有这样一个呃解密字符串的一个代码。

看一下，对，就是对我们传递进来的一个字符串进行一个运算。然后最后再返回一个str，就是解密以后字符创。哎，就可以看到它字符串的话是在运行中进行一个动态的解密了。好，我们找到我们想要想要的一个类容。

使用一个N来进行一个重命令。比如说这里就是呃解密号的一个字母串。我 to扣 straight。好。对它所在内也进行一个重命名，按基码上的N。嗯，地名的话就随意吧，只要自己看得懂就行了。看懂这就行了。

我们可以实际上呢去看一下这样一个做餐给姐妹以后是怎么样的一个结果。我们就把这样一个方法给列出来先。诶。我们一步一步来看到这里，它有三个方法，它它里面有三个参数，第一个是败参数。

然后后面跟的是两个in核的参数。好，它里面首先创建了这样一个类，双击跳转过去哎。创建这样一个类，然后传递三个方法，给初始化它的一个三个的一个域。我们重命名一下，比如说是这CRGE。

然后下面是A9第二个参数，然后是第三个参数。接着我们创建完这样一个类以后，就调用这样类的1个OB方法。这里就是实际上的一个解密方法来对这样我们传递进去的一个参数进行一个解密了。好重命名。那么这些类的话。

就一些方法你是就大致的给重命名过去了。那么下面的话这里就是实际上的一个解密的一个应用了，就是解密的具具体的代码。我们这里可能没有这么容容易看得懂，但看不懂也没有关系。这些代码和我们可以尝试的去运行一下。

哎，我来编一个简密程序。好，我们打开我们的一个编程程序程序，呃，这里随便选一个可以编译java程序的一个。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_17.png)

加到哪一个程序就可以了。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_19.png)

好，我们再嚟上I d a。呃，毕竟这个与and卓 studio是比较像的，我们我就用这样一个东西来进行一个。ああ、一。好，放到我的。对。名次的化学运题。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_21.png)

然后就来创建我们的一个程序。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_23.png)

哦，我们我们把我们需要的一个解密代码，这里就是这样一个解密的函数。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_25.png)

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_26.png)

来卡到这个地方。接着把简历相关的一些内容也拷贝一下。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_28.png)

好，然后就来慢慢慢的去修复修复。啊，因为它本身就在一个内缝，我们要把它给拷贝出来的话，它肯定会有很多的一些语法错误的。那么这个时候就需要我们去进行一个诉工的一个修复了。

比如说这己的一个地址则显然就是不对的。这里没有电池的，这是一个静态能的电开地址，我们就把电池给全切掉。可以再来找一下，这里还有1个OB的一个耳玉，不知道什么东西，把开原来看一下。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_30.png)

OD呃，在这里可以找得到按键盘上的一个X可以找找找找到它的一个交叉引用。哎，看到这里，它是一个复助的地方，双击点过去就能够进行一个跳转。哎，可以看到这里就是从一个传着一个 string过来。

然后返回一个str，这相当于没有没有解密的一个东西。那么这个就我们就不关心了。它因为它没有解密，就不需要关心了。直接这里就进行一个返回就好了。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_32.png)

好，我们这里就把整个物品给删区，我们没有用了，就拍三区。好，怎么这样。看到它已经没有错误了，我们就可以试着去对这个代码进行一个调用，来看一下它呃是不是可以实际上进行一个还原。我们找一个使用的例子。

比如说这里我就看一下这样一个自动刷解密以后怎什么样的样子。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_34.png)

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_35.png)

好，输出一下们丝调用。首先一绩。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_37.png)

好，哎哎哎，可以看到他会检列出来数据。第一个是二楼，哎，证明是已经对了，但是后面还是看不到。呃，说明我们的方法中还有一些问题，还有一些错误。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_39.png)

啊，这这个错误啊，其实是由于呃GEB它在反备一过程中有一些地方不太好所导致的。比如说在这里可以看到这里，这里有1个V1杠1，不知道什么东西，对不对？其实啊这个V1杠1呢就是相当于前面的1个V1了。

它是他在编列过程中发现它这样一个继存器的一个呃类型突然转换了。那么它就使用一个杠一来表示，虽然他们用的是同一个字计存器，但是它的类型不变化了。对应的这里V0杠1，实际上它也是用V0这样一个继存器的。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_41.png)

好，这里我们就把这样一个呃实际上一个错误给清一下。比如说这里是不是一-1，我们转成10就好了。那准比较好了，好好好。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_43.png)

看这里这里是呃。1个V1杠1的在这里，我们把这个给修一下。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_45.png)

好，再预习一遍。哎，可以看到已经正常的还原出一个releaase一个字符串出来了。证明这个就真是一个呃释放字物串的一个函数。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_47.png)

自然解面这范围函数不限的话，我们也可以找一下其他的一个方法来进行一下测试。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_49.png)

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_50.png)

这里V3全对B过来V3是2。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_52.png)

跑一下。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_54.png)

哇底bug好，那么对应的我们就可以把解密以后的一个信息。给你注射的方法给显示上来。哎，那么这样一来的话，是不是就清晰很多？比如说哎这一句办法就是如果我们的注册码是一个releaase变框。

那么这里V0就填入一个releaase的一个肉串。如果不是的话，就填填用一个debug的字册。哦啊，那这这样一来哎，看一下还是挺有趣的。但实际上啊我们可以看到这里有这么多需要解密的地方。

我们总不可能一个一个的去手动的去进行一个解密吧，对不对？哎，那么这个时候就要想一下方法，有没有办法让程序去挖，自动的去帮我们完成这样一个解密操作呢？哎，实际上是可以的。这是看一下。

这是我们的GEB财产税所强大T拔，它就提供了这么一个参这么一个接口，让我们去改变它反编译出来的一些结果哎。这就是它的一个强大的地方了，这也是我今天准备重点介绍的一个呃它的一个插件。

它是支持这样一个编写插件的，它允许我们去写一个插件来改变整一个程序所反定页输出来的一个结果，或者让我们去获得它的一些内容。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_56.png)

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_57.png)

这也是为什么这一B是神器之一啊，但实际上就我知道啊来说是很少人会用插肩，会知道插件怎么用的。所以这节课。还是挺挺挺有用的，还是挺用的。呃，一般对于一些高手来说，他是无论是什么样都能够用的。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_59.png)

你行流畅之类的。好，我们看一下它的一个插件的帮助文档吧。那它的插件的话，它官方是有提供一个接口，一个帮助文档的，可以在这里QOC里面可以找到这样一个资文件。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_61.png)

这个解压以后话。这是它的一个插件接口说明，这打开，这就是它的1个API呃，这也就是插件的一个说明。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_63.png)

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_64.png)

好嗯，那么这里我就以最为简单的一个插件来进行一下事例吧。比如说我们写个hello world，嗯，每一个程序员都是从一个hello world开始的啊。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_66.png)

好，我们把它的一些开发相应的一个东西给拷过去先。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_68.png)

我们先把一个这一批程序给拷出来。我们先导入这样一个这器毕业包。呃，导入java包。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_70.png)

进行一个导入。然后呢，我们这里创建一个类。名字随便写，名字随便写。那么在这里的课们来对照着一步一步来引入我们的一个插件吧。好，首先我们要inport这样一个接口。

这是每1个GAB程序中的一个插件中都会有的一个接口，这是ZAB的插件进入的一个代码。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_72.png)

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_73.png)

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_74.png)

我们进行一个导入。5炮GEB。呃，关于这样1个JPJPAPI的话，我自己也记不住，每一次写要靠，我自己自身也是要呃查相当多的一个资料才能写出来的。所以一定要养成多查这资料的一个习惯。好。

那么在这里我们就从这样一个接口中导入我们的一个方法。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_76.png)

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_77.png)

女黑们。然后IC奎。好，可以看一下。它里面就有一个这样一个方法来重写这样一个方法了。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_79.png)

你说。首先它会有一个参数传递传递传递过来，然后加样一个参数名字加入这一个in，就是在一个GEB的一个实例。我们获得这样一个方法值之后呢，就能够调用它的一些函数了。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_81.png)

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_82.png)

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_83.png)

好，这里它存着一个遵义兵过来，我们现在保存一下。啊，然后在这里的话，我们调用它里面的一个P函数。这也是一个输出函数，我们来输出一个helloer。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_85.png)

好，那么这样一个最最边简单的插件就编程完成了。我们试着去运行一下它运行的话可以在这里文件执行脚本就能够去执行我们的一个呃脚本了。啊了找到我们刚才写的一个java代码。呃，关于这样一个脚本呢。

它可以是批审文件，可以是java的一个呃文件，也可以是也可以是打包好的一个JR文件。我们这里就直接用java代码了。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_87.png)

双击哎，可以看到这里输出到一个hello world，这就是我们一个程序，也就是一个插件手会执行的一个方法了。那当然了，我们是并不只限于how word了。

我们实际上是想呃让程序去替我们完成一个反馈页的操作。在这里。现在在这里，我们在这里就来找到所有调用到简密函数的一个地方。它基本上的一个X的话，可以找到这样一个类中的调用。果如果按ctrorl加X的话。

就能找到整一个程序中调用到这个方法的所有函数了。好，可以看到这里有这么多地方都调用到了，我们随便找一个地方类双击进去。可以看到这有这么多decode。

然后这里用classboard来进行一个呃反射调用的。啊，这个GB的加密还做的挺有意思的哦。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_89.png)

然后我们用它的一个插进来对它进行一个缓乱。呃，下面的话就是它的一些呃。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_91.png)

一些其他的一些功能。呃，这里一个呃比如说这里是取它的一个des的，也就是一个函数的一个方法。然后这里是取一个方法，取第二个方法。这里然后这里是取啊一个class的一个签名。然后这里是版面一个方法。好。

那么在这里的话，我也已经呃这一个还原的脚本位置我也已经写好了，断码不长啊，我们打开来看一下。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_93.png)

嗯。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_95.png)

好，我们打开来看一下。这是我自己所想好的一个呃还原脚本。也就是自上环的一个脚本，可以看到它不长只有200多行代码而已。首先呃这里我定义了一个我们想要还原，或者说找到一个方法这样的一个类。

这个方法就是我们刚才吉密字符创的一个方法的一个签名了，这是很显很显要的一个java的一个特征，签名特征。前面呃这一个的话与我们的一个smar代码的变用其实是很像，对不对？前面就是一个类名，后面是方法。

跟着一个是方法，后面的一个返回内容，还有它的一个呃signature的一个值。这个的话也可以在找到对应的类中可以在这里去查看得到。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_97.png)

因为这里我从内面过矿去，没有那么清晰而已。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_99.png)

实际上我们找到我们对应的方法，我来解释一下这个简历脚本吧嗯。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_101.png)

可以先跑起来，我这边烤边这些。进行加粉做到。写出来这样一个脚本。呃，如果大家有兴趣的话，在下面也可以自己去试着去写一下。我首先我定义了我想要找的一个还原的一个方法，也就是这样一个简面的一个方法。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_103.png)

好，我们下来从一个run，就是它入口进去，先取到1个GEB的一个实例。然后在这里的话，我就。来先获得它的一个d的一个内容，也就是它的一个字检码的一个数据。

在这里呢我就在取到它一个所有方法的一个呃我取到它的所有所有方法，一个技术，它总共有这么多方法，然后我一个一个的对它进行一个便利。比如说在这里我就取出第I个方法，然后获取到它的一个签名值。

以我上面所定义的这一这样一个方法给对照一下。哎，如果对的话，至找到最找上我们想要找的这一个方法，也就是我要找这一个方法给对照一下。哎，发现这签名是对的。呃，这个签名就是我们下面看到的这样一个签名啊。

是一一致的。我们认么是一致的话，我们就证明我们找找到这样一个方法了。接着我就对这一个方法查找一个交叉引用。交叉引用也就是找一下在哪一些地方可以调用到我的这样一个方法。你这里找到所有调用的一个地方。

然后这样对所有调用的地方的话进行一个取出来。这里的话我就取出它的一个调样的一个方法的一些参数，把所有参数给取出来，然后进行一个呃。来，动态的一个还原。下面的话就是一个还原的一个代码了。

这里这里就是取出我们一个call，也就是一个方法这用。这里发现这里一个co的方法和我的原来方法是一模一样。那么下面就取出了一个argu with，那就是所有的一个参数，取出它的一个参数。

然后取求参数的一些值。下面这里就提供它是CB中提供了一些一些参数。来取出一些词。然后把一些值接给取出来以后的话，就这一个方法进行一个还原。哎，下面的话就是和我刚才所写的一样。

其实事实上就是像一个技由串还原还原的一个函数了。在这里我手我手动的进行一个还原，把还原的结果，也就是还原成D一C技础算给替换成一个呃。把原来的一个函数调量给替换回去。那么这样一来就完成了整一套的还原。

那当然了这个说起来比较简单，但实际上接起来的话是很低很依赖于对呀。对于这样一个插件的一个熟悉程度的，可以看到这里它定了非常多，它自己的一个元素。啊，你也得对插件有一定的熟悉。

还有对它的方法有一定的熟悉才能够去写出来才行的。这里的话，我就比如说这个那找找到对着扩一个方法，我就一步一步一步啊取出它的一个参数了。这里是取第一个参数，这是一个r型的一个b参数。

然后得把它一个每一个数字给取出来。然后它第二个参数呢是一个int型了，然后取出它的int值。好，第三个也是一个in值可以全部取出来。然后把1233个呃方法做一个一个阿里斯。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_105.png)

给传进去还原，还原以后再替换回去。嗯，好了嗯，这样呢一来的话啊，整一个脚本就算是跑完了。那么这里我可以找一下交叉饮料来看一下我们跑完脚本以后呃，是什么样的情况。哎，可以看到啊。

这里本来的话是一个方法来调用的，但实际上已经给全部给还原回去了。对吧哎，这些字符算全部给华园培去了，这就是一个脚本的一个应用。它实际上就可以直接的去影响我们的一个反馈的一个结果。

可以让我们的一个代代码显得更加一个清晰。好，我们再跳回栏我们的一个list，也就是我们注册生成的一个地方。来看一下是不是变得更加清晰了。好，我们来找到我们的历史的一个类。好，我们访到历层这一个呢在这里。

然后这里。哎，可以看到这一些字符串，本来还是加密的，现在已经解密了。好，好好我们在这里的跨境慢慢的呃找他算做车码的一个地方。在这里唉可以看到有一个3D套袋，就是设置一个注册码一个过期的一个地方。

我们选择一个查找交叉引用。呃，也程去来找到它调用哪一个地方。哎，看到这里有一个che key，那就是检查我们注册码。显然这个就是光源地方。在这里呢就会检查我们的一个注册不是否正确。好。

我们再一步一步看下来，这里有一个对比，呃，调用这样一个方法来对于E2参数传的进去进行个对比。如果正确的话，哎，就可到这样一个。这是一个lea key。对吧。哎，在这里就行到这里，然后如果不正确的话。

就可以结束整一个进程。特门人就是结束进程。哎，这这里的话这里的话就是一个失败了。好，我们就看一下呃。这么一个东西。这个对比函数是怎么回事？首先这里是get stream key。

这里就是取出我们我们的一个注册码了。处理一下吸水器。然后取出药，主要是从这里取过来了，不知道什么东西。然后再有1个V0。这样一个V林的这样一个方法，传递两个进去，一个输过去。好。

V林的话就是肯定是和我们注册码相关的一个类了。V林是这样一个类，它是和我们注册码相关的。好，把这个列成命名一下。林这一个值的快也求命名。好，点进去这样一个方法去看一下。哦，往后那么这一个。哎。

这里的话就是一个注册码是我处理的流程，可以可以这里的话就可以看到它有一些运算。对，就算至算我的这个一定要运算。然后这一个就影响了我们一个反回值，把它一个te或者访它一个for。补回 true的话。

这里就是自动注册成功了。做成功的时候就会发馈这样一个东西。哎，那么就可以可以看到这以他注册给用到了这么多的一个数据。那么这个算法就留待大家下面自己去分析他做的什么内容。

这个算法就留待他自己去进行一个分析。呃，这里的话我就主要的去说一下这样一个呃。它有一个机器码的一个生成，可以看到这个绿色叠加芯建的时候是传递了一个参数进去了。

这个参数叫做UMIMID在这里的话就是实际上是它的一个机器码了。我们就来跟踪一下这样一个机器码式生成呃，然后它的一个注册的一个函数。这样一个函数就留给大家自己去分析了。好。

我们跟踪一下这样一个呃注册网生成的一个地方。在这里哎它就可以传递我们的一个机器网进来，然后保存。我们就来看一下这样一个机器码是从哪里给生成的。呃，在这里我们按X来寻找一个交叉引用。哎。

发现它并没有什么交叉引用啊，我们可以找它的一个初始化的地方，或者是说是复制的地方。双击哎，发现它并不是在这一个类中声明的。一般对于这一种这种情况的话，都是因为这个函数是从它的一个呃负负类去声明。

然后它继承过来了。这种情况的话，我们就点到它的一个负类中去。在过来中寻找。这样一个类。哎，可以看到，实际上他是从他的这样一个内中声明，然后在这里再继承过来的，然后在这里再从这个地方继承过来的。

黄在这里的快门就从这里开始呃定位定位到这样一个地方，这里是马兴菌。我们找到这一个地方来看一下它怎么样的生成那一个东西，还是一样，按1个X来找查找它的一个交叉引用。好，可以看到这里有一个腐蚀的地方。

这里就是一个腐蚀，扶一个模型可以过去了。在这个方法双击点进去哎。好。可以看到啊。往上滚一下。这里就是实际上就是我们生产注册码的一个类。可以看到啊，这里有什么这么多生成相关的一个方法。啊。

什么WMIC boss电视renber。就是。可也可以去来看一下啊，这一些代码什么作用的？

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_107.png)

哦这机就是只用呢就册马是这样一个东西。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_109.png)

我们就可以确定了。好，用还是一样，使用N来进行一个存命名。我在算。按基本上的X来查找交叉引用，看一下在哪一些地方。它掉了它或者是对它是进行一个复值。在这里看一下，复值为0或者复值为一个函数10%。好。

这一个词好，对，是上层周上麻啊，生产机器码。好一步一步的晚上给调回去。呃，对它一些类型啊，还有方法名啊，还有些还有一些域进行一个重命名，就能够呃使方法变得更加简单。好，这里我们找到这样一个方法，双击哎。

点进去看一下它怎么生成一个机器码的。好，唉看到了吧，这里取出一个OS，就是取出我们的一个系统的一个呃版本是windows上就这用这样一个方法，因为是用这样一个方法。那的话就这样做。

然后其他都不是就变成这样一个东西了。后面在这我我们的机器码，或者说上面取取消了一个值进行一个求AB5的一个运算。好，我那么这样最后就返回这样一个值，唉最后返还有这一个就是我们所谓的一个机器码。

这就是它的一个生成的一个路径。我们这里只要关注一下windows。呃，对相应应这己关注一个方法进行一个充命名。好，我们关注一下，这里是怎样生成一个呃VN上的一个mine key的好，双击插进去。哦。

那么这里就可以看到它是通过这么一些呃函数或者是方法来生成一个注册码的。从这里就框了一个s number，然后这里进行一个t。那么这步这么一步下来，唉，最后就取出这样的一个值进行一定的一个运算。

就cros，然后返回一个V02值，也就是我们的一个取出来的一个字助创值，也返回过去。然到这里对它进行一个求按定我值，哦，然后最后再返回。那么这样一返回的结果就是我们的一个注册码。哎。

这样也一这样一来我们就一步一步的往上给回溯到它一个生常注册码的地方了。好，那么通过这样一个方法，哎，这个注册码值就可以确定了它是这样生成的。好。然后这样一个注册码生成以后。

我们就再返回来来看一下我们的一个刚才找到了一个是注册码的一个函数了。嗯。刚才是在哪里去呃？生成一个注射码了。う。好，这里看是在这样一个函数中来判断我们的注册码是否正确了。在 key就是我们所有的注册码。

然后这里就用我们我们的机器码来就始化我们的注册位。好，那么这里就是我们的一个呃注册码检验K是我正确的地方。好，这里有这么多的一个函数。好好好好，那么这里一段函数的话。

就留作为一个作业来留给大家去进行一个呃呃解历啊，这一段函数的话虽然看起来很长，但实际上是不难的，它是。只有真正的学起来，其实它实际上有只有这么一大部分而已，是挺简单的。

那么大家在下面这块就去进行一个静态的一个分析，练习一下分析的一个能力。这是这一节课的作业啊，这一节课的话可能讲的比较零水，比较零碎啊。嗯，但是涉及到内容是挺多，特别是这样一个插件的编写啊。

这个插件的课我也可以给大家。那么如果有兴趣的话，一定要自己去实现一遍。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_111.png)

这个插件编写起来是挺难的。嗯，主要还是说一下这样一个插件，还有一些呃JP上使用的一些小技巧。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_113.png)

呃呃，这里的话就是完成一个整1个J1B2的一个这er。呃，那么这个话可能对大家来说会有有一点的难度。所以的话我也可以给相应相应的给出一点了提示。呃，相应的给出一点提示。呃。

我可以先帮大家来完成一个一部分的一些内容。呃，如果大家的话，可以根据我的一个呃给出来的一个代码给完善进去。那么最后完成以后的话，一个基的它是这样一个样子的。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_115.png)

好椒杠结啊。这里我就下来就记了。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_117.png)

好是啊，去注册一下吧。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_119.png)

嗯，在这里等我。

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_121.png)

🎼注册一下，哎，就发现已经注册完了，然后检测一下唉版本到这里结束。好，那么这里就是一个呃记。好，那么今天的课程话就到此为止了，谢谢大家。



![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_123.png)

![](img/a6cfe84a3e48d4ccdd047b2d4f20610d_124.png)