# 经典15年i春秋渗透测试系统化教程 - P42：课时6  Sturts2、Java反序列化漏洞演示 - 老网恋教父了 - BV1n54y1B7F7

好，我们给大家把这个sstrs two这个漏洞给大家演示一下。呃，前面我们给大家讲解了这个命令执行啊，那么这个说做一个小动画，那么这个小动画我们给大家补充一下，看是怎么样的一个过程。呃。

那么我这里要找到一个地址啊，存在是装饰区的一个地址呃，在本地也没搭建环境，大概就是随便找了一个啊，给大家大概演示一下。呃，在这里啊，我们直接。看啊他就可以获取到了一个嗯路径啊，路制权限。当前是。啊。

也可以在这里命令执行。很快的啊，这个是K8开发的呃一款工具啊。非常方便。呃，包括全木马都可以传啊，都可以传。然后我这里当然我不建议大家在这里嗯，大家传木马上去啊，这个相当的不好。

尤其是在别的服务器上调试断断断机了啊，这样的话最终结果会导致啊非法。那么在这里我们看一下啊，我们la stand啊，看一下它的端口连接啊。还有当前端口连接的一个情况，当前开了哪些端口是吧？

他这个就跟操作自己电脑一样啊，LS我们查看当前的文件目录。当前的网站的根目录是在这个目录下面是吧，也就是这个目录。は。其实来到这里，我们就是直接可以执行命令的。你可以自己嗯在这里。自己那个都可以的。

你像我这里刚才嗯。为什么就这个路径啊。Yeah。来这里刚才选了一个K8的嗯嗯一个木马啊，这小码啊，在这里我木马木马上去啊，传了两个进去了，把小码大码都传了一下，等一下马上把它删掉啊，删掉。Yeah。

我们把它RM一下。Yeah。Oh。Okay。Yeah。Yeah。Yeah。我，已经删去了。啊，传传上去，我们就把它删掉哈，保姆吧啊。那么包括我们在这个地方啊。

就是说啊大家可以看到这里的地图有这些目录是吧？啊，像这样的目录啊，我们这个像这种目录一般是有密码账号的，可以看到这里啊，原来是有外博XML，包括这个外博的可以，包括这些啊。helloXOL。

那么这些文件我这里就不打开了哈。这里面的一些嗯有有一些东西啊有一些东西那在这里不掩饰的。呃，全木马这里啊可以取，就是说stras去就跟操是非常危险的一个内容。也就是说link口都可以操作。

就是命令执行文件上去啊，全木马直接跟因为毕竟与录制权限，直接录制权限，直接跟操嗯远远程操在本地操作跟远程操作进来就是服务器一样，包括文件管理都可以都可以操作啊。尤其在这里我们有了这个之后啊。

有了这个之后。衣服看的可了，应该是你那个系统。Eex系统啊，它是一个内网的。给我的服务器。嗯，他没有接那个类呃其他的机器啊，有一张网卡。所以说嗯。大概的就是钻石 two啊，就是嗯很简单啊。

大家自己去网上在网上污染上面太多了啊，大家可以看一下啊。服员。关于私教事铁。你收拾一下，靠就是远觉变态。不能搜索。帮我搜索你百度呗。追踪压垫。啊，在这里。你看态度太多工具利用更具多。呃。

关于这个内容的分析啊，哦，网上文章都有。工具。他这个是一个调试哈，关于这个s加尸T最近的几个类洞分析啊。跟稳定利用。他这里有一个详细的一个过程。Yes。呃，微远上面的案例比较多，大家自己看一下吧。

因为这里没有登录账号，就直接。嗯，演示一下，不搜索了。啊，关于这个漏洞，我们就给大家演示到这里，呃，其他的呢大家自己去发挥了啊，我们我就在这里嗯不再讲太多。呃，后面等一下还有一个这个。

另外一个一另外一个类容命令执行啊，关于这个基本式的一个。内容啊GBss的一个发编译啊啊序列化这个内容呃，到时等一下给大家一起啊，打包放在一个教程里面吧，给大家，反正是命令执行啊。

全部放在一起给大家呃等一下我搭建一个环境吧。好，这呃，先暂停一下啊。呃，这节课我们给大家讲解一下这个机呃这个抓物的这个法学。仿虚化类的啊，这个是最新报的一个漏洞啊。

其实在2015年这个年初的时候就已经出来了。呃，但是在最近才火起来啊，在国内就是说呃新闻报道的比较多。呃，这类漏洞的影响很大啊，它是直接命临执行拉微波是啊，控制控制这个操作系统呃。

它的原理是大概和PSP其实是呃差不多啊一个反虚化一个对象注入啊，可以造成这个代码直接执行。那么只要这个包就是存在这个漏洞啊，所以说这个只要使用了这个lib，都有可能就是2C1，就是包括这个Gbox啊。

包包 lock啊等等其他的一些程序。那么我们看一下这个网上的一个呃报道啊，大家可以看一下网上很多啊。包括五羊是内板虎啊，水把的。嗯，你看一下什么是这个缓蓄化类的。嗯，2015年初的时候。

APPCer卡里大会上啊就开始报道了这个雷洞啊，后来不包括这个，但是没有重视起的，没有重视起的。啊，最近现在这个工具也提供出来了。啊，工具这个抓火防虚化这个内洞，这个工工击工具也出来了。

等一下会给大家演示一下在本地。你看啊呃包括最新版本的weblock啊，这个we博 sale呃呃包括这个Gbos。caseopen这个NMS这些大名鼎鼎的这个状文应用都可以实现这个啊源态代码执行。

所以说你说它这个漏洞影响大不大，影响是相当大的，所以看它的风险啊，风险有多大。啊，如何排排查，就是在GBss里面，我们找这个文件，就是说它因为这个文件是呃。是通信过程中存在的一个公开的一个。诶。好。

不是啊，就是说他这个文件等一下会。呃，关于Gboss就是默认安装完之后，它就有这个文件，就在这个路径下面，在你的网站后面接这个文件啊，一般的我们通过它来进行一个连接测试啊，进行攻击。

因为在Gbos之中啊，这个这个文件是可以在可以使用HTV协议与其进行一个通话的。所以这一通信功呢它是依赖于啊转我的这个序列化类啊，转我的序列化类啊，所以说我们在攻击的时候啊。

这个这个文件在通信过程中就存在一个公开的一个内容啊一个内容。呃，我这里演示的话，我就不一一演示了哈，针对这些一一演示的，我只要把这个Gboss等一下会给大家大概演示一下，大概讲一下。😊。

不能安装网是8080端口啊，这个基PS石这个微博这个ccl口啊是1个啊8080端口。大家可以看一下当前的一个影响啊一个影响啊呃巴08利当口得占14%啊，8令当口占11%，每日东可占75%。

北京的影响有这么多，你看上海广州一个排名。

![](img/1eb5cbf33f1ae29a20d9bbe2124a633d_1.png)

这个是关于他这个急报式一个。一个详细的一个内洞的一个描述。嗯，这个是类洞的一个概要，包括内洞的一个原理，它是怎样的一个原理？呃。

污远上面有关于这个嗯基本这个抓物这个反序序列化这个漏洞的一个详细的一个代码分析哈，大家自己去看一下。那么在这里的话，我们不是我们主要是讲一下大概的一个影响跟这个利用过程。

关于这个呃到底是怎么去造成这个漏洞的，这代码怎么去一步一步的分析啊，啊，不是我们呃来进行一个扩采范围之内啊，大家自己呃不是我们呃在扩采范围之外，大家自己去研究啊，所以在大家去污远上面去看一下吧。

那么在这里不再做太多的描叙，这个是一个漏洞呃。😊，演示过程。大家可以看一下。漏这的一个影响啊，对这个版本的一个影响啊，这个是知道创与安全团队针对基PS手进一个检测受到的影响版本。呃，这个探子的结果显示。

这个漏洞受影响的一些厂商有这些军原啊中洋铜业啊管啊，包括民间的TMTM网站这个安全管理系统，这个是他的这个呃安海的一个产品像浙江的啊智会在线。啊，老板电器啊啊，你看太多了。这个关联内动的一个连接。

大家可以看一下啊。啊，有关内容的一个详细的一个描述，包括参考的一些说明。嗯，Cbug这个网站，但建议大家自己都去看一看。你看他这里都有掩示哈都有掩示。它的一个影响啊，这是微log。啊。

他那we block的这个影响也是相当大的，你看是吧？做音销的版本有这么多版本。看一下中国有多少。怎么哒？包括分布图都已经给你写好了，受影响的。太大了，实在是这个内洞实在是太严重了。



![](img/1eb5cbf33f1ae29a20d9bbe2124a633d_3.png)

呃，我们这个就不再多太多老去。我们看一下啊，这个演示演是的我当时这个做了一个教程，没有语音的啊。太公司，那么给大家看一下。好，大家看一下我这个当前的一个演示。呃，演示之前我们先给大家说一下啊。

首先搭建一个环境啊，及boss环境，这个环境怎么搭建呢？装一下stoOS6。5啊，stoOS另那个是stoOS66。5搭建环境啊，这个环境是用y么原件安装啊，y in呃。

就是安你要你要安装Gbos环境的话，你首先安装抓物编译环境啊，把这个抓物该需该需要的一些组件把它安装一下啊，用这个命令进行安装在W gate。把这个起bos这个版本把它下载下来。在这里下载。

下载之后进行一个解压啊，UNVIP啊解压解压你下载的这个机包安装程序。呃，再接着MV就是说把它移到啊一个效应的目录下去啊，这个目录啊这个无所谓哈，这个移到你在当前目录安装也可以再接着建一个普通的用户啊。

ADDUS。改变公园呃，改变这个权限一样，就是说针对这个把这个用户呃给这个这个路径啊。啊，属于就是说这个Gbos用这个用户啊，再接着SU杠L就是切换用户再再CD啊进入这个目录再进行运行。

就是本地运行这个Gbos啊，启动long点SH就是启动的意思啊，启动这个。启动这个Gboss启动完之后，那么记住我们要嗯攻机，就要这样的话，环境就搭建好了。Gboss环境大家攻击的话你需要攻击工具。

这个工击工具在哪里下载啊，用到这个工具哈，记住哈啊YSOSERIAL测光工具在这里下载，这是我提供大家的最新地址啊，用Wge去下载一下下载完之后啊，用ja物杠ZRR。😊，进行生成一个什么针对这个工具啊。

这是我们下载的工具，再接着你的工具名称。呃，再接着就是说这个地方就是写什么呢？这个comments啊，看到这个呃。呃，这个就是意思是说我后面要接什么命令执行啊。啊，借什么命令执行。

用这个工具生成一个Pload啊，生成一个Pload。注意哈，就是说我们下载这个工具就照过来刚GR里来进行生成一个piload。这个Pload里面我们写上了一条语句，这个语句是你手工输上输输进去的啊。

注意这一条命令需要你手工来输入这个TOUCS就是新建的意思，就相当于我们window下面，因为是在inux上面。就相当于。好，没好意思。い。就相当于TOC1是在linux在linux里面。

相当于windows里面的右键新建一个东西啊，新建一个文件一样，是这样的一个过程。嗯，在我在这个TMP下面新建了一个test123啊，这个文件。啊，再个呢呃。就是说嗯生成一个P纰漏的。呃。

这个P漏的是在这个TMP这个目录下面。再接着我们执行这个命令，用这个C1RL这款工具，刚刚hel头啊，这个连接类型不这个啊，这个是连接这个geboss啊，GbosGboss这个是攻击地址。

就是说首先你安装了这个环境啊，搭建了这个环境之后，Gbos环境之后，那么。本地的话，如果说是本地的话，那么就会有这个地址，就是这个前面是你的域米或者是IP地址，后面再接着你的端口号端口号。

大家注要这个是加载P披漏是哪个呢？我们这里生产出来的啊，这里啊用这个工具生产出来的攻击啊这个漏里面主要是这条语句to就是新建啊，或者你啊W gate可下下载啊一个一句话木马啊。

存取到对方服务器里面去你这里ou gate也可以啊去远程下载你某一个对应的这个木马啊GSPPS木随便你自己啊根据关键是攻击的对象程序的对象是什么样的程序啊什么样的程序。呃，这个地方是。

就是说我们要攻击的地址啊，这个是加在P漏的，P漏的是根据这个来哈，就是说你身上在哪个路径，你就加在在在哪一个啊这个地方。嗯，这个地方的话就是空击的地址，我一直要强调这个地方没别搞错了啊。

这个地方们没不要搞错了。前面是这个这一部分是保持不变的啊。这个地方要注意啊，就是人格来说啊，这个是三菜披漏的，放在哪个目录下面？好嗯。如果假设下。哦，你要工接。程试的地址是攻击的地址是远程的。

那么你这个IP不是127。001，那么你写的远程的地址，明白没有啊，呃，这后面的测试，那么你后面就不用管了看了哈，那么你输入这条命令之后，它就开始进行攻击的啊，它就会直接新建一个这样的文件。

新建这样的文件。那后我们来看一下这个效果啊，看我嗯是怎么演示的。Yeah。我直接把这个把这个命令。啊，我在这里改了一下啊，新建一个t，好就是一加3嘛。123。我们首先看一下我当前的目录有没有这个。

有没有这个t123。啊，当当前是没有退迟123吧，只要T2是吧？好，我们现在开始。好，生上一个披漏的。等你的。好，大家可以看一下哈，当前我这里有一个纰漏的，你看。这个批道的其实就是这点已生产出来的。

再接着用它来进行攻击。因为我是在本地，我就用127。0。0。1。如果是远厂的话，你改成原厂的。好，接着我们来看一下啊啊我们登记之后看有没有这个东西。啊，看到没有？他自己会创建了一个tt123啊。

是吧一个这样的文件。当然对退索123这个文件里面想写什么内容，根据你自己的情况。后面关于这个工具方面，这个写一句话木码啊，两层下载，这个你自己去灵活运用啊，因为关键是看你这个地方。

你想执行什么命你就执行什么命令，在这里不再做太多的往去。关于这个机棒子这个呃呃这个。他的一个抓我这个法叙化这个漏洞呃。因为它是没有回显的哈，没有回响，就是远看攻击啊。

没有返回这个那什么一个回显的一个过程交互式的一个过程。所以在攻击的时候，首先就是要嗯设置好要知道对方的嗯最好微波封炉列沦写微波碎啊，要知道路径啊，各方面。那么在这里呢我。我们不再研究这方面啊。

我们只要这个漏洞的一个影响跟使用就行了。啊，关于一些参考的一些资料，在这里大家自己去认真去看一下啊。参考资料。好，关于这里，今天我们这节课大概就讲到这里啊，下节课再见。



![](img/1eb5cbf33f1ae29a20d9bbe2124a633d_5.png)

![](img/1eb5cbf33f1ae29a20d9bbe2124a633d_6.png)