# 经典15年i春秋渗透测试系统化教程 - P35：课时2 验证码各类方法突破分析 - 老网恋教父了 - BV1n54y1B7F7

好，我们接着讲解，我们现在把这个。按列一给大家讲解一下，就是验证码过期，没有及时销毁绘画，导致验证码重复复用啊复用啊。那么这个就是我们嗯前面讲到的啊，第五个方面就是说服当验证码，它没有去销毁当前的绘画。

那造成的这个漏洞。那么这个像这样的呃内容网上有大量的啊很多就是说没有去销毁。那么造成这个验证码复用。好，那么我们现在来看一下他这样的一种情况。那么这里的我就拉这个。待其漏啊PP这个接待系统给大家来演示。

那么这个系统这个官方站点也存在这个呃验证码验证码复用情况。嗯，因为当呃他就是建立的绘画跟金证马没有及时销毁，那么造成了这个就是说前端可以暴力破解啊，批量的暴力破解。



![](img/78e1fc22263a00c38af3c3edc1284188_1.png)

好，我们来看一下哈。嗯，那么首先我们打开BURP。

![](img/78e1fc22263a00c38af3c3edc1284188_3.png)

好。密码我随便输哈，嗯，那咱们换一个。换一个看得见那就用这个吧。嗯。YQZR。嗯，开启这个。好，等录一下，抓个包。哦，这个代理没有。



![](img/78e1fc22263a00c38af3c3edc1284188_5.png)

Yeah。密码我随便输一个。他这里漏洞比较多哈，这套系统你看它这个密码填写格式正格式正确，但还还有这还有这种情况。好，我们就来一下。Yeah。好，把这个包抓到之后啊。

我们发送到这个暴呃BORP的这个呃银骷里面，要暴力破解。

![](img/78e1fc22263a00c38af3c3edc1284188_7.png)

首先把它默认的这些变量把它删掉啊，可令。接着我们在这个，因为我们只针对当前的这个。呃，密码来进行暴力破解。他这个就是我们刚才输入这个验战码。啊，如果你想对用户名啊跟密码同时暴力破解的话啊。

那么你在这里选择最后一个。就是一嗯。多带多的形式。那么这里的话我为了演示的话呃，我就是一代多，就是说一个用户名，多个密码来进行暴力破解，只针对test一样这个用户来进行暴复。

那么念证码就是我刚才说的保持不变。那么呢我们就看这个内容是否存在。好，那么我在这个密码这个地方设置一个。嗯。



![](img/78e1fc22263a00c38af3c3edc1284188_9.png)

变量。啊，这个密码的话，随便拉top100里面，随便输入几个密码吧，我就是为了念战这个漏洞嘛。嗯，我再输入一个正确密码，看能不能。op不出来。好，我们来看一下效果。我们看数据包就行了哈啊。😊。

都是504，我们排一下排一下去。Yeah。如果数据包都一样的那是不行的。那么我们需要重新抓个吧，说明我们这个验证码这个地方有一点。小问题。这本身是他这个地方是错的。EAQ。0。Candy。加个吧。哎。

发错了。Include。Okay。我们排下去看有没有。

![](img/78e1fc22263a00c38af3c3edc1284188_11.png)

嗯，他这个地方好像有点问题。

![](img/78e1fc22263a00c38af3c3edc1284188_13.png)

![](img/78e1fc22263a00c38af3c3edc1284188_14.png)

Oh。你先把嗯他这个地方就是我们说验证码，他这个地方就有一点小问题。嗯，再试一下吧。

![](img/78e1fc22263a00c38af3c3edc1284188_16.png)

。

![](img/78e1fc22263a00c38af3c3edc1284188_18.png)

嗯，他这个漏洞确实存在哈。你来看一下效果。

![](img/78e1fc22263a00c38af3c3edc1284188_20.png)

K死。Okay。K一。う。哎，我操这个是一是什么，应该是一吧。一期吧，这个。一期啊应该是一期好，我们代理一下。没找到公啊。Okay。Yeah。你那我这个账号被封了吗？好，现在可以的。看下去啊。

我们在这里。看这个长度点一下就出来了排序。那么这个我们来看一下效果哈。那么这个你看啊呃这里所有的数据包，你看一下这它这里都是558的558是代表错误的这个啊错误的密码。

那么它唯一的一个啊唯一的一个是不一样的。那么这个我们一般的暴力配置看这个就行了啊。你点一下在这里点一下排序一下，那么你就知道如果它有一个不一样。那么它这个就是一个正确的密码啊，正确的密码。你看一下啊。

它这个558的返回的数据包啊，它这里可以看得到。

![](img/78e1fc22263a00c38af3c3edc1284188_22.png)

你再看一下559的。好，看这个看这个，你看559，它这的唯一是吧，状态就是正确的。你看它如果是错误的情况，它是这种情况消息不一样。消息不一样。那么这个就是我们它虽然是有念战码，但是我们。

我们并没有就是说。每次都要输入验证码吧，就我这么多密码，用同一个密同一个验证码。就可以同一个验证码也可以进行暴力破解。这就是说我们这个验证码，它这个官方上的一个验证码的一个漏洞啊。

一个漏洞可以进行嗯暴力破解啊这套系统。

![](img/78e1fc22263a00c38af3c3edc1284188_24.png)

呃，有关他这个网上的这个嗯。类似的一些情况特别多。你你看啊我们在个个里面，它这种太多了。

![](img/78e1fc22263a00c38af3c3edc1284188_26.png)

嗯，最好用购物百度给他。比较变态。他很多语法，就各个的语法在百度里面。用不了。所以我建议大家还是使用各个这个搜索引擎。你看他有很多后台地址，大家自己哎，怎么说了这么几个？应该是很多的呀。就是你找后台啊。

看这些后台有没有，就是说你可以进行。彩实的就是捏战码可以爆的破爆破的。

![](img/78e1fc22263a00c38af3c3edc1284188_28.png)

你看这一种哈，我举个例子，我们嗯再来测试一下哈，再测试一个。

![](img/78e1fc22263a00c38af3c3edc1284188_30.png)

如果不行的话啊，那那我们就上了。

![](img/78e1fc22263a00c38af3c3edc1284188_32.png)

![](img/78e1fc22263a00c38af3c3edc1284188_33.png)

他有些是客户端建站的，客户端建站，我等一下也如果运气好碰到的话嗯，就给大家说一下。

![](img/78e1fc22263a00c38af3c3edc1284188_35.png)

嗯，这里的话我们。用户名一般的是AM啊，管理员嘛，换密码的话，我不知道，那我随便说，对吧？DNPRAL像这种验证码可以识别的，有没有都无所谓。好。



![](img/78e1fc22263a00c38af3c3edc1284188_37.png)

因我。这搞错了。大底在窟窿还不行。

![](img/78e1fc22263a00c38af3c3edc1284188_39.png)

![](img/78e1fc22263a00c38af3c3edc1284188_40.png)

。我用的是火狐哈，所以这个。

![](img/78e1fc22263a00c38af3c3edc1284188_42.png)

Yeah。冰毛随便输。

![](img/78e1fc22263a00c38af3c3edc1284188_44.png)

Yeah。

![](img/78e1fc22263a00c38af3c3edc1284188_46.png)

CGWC4I。Yeah。

![](img/78e1fc22263a00c38af3c3edc1284188_48.png)

嗯。

![](img/78e1fc22263a00c38af3c3edc1284188_50.png)

![](img/78e1fc22263a00c38af3c3edc1284188_51.png)

好，抓取到了。

![](img/78e1fc22263a00c38af3c3edc1284188_53.png)

它这个跟那个跟刚才那个差不多一样方式它有的还还有一种情况，大家注意哈，本地验站的话，它有这种情况它是这种的。就我跟大家说一下啊，刚还一种情况是什么样子的，就这种。就是他这个验证码。

它这个就是说当你输入了验证码，你提交的时候，你加到的数据包是这种情况。就是它前面如果你发现前面这个验证码跟我们输入的验证码是一样的。那么它就是本地验证啊，本地验证验证码啊，这种情况就更好突破了。

只要就是说我们载入进来，看到这个在后面的验证码。就我把前面的念证码改上跟后面的一样。就假如BRP就可以暴力破解，因为它是本地的嘛，本地你要在嘛，只要他们两个人相同。那就可以爆爆破啊爆破。

所以说它这这个也是一个漏洞卡。所为大家会在真正这个工作中这个三个测试过程中会遇到各种稀奇古怪的一些情况，就是说你根据你自己的情况来进行判挡啊，方法判挡来进行测试。那么这里的话，我们把密码是一个变量。嗯。

我们我们随便找了一个账号，我说这个密码看有没有绕口令，让我们程试一下。哎呀，搞错了。うん。嗯，这些好，你来个top100。Yeah。好，我们来看一下啊数据包有没有。



![](img/78e1fc22263a00c38af3c3edc1284188_55.png)

啊，302一般是不行的。嗯，这个好像不行。嗯。

![](img/78e1fc22263a00c38af3c3edc1284188_57.png)

嗯，这种不行，啊这个不行。红什么事？经吧。有啊，你自己进来吧。我基本上以为。あけまし。Okay。就不看海面关，叫我来吃蘑菇。哦，这个不行，这个不行的话，我们就上来吧。大家自己回去之后。

自己在这个嗯各个里面随便找一些账吧。我这个账是一个锤是呃，他的官方站的一个。

![](img/78e1fc22263a00c38af3c3edc1284188_59.png)

嗯，采收地址。嗯。

![](img/78e1fc22263a00c38af3c3edc1284188_61.png)

那这节课我们就给大家讲到这里啊，下面一个案例啊。还有刚刚那教这个验战码10倍继续啊，进行测试。然后下节课我们再再讲。



![](img/78e1fc22263a00c38af3c3edc1284188_63.png)