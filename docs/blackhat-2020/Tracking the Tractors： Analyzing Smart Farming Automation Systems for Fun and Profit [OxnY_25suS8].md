# Tracking the Tractorsï¼š Analyzing Smart Farming Automation Systems for Fun and Profit [OxnY_25suS8]

So welcome to the talk tracking attractorsã€‚ Wellï¼Œ at least it's other art tracking attractorsã€‚

 but we came out somewhere completely differentlyã€‚ğŸ˜Šï¼ŒSo my name is Felixã€‚

 I'm here with a colleague Bianhardtã€‚ B is kind of my go to guy for everything Lola embeddedã€‚ğŸ˜Šã€‚

And to then together with a lot of O T pen testingã€‚ So we have pen testing stuff like PO Csï¼Œ H Msã€‚

 andï¼Œ for exampleï¼Œ sar systemsã€‚And quite to the contrary of this pictureã€‚

 we never to do anything farming or agriculture culture in generalã€‚ Howeverã€‚

 we have a friend or a cool researcherï¼Œ Sebastianã€‚ And one late evening after food runs of dartts and maybe some peerersã€‚

He told us basicallyï¼Œ heyï¼Œ if his friend is selling automation systems for projectorsã€‚

That can basically turn any tractor smartã€‚ And we were likeï¼Œ wï¼Œ you can automate the tractorã€‚

 And that got us into researching this topic a bit moreã€‚Wellã€‚

 it turns out digization in farming is a huge topic right nowã€‚

 Every aspect of modern day farming can be augmented withtization nowadaysã€‚ For exampleã€‚

 the most common augmentation you see nowadays is GPS card farmingã€‚

Which ranges from just having your GPS information off your field up to full automation of your tractor automatically driving on your fieldã€‚

And I always felt likeï¼Œ that's all crazy future Teã€‚

 I will never see anyone use this close to where I liveã€‚ Wellï¼Œ after we talk to some farmersã€‚

 turns out they're quite happy to adopt adopt these technologiesã€‚ğŸ˜Šï¼ŒAndï¼Œ for exampleã€‚

 one farmer even used the infrared drone to spot wildlife on his field before plowing the fieldã€‚

 So utilizationization in this field isã€‚Increasingã€‚But aside from activationisationã€‚

 we also have like active research in there because the tech surface of these componentsã€‚

 is becoming more connectedã€‚And most of the automotive research that's been done in this field is also like classic automotive researchã€‚

 like attacks on canvas or on E C Usã€‚But there's also somewhat more dedicated and specific research like they called the talk from sickles from sickickles on death Confertiã€‚

Where he showed that he was able to chainbreak a20 attractor and play doom on itã€‚

 which is the perfect P UCã€‚ğŸ˜Šï¼ŒAnd if you're interested in this talkï¼Œ also check out this talkã€‚

And asides from active researchersï¼Œ also active attacksï¼Œ likeï¼Œ for exampleã€‚

 a farmer in Switzerland could ransom thatã€‚But at Susan Brasomware was not his normal PCã€‚

 It was his milking robotã€‚And the system was also tasked with taking the vital values of the cowsã€‚

 So suddenlyï¼Œ nobody had any vital data of the cows anymoreã€‚

 and nobody noticed that the cow gets sickã€‚Which indirectly LED to a death of a carã€‚

 And that's probably one of the most unexpected impact of rents in Vertã€‚Okayã€‚

 so how does this automation workï¼Œ So you see hereï¼Œ this is like a two typical automation systemã€‚

 And on the right screenï¼Œ on the right side of the screenã€‚

 you see like this is like a steering systemã€‚ that's a post market solution that can help you to automate a tractor on the right sideã€‚

 you hear this see this is a demonstration set because we couldã€‚

 we couldn't fit the whole tractor in our labã€‚ğŸ˜Šï¼ŒAnd the whole setup consists of of a steering wheelã€‚

 a tablet on an HMI and a GPS antennaã€‚And it's not that expensive because like 5 to 10000 bucksã€‚

 which is very cheap compared to a new tractorï¼Œ which often starts of a quote of a million dollarsã€‚

 So I probably you can see why farmers like to use these systemsã€‚Andï¼Œ to getã€‚

 to give you a better understanding how the system integratedï¼Œ it's red out with forwardboardã€‚

 So you put on a tabletï¼Œ replace this thing will put on some sensorsã€‚



![](img/636c140212269d09d3c0fe4260e3716f_1.png)

![](img/636c140212269d09d3c0fe4260e3716f_2.png)

And then I could to goã€‚ So Danny have major tractors smartã€‚

And it works for all kinds of following machineryï¼Œ basicallyã€‚

You also can integrate stuff like the Plow or other additional hardware on the tractorã€‚

And the only thing then left to do is likeï¼Œ you still need to like define your fieldã€‚

 decide what kind of pattern you want to drive in the fieldã€‚

 And next time you go to your field with a tractorã€‚

 you can just hit play and automatically p your fieldï¼Œ for exampleã€‚

And that's quite powerful automationã€‚Soï¼Œ and before we started really researching these topics andã€‚

 and these different devicesï¼Œ we did some little market research to see which systems are more more commonã€‚

 And because we live in Central Europeï¼Œ we looked at the systems that are being sold in central Europe and the two dominant brandsã€‚

 The one is adynamics and the Alice Vi Viacmoã€‚ And if you look a bit more to the the eastã€‚

 you see in Russiaï¼Œ for exampleï¼Œ you see Navomoã€‚Which is a different vendorã€‚

 but has a similar systemã€‚ There are some other vendorsã€‚

 but these are like the system that's being sold the mostã€‚And we got our hands on us Fã€‚

 T T and in the react systemï¼Œ and turns outã€‚

![](img/636c140212269d09d3c0fe4260e3716f_4.png)

The other same systemã€‚Because like FG T is like building the systemsã€‚ And svakï¼Œ for exampleã€‚

 is just a rebrand of the same systemã€‚ And it was actually great news for us because we knew now we would not it does not only affect like one or two devicesã€‚

 It affects like as huge part of automation market for the systemsï¼Œ because like these are twoã€‚

 the two dominant brandsã€‚ğŸ˜Šï¼ŒAnd Bent will walk you through some of the mostpoã€‚Thank youï¼Œ Felixã€‚ Helloã€‚

 also from my sideã€‚ Let's begin with a rough overview of our 82 systemã€‚ We have two componentsã€‚

 three components hereã€‚ We have our 82 HMI tablebitã€‚

 which is basically the interface of the farmer from the cockpit cockpitã€‚

 We have our motor and our steering wheelï¼Œ and we have our GPS antenna on top of the tractorã€‚

 which gets the GPS coordinates from the satelliteã€‚ğŸ˜Šã€‚

communicates it then via H TP S and M Q T T to the cloud aserodynamic cloudï¼Œ which isã€‚

 which is situated in Chinaã€‚ You also have a Bluetooth con remote controller which you can use to remotely control your 82 tabletã€‚

M Q T T is a lightweight with messaging protocolï¼Œ which is commonly used in I T I O T productsã€‚

Where you can use for exchanging messages between different M2 clientssã€‚We are central brokerã€‚



![](img/636c140212269d09d3c0fe4260e3716f_6.png)

So immediate focus was to monitor toward the out trafficã€‚ we haveã€‚

The teleus encrypted M Q T pro connection hereã€‚ And what we have here is thatã€‚Tele is encryptedã€‚

Communicationã€‚é‚£ä¸ªã€‚å—¯ã€‚So butï¼Œ whatï¼Œ what we have here is encrypted traffic andã€‚Goodï¼Œ no problemã€‚ Likeã€‚

 is here it is like tele less crypto trafficã€‚ And we had the issue likeã€‚

 we wanted to see this traffic what's going on in thereã€‚ But since device was a rental deviceã€‚

 And we were likeï¼Œ wellï¼Œ we cannot likeï¼Œ modify itã€‚ so we have to give it backã€‚

 And we had the problemã€‚ We need to decrypt the trafficã€‚And so we did our common thingã€‚

 like we redirect traffic and verified if there would be something form of tele exploitpiitation issueã€‚

 because that would be the easiest thing without having to modify the system itselfã€‚And wellã€‚

 it turns outï¼Œ tele tele validationation isn't a thingã€‚

 And the just dot validate any kind of tele certificates in the systemã€‚

Which was great news for us because then we had access to the credentials of the client device to the brokerã€‚

ğŸ˜Šã€‚

![](img/636c140212269d09d3c0fe4260e3716f_8.png)

And here's the exampleã€‚ we just opened a raw net net Necut socket and redirected amplitude Q T traffic in thereã€‚

 So this is like a raw hex stamp of the amplitude Q T packetã€‚So you see here in the greenfieldã€‚

 this is a client I Dã€‚ This is like a user agent in Hï¼ŒD Pï¼Œ like arbitrary text fieldã€‚

 And at the bottomï¼Œ you see like in the blue fieldï¼Œ you see like the product name and the passwordã€‚

Really playing to the Pittsburghã€‚But like the really odd thing here is like the product didn'tã€‚

 the device didn't use theï¼Œ its serial numberã€‚ It's used the product with like 82ã€‚

 So it is all devices use the same usernameï¼Œ the same passwordã€‚Which is already a bit sketchyã€‚

But we will come to thisï¼Œ later onã€‚Wellï¼Œ and then we thoughtï¼Œ okayï¼Œ we use just M Q T exploreerã€‚

 a common clients to use this protocol and put in the passportã€‚

 put in the username and we could to goã€‚ Wellï¼Œ turns out didn't work becauseã€‚



![](img/636c140212269d09d3c0fe4260e3716f_10.png)

They are using a client tele certificate as wellã€‚ And that's one of the weirdest tele combinations I've ever seen because on the one handã€‚

 they have like no telespidationï¼Œ but they use a client tele certificate before usingname in a passportã€‚

ğŸ˜Šï¼ŒWellï¼Œ so our next task was basicallyï¼Œ we needed to extract the certificate for our authenticã€‚

And yeahï¼Œ we had two optionsï¼Œ either actually the whole application or at least the part that handles this a certificate applicationã€‚

 but it was obfuscatedã€‚Or use feedta insteadã€‚ Freeta is a really cool tool for all kinds of dynamic binary instrumentationã€‚

 So we use that tool as custom script to dump all kinds of T S secrets from the applicationã€‚ğŸ˜Šã€‚

And with thatï¼Œ we got our Taylor client certificateã€‚So now we were able to access the brokerã€‚

 So we were now able to access the cloud structure and see what kind of messages are being sent to the brokerã€‚

 And you see hereï¼Œ for exampleï¼Œ in this in the screenshotï¼Œ especially in this red areaï¼Œ you seeã€‚

 for exampleï¼Œ the system sends its GPS coordinates to a broker and to notifyï¼Œ heyã€‚

 I have moved and then updates the map of the systemã€‚ğŸ˜Šã€‚



![](img/636c140212269d09d3c0fe4260e3716f_12.png)

And on this brokerï¼Œ allï¼Œ all kinds of different topicsã€‚ Likeï¼Œ for exampleï¼Œ we have topics forã€‚

 for opt of of positionã€‚ For exampleï¼Œ if the vehicle parameter changesï¼Œ for exampleã€‚

 if the farmer puts on a different system or different hardware on the tractorã€‚And alsoã€‚

 the function invoke functionã€‚Whi' is kind of interesting because this has exposed a lot of different functionsã€‚



![](img/636c140212269d09d3c0fe4260e3716f_14.png)

But the thing is nowï¼Œ we did this research over a yearã€‚ And within this yearã€‚

 the infrastructure changedã€‚ So initiallyï¼Œ it was way weaker because the initial was just the username and aesthetic password for all of the of the devicesã€‚

The password was just just two Charlessï¼Œ two charactersã€‚ andï¼Œ yeahã€‚

 and the number 2020 for password for all of the productsã€‚Wellï¼Œ they changed that toã€‚

 to a sales registration serviceã€‚ So all devices now registered as the broker with a custom password and a custom usernameã€‚

 Howeverï¼Œ that was good news for us because it was like initially we only had access to like the European broker because we had only a European deviceã€‚

ğŸ˜Šï¼ŒBut with thatï¼Œ we could suddenly retreat on all kinds of broker they had in different regionsã€‚

 So we were now able to access like data in the USï¼Œ data in China and dataï¼Œ for exampleï¼Œ in Russiaã€‚



![](img/636c140212269d09d3c0fe4260e3716f_16.png)

Okayï¼Œ but then we thought likeï¼Œ what can we do nowï¼Œ So we tested different test casesã€‚ Likeã€‚

 we tested what happens if we use like an extractor doesn't existã€‚ The system just accepts itã€‚

 You can log in with a password and a username and a serial numberï¼Œ which doesn't exist at allã€‚

 So it only depends on the on the passwordã€‚ You give yourselfã€‚ And then you can just sayï¼Œ heyã€‚

 on this deviceã€‚ And it saysï¼Œ you're fineã€‚Alsoï¼Œ we can also try to to impersonate different tractorsã€‚

 Likeï¼Œ for exampleï¼Œ we knew fromï¼Œ from our friend that there are different serial numbers for different tractorsã€‚

 We had some of theseã€‚ We tried them and they broke itã€‚ Okayã€‚

 you can log in and just imp person at another tractorã€‚Butï¼Œ in factï¼Œ thenã€‚

 if you can imp personate one tractorï¼Œ why not impersonsonate all of themã€‚



![](img/636c140212269d09d3c0fe4260e3716f_18.png)

Wellï¼Œ it turns out two characters did the trickã€‚This is an amplitudeput multile wild cardã€‚

 which basically just tellsï¼Œ heyï¼Œ brokerï¼Œ I want to have all the topics and all the messages nowã€‚

And the broker was likeï¼Œ okayã€‚

![](img/636c140212269d09d3c0fe4260e3716f_20.png)

And so we suddenly had like a lot of data there and like access to thousands of devices that were connected to this brokerã€‚

ğŸ˜Šï¼ŒAnd for exampleï¼Œ in the red areaï¼Œ Cï¼Œ for exampleã€‚

 there are 600 tractors connected with 80000 of 80000 messagesã€‚

 This was just if you open it for 50 secondsã€‚

![](img/636c140212269d09d3c0fe4260e3716f_22.png)

So it's a lot of dataã€‚And it was so much data that we had realï¼Œ real issues with thatã€‚

 because suddenlyï¼Œ our system started crashing because it ran off out of memory because we got so much N T traffic inã€‚

 in thereã€‚ğŸ˜Šï¼ŒSo we had to build a custom tool for thisã€‚ So we called it a taactal hackneyã€‚

Which basicallyï¼Œ yeahï¼Œ the name says itselfã€‚ It just takes all that amplitude dator and just ingests itã€‚

 And we had to likeï¼Œ handle like 100 K messages per secondã€‚

So it was custom some engineering that we had to do to get this to workã€‚

And here's a little architectureã€‚ So we have like all the extractors that are connected to their local cloud brokerã€‚

 and then we use our t car to connect to this broker and just get all dataã€‚

And because like they had the self and shut serviceï¼Œ we not have access to all of these brokers nowã€‚



![](img/636c140212269d09d3c0fe4260e3716f_24.png)

Wellï¼Œ and since we exit to the dataï¼Œ we could do the synmon in analysis nowã€‚

 So over the time of a few monthsï¼Œ we saw like 40 casesï¼Œ440000 systemsï¼Œ roundaboutã€‚

 And most of the systems operate in Asia because like like it's the Chinese vendorã€‚ So wellã€‚

 that's the product where' being sold the mostã€‚ But in second placeï¼Œ we have the European Unionã€‚

 where they have like 50ï¼Œ5000 of these systemsã€‚And in the USã€‚

 there are just 300 of the systems being sold so farã€‚



![](img/636c140212269d09d3c0fe4260e3716f_26.png)

And the data we see is likeï¼Œ we see all kinds of different GPS dataã€‚

 So we know what what the farmer is doing at each of them of each of his daily operationsã€‚

 We know where he livesï¼Œ which feels he tends toï¼Œ what peer addresses he usesã€‚

 and also sometimes what email addresses to useã€‚ if theyï¼Œ for exampleï¼Œ share a field with each otherã€‚

So there's all kinds of privacy data in thereã€‚But we also have like visualized pit ofã€‚

 And see here in the in the USã€‚ You seeï¼Œ for exampleï¼Œ these areã€‚

 they are driving everywhere in the in the United Statesã€‚And also in different statesã€‚

 And on the leftï¼Œ you see like example that zoomed in a bit where seeï¼Œ for exampleï¼Œ theyreã€‚

 they're using the system also on public roadsã€‚ So it's not like theyre traffic actively with their of the systemã€‚

 but they are just not properly turning it offã€‚ So it is also used on public roads as wellã€‚

And the Bi cl statesï¼Œ you have to turn this off if you drive on a public roadã€‚

 But based on the GPS state that we know that farmers are not doing thisã€‚ So theyã€‚

 they do not drive active eistsï¼Œ They just don not properly powered offã€‚Okayã€‚

 but then we started looking at where to see tractorsã€‚ And weã€‚

 we said these tractors in some crazy placesã€‚ For exampleã€‚

 one of them was 20 km away from the frontland in Ukraineã€‚ğŸ˜Šï¼ŒAnd about 3 in the morningã€‚

So you also seeï¼Œ like this has all kinds of implications that we saw now suddenly can track tractors all around the worldã€‚

 We also saw a tractor that was like close to North Koreaï¼Œ for exampleï¼Œ that drove in South Koreaã€‚

And yeahï¼Œ so we had a lot of fun at looking at tractorsã€‚And what they're doingã€‚And we alsoã€‚

 for exampleï¼Œ saw some interesting pets because we saw like when tractors are driving closer to Ukraineã€‚

 we suddenly saw them cling out sometimesã€‚ And we think this was GPS chaming because suddenly they were all over the placeã€‚

ğŸ˜Šï¼ŒOkayï¼Œ but this was just what we could do with passive reading the dataã€‚

 But what if what if is just send some data to the tractorsã€‚

 And the thing is like the the command that you can send to the tractor is quite limitedã€‚

 So you have like only some commands you can say send to themã€‚ But these are the commandsã€‚

 lock and send notã€‚So the lock basically locks the deviceï¼Œ and you can no longer operate itã€‚

 So the tractor is no longer inï¼Œ in the tractor is operating normallyã€‚

 but the automation is completely goneã€‚And you can spend the notificationsã€‚

 So you really annoyed them and sent themï¼Œ for exampleï¼Œ some messagesã€‚And the problem is likeã€‚

 the broker has no proper authorizationã€‚ so every tractor can send a notification to every other tractorã€‚



![](img/636c140212269d09d3c0fe4260e3716f_28.png)

And we have a short demo video for thisã€‚Where you see that the system is just a normal operation and the driver and is just in running in a own modelã€‚

 So it's operating on a normal fieldã€‚

![](img/636c140212269d09d3c0fe4260e3716f_30.png)

And suddenlyï¼Œ you see a pop up message attractivetract will locked nowã€‚

 You can specify whatever you wantã€‚And it's goneã€‚Andã€‚That willã€‚

 that that will be possible for all attractors that are connected to the systemã€‚ So suddenlyã€‚

 all of the systems would be doneã€‚And like only the vendor can restore the systemã€‚

 So only then every farmer has to call the vendor to unlock thisã€‚

 But the attacker could also spend this command againï¼Œ and then you're locked againã€‚

So the broker has some reallyã€‚Wild vulabilitiesã€‚Butã€‚

We also thought like the systems I was used in public roadsã€‚ What if we can hack the steering wheelã€‚

 What if we can take over the steering wheelã€‚ And likeï¼Œ for exampleï¼Œ drive the tract on a ditchã€‚

 for exampleï¼Œ do a hardware to0 at some pointã€‚ and suddenly it goes off the roadã€‚

So we started researching a bit more how the steering system itself worksã€‚

And the steering system consists of all of HMIï¼Œ a steering a steering wheel and some GPS sensorsã€‚

And the HMI itself is just an Android tabletã€‚ Howeverï¼Œ the vendor did lock it down a bitã€‚

 So it's not justï¼Œ you're not just able to launch any appï¼Œ but it'sã€‚

Only launches the default app of the vendorã€‚But it didn't implement it lockdown properlyã€‚ So likeã€‚

 you were able to get your system settings enabled Aï¼Œ8P accessã€‚

 And then you had like at least some shell accessã€‚And in normal Androidsã€‚

 you now would need to line some exploits to get full route accessã€‚Butï¼Œ wellã€‚

 this was not a normal Androidï¼Œ because it turns outã€‚



![](img/636c140212269d09d3c0fe4260e3716f_32.png)

The device mostly routeedã€‚And because it took us like basically five minutes through the deviceã€‚

 So we had it on the tableï¼Œ started itï¼Œ clicked toï¼Œ the userscapeï¼Œ connected USBCã€‚

 Then we had route accessã€‚Because the vendor needed root access for his own codeã€‚

 And we looked at the code and was wonderingï¼Œ whyï¼Œ why do they use the route access anywayã€‚Wellã€‚

 turns out they were kind of lazy when it comes to security features because they did not implement a proper authorization mechanism for accessing other devices within Androidã€‚

 So they had like subsystems in thereã€‚ They were just raw serial devices in Androidã€‚

 And to access themï¼Œ youï¼Œ youï¼Œ you would have need a decent permission system in place toã€‚

To a proper office authorã€‚ But they did they just dropped S U S U S U S U binary and then executed their own codeã€‚

Wellï¼Œ but this was good news for usã€‚ So we had route access at the Android systemã€‚ğŸ˜Šã€‚

But we wanted to do thisï¼Œ also remotelyã€‚

![](img/636c140212269d09d3c0fe4260e3716f_34.png)

And that's where we had kept hitting a lot of dead endsã€‚ So we tried a lot of thingsã€‚ We triedã€‚

 for exampleï¼Œ to send Melisa messages via the broker to get some form of coecã€‚Howeverã€‚

 the command that you can send from from the broker is quite limitedã€‚

 and it also lands only in safe travel codesï¼Œ which is wasã€‚

 which was what vulnerable for any kinds of memory corruption or other issuesã€‚

We also tried for via via a networkã€‚ For exampleï¼Œ Does it have any services exposedï¼Œ No it does notã€‚

 It has no services exposedã€‚So that left us with the following free attack vectorsã€‚

So with physical accessï¼Œ we can just route itï¼Œ but it'sã€‚

 does not so create a tech vector because then we need physical access to the deviceã€‚

 The next thing is R C via Bluetoothã€‚The system itself is so outdated that it is vulnerable to some well known Android Bluetooth vulnerabilitiesã€‚

 And they are public experts for thisã€‚Howeverï¼Œ it's like you have to be Plutth purchasing chasing for thisã€‚

 Plutth has to be enabled and the export crashes crashes to the system more often than it gives your shellã€‚

ğŸ˜Šï¼ŒSoï¼Œ not the best wayã€‚And then we started looking into something that we can man in the middle and just replace the response from the server to the client that could trigger costic execution on the the on the HMI itselfã€‚

And that's where it struckholdã€‚ because what better feature is than than the over output featureã€‚



![](img/636c140212269d09d3c0fe4260e3716f_36.png)

And for some reasonï¼Œ the vendor really dropped the ball on this one because likeã€‚

 they didn't have like transport encryption for thisã€‚

 and they did not have like any form of validation or signature for thisã€‚Normallyã€‚

 when you have some form of fiberr update or over the updateã€‚

 you have some form of strong esymmetric signature that protects you from tampering with the imageã€‚

And in this caseï¼Œ they just use M5 sunã€‚ Soï¼Œ wellã€‚I guess we can calculate thatã€‚

And on the right side of the screenï¼Œ you see likeï¼Œ this is a typical requestã€‚ You hear it sayï¼Œ heyã€‚

 it's time to updateã€‚ We are updating to version 25ã€‚ And this is the URL you need to downloadã€‚

And that's like a textbook example for drive by downloadã€‚ So if you're in the middleã€‚

 you can just replace this with any kind of binary you wantã€‚And because the device is a pre routeedã€‚

 This leads to a full rootï¼Œ root code executionã€‚Wellï¼Œ but man in the middle is always hard to getã€‚

 You have to be to get adjacentã€‚ It doesn't scale wellã€‚That's trueã€‚ And it doesn't scale well for usã€‚

 but it's well documented asï¼Œ for exampleï¼Œ nations that actors or advanced threat groups are capable of performing men military attackss on Internet connectionsã€‚

So while we cannot exploit the v at scaleï¼Œ they probably couldã€‚Okayã€‚

 so the ta itself is quite simpleã€‚ You become in the middleã€‚ You replace the responseã€‚ For exampleã€‚

 in this caseï¼Œ you just replace it with a custom URLã€‚And you have to calculate M5 sumã€‚

Replace the code with0 at the bottomã€‚ That's importantã€‚ But the or the client doesn't takeã€‚Theã€‚

 the final optã€‚And alsoï¼Œ you have the possibility to add a custom message like say total another virusã€‚

 trust me I a dolphinã€‚Okayï¼Œ so if you do thisï¼Œ then a user created up by this delightful dialogueã€‚ğŸ˜Šã€‚



![](img/636c140212269d09d3c0fe4260e3716f_38.png)

And if the farmer saysï¼Œ ohï¼Œ the status instance is legit and accepts itï¼Œ we get full root accessã€‚Mã€‚

 this is like a funny exampleï¼Œ but a real tech could use as something more malicious or something that triggers take Kos symbolbolic and social engineering to get the the farmer to install the systemã€‚

ğŸ˜Šï¼ŒOr the updateã€‚

![](img/636c140212269d09d3c0fe4260e3716f_40.png)

And as a P O Cï¼Œ for exampleï¼Œ we use the metapreta just as a simple P O Cã€‚

 And you see here that the A P K is being downloadedre from Webã€‚

 and then the meta Cta session startedã€‚So it's quite easy to route this device also remotelyã€‚



![](img/636c140212269d09d3c0fe4260e3716f_42.png)

And because it's already routedï¼Œ we have already rooted accessã€‚So at this pointã€‚

 we had like full route access via a networkã€‚But the thing isã€‚

 it was still a long way to go to the steering system because the steering system itself consists of multiple componentsã€‚

You have like this Android tabletï¼Œ and then you have like a EC C Uã€‚

 which is an embeddedella device withï¼Œ withï¼Œ which takes multiple inputs fromï¼Œ for exampleã€‚

 the Android tablet and the IM Uã€‚ the IM U is like orientation sensor to know how level the tractor isã€‚

Andã€‚To goï¼Œ the E combines its inputs and then makes a steering decisionï¼Œ whichã€‚

 which is then send to the motor control unitï¼Œ the M Uã€‚

 And then the M C U is a real device that turns the steering wheelã€‚Yeahã€‚

 so our next task was was the techctic issueã€‚Howeverï¼Œ this was a rental deviceã€‚ So normally weã€‚

 we would like open it up it just attach Jtch to it or get some form of flash dump to do some form of analysis on itã€‚

But this was an option for usã€‚ So we had only option was either to direct flashã€‚

The farmer we the Android tabletã€‚Or reverseary a protocol is still being used for steeringã€‚

And so we played it safeã€‚And we reverse into the protocolã€‚Yeahã€‚

 but that took us some time because like the P was just 200 k of raw arm assemblyï¼Œ no symbolsã€‚

 no stringsï¼Œ or anythingã€‚ We didn't know it takes exact specification processingã€‚

 and we did not know what kind of operating system was used in thereã€‚

So our strategy basically was to look for some function that has a high density of condition statements and a high density of magic bysã€‚

 because that's typically how packet handler looks likeã€‚And at some pointã€‚

 we found a function that basically specified how a protocol looks like andã€‚

We reverse it the the sub functionï¼Œ cleanï¼Œ clean up the codeã€‚

 And we came up with the following protocols specã€‚So here you see what kind of commands possibly be with steering systemã€‚

At least we think these these are the correct commandsã€‚ But on the right sideã€‚

 you see the different packets or the packet structureã€‚

 And you see the packet always starts with E C 91ï¼Œ has some headersã€‚

And the most important byte is like the byte 16ã€‚ So because the byte 16 is the command byteã€‚

 it basically tells thisï¼Œ the steering system what kind of command you're sendingã€‚And for exampleã€‚

 this is a waypoint configuration commandï¼Œ which basically specifies that you're driving from point A to point Bã€‚

 So after the command byï¼Œ you have like theï¼Œ the command payloadã€‚

 which is when give this case for float values for two times latitude and longitudeã€‚

And the important thing isï¼Œ likeã€‚It's not just enough toï¼Œ to send a command like turn left or rightã€‚

 because that's impossibleã€‚ You have to specify like a certain route to sayï¼Œ heyã€‚

 we're driving from point A to point B to point Cã€‚ And then the E C U decides how to reach that pointã€‚

 So the system itself has no direct control over steering wheelã€‚So if you wouldï¼Œ for exampleã€‚

 want to create a PUC where we hijack the steering wheel and just do a left or right oneã€‚

 we have like to calculate a 90 degree angle to our current positionã€‚To makeï¼Œ for exampleã€‚

 a heart rate1ã€‚Okayï¼Œ so with the protocol specification nowã€‚

 we were close to taking over steering wheel because we still needed one thingã€‚

 And that was the correct communication flowã€‚ğŸ˜Šï¼ŒBecause it turns out you need multiple packets toã€‚

 to a steering wheelï¼Œ because you need at oneï¼Œ you need a heartbeat to the E Uã€‚ because if youã€‚

 if you stop the heartbeatï¼Œ the E U shuts downï¼Œ you need to specify waypointã€‚ forï¼Œ for exampleã€‚

 the configuration that tails the steering system to to drive point A to point Bã€‚

 specify some configuration parameters and then and execution commandã€‚

But then you go to go after you send these types of commandsï¼Œ the steer wheel starts turningã€‚

If you want a full PC attackerï¼Œ you still need to be aware that you have to stop the originalal app or it will interfere with the steeringã€‚



![](img/636c140212269d09d3c0fe4260e3716f_44.png)

Okayï¼Œ and we put all this together in this demonstrationã€‚



![](img/636c140212269d09d3c0fe4260e3716f_46.png)

And hereï¼Œ for exampleï¼Œ the system is just an operationã€‚ It's in passive modeã€‚ Likeï¼Œ for exampleã€‚

 some people use it on public roadsã€‚ It's justï¼Œ you can just normally use the tractorã€‚

 but it is where the prelude byteerã€‚ and it just can flip the switchã€‚Ant steering is skullã€‚

Then you have full controller of steer wheelã€‚And the problem isï¼Œ likeã€‚

 the steering motor is quite strongã€‚ So you have now two optionsã€‚

 Either you start fighting with the steering wheel over controlã€‚

Or you're quick enough to turn the system offã€‚But this basically takes a split second to drive the tract on a ditch or lead to a tilt overã€‚

Soï¼Œ good luck with itã€‚Okayï¼Œ but in beginningï¼Œ were told likeã€‚We ended up somewhere a differentlyã€‚

 And turns out that the vendor also has a lot of other devices connected with a brokerã€‚

And at some pointï¼Œ we saw like a call that's a function call that called Take photoã€‚

 And we were likeï¼Œ what's going on hereï¼Œ Whyï¼Œ whatï¼Œ whatã€‚

 who's taking a picture and why is taking a tractor a pictureã€‚Wellï¼Œ turns out it wasn't attractorã€‚

 It was a lot moreã€‚That the same window is buildingã€‚

 but is connected to the same broken cloud in structureã€‚And how this lawn mo operateã€‚

 they basically just take a picture of the cameraï¼Œ upload it to a cloud pocketã€‚

 and then you send a cloud pocket URL via the brokerã€‚ And because we were listening on a brokerã€‚

 we saw like the URLs to these cloud pocket picturesã€‚And normally when you have cloud packetsã€‚

 there would be some form of signatureï¼Œ some form of token that protects you from just so you cannot just download the pictures from thereã€‚

Wellï¼Œ the man of a quote also for that quote also about thisã€‚So suddenlyã€‚

 we had like full access to camera feeds around the world from multiple from lawn mos across different continentsã€‚

And likeï¼Œ we have a whole selection of video feeds from different lawnlorsï¼Œ suddenlyã€‚Wellã€‚

 talking about scope Cã€‚

![](img/636c140212269d09d3c0fe4260e3716f_48.png)

Okayï¼Œ here also shot demo photosã€‚And here you seeï¼Œ for exampleï¼Œ different lawnmas in the leftã€‚

 you see like a soccer field and some stadiumã€‚And this is just a short snippetã€‚

 But we had like access to a lot of different of these video feedï¼Œ suddenlyã€‚Yeahã€‚

 it's it was also quite also quite interesting to watch what what all these tracks what long was are doingã€‚

Okayï¼Œ but devils are the craziest partã€‚We also saw something differentã€‚ We saw likeï¼Œ at some pointã€‚

 we saw like a device called open open doorï¼Œ call elevatorï¼Œ closed door and open door againã€‚

 We're likeï¼Œ what's going on hereã€‚Wellï¼Œ turns out the the is also some building some different platforms as wellã€‚

 They are like also building automation robots that are able to likeï¼Œ take the elevator and driveã€‚

 for exampleï¼Œ from point A to point B and also open doorsã€‚ğŸ˜Šï¼ŒYou might have seen thisï¼Œ for exampleã€‚

 in pars or in hotels where suddenly you can call an elevator robot and it will drive up to your to your floor and show you some drinksã€‚

 for exampleã€‚And the thing is likeï¼Œ we were a brokerï¼Œ and we were able to do the same callsã€‚

And we was were interestedã€‚ Maybe weï¼Œ we couldï¼Œ we could try this courseã€‚

 but we didn't do this because we like to toï¼Œ we didn't own the hardwareã€‚

 So we didn't want to interfere with some operationsã€‚

But we are quite confident that we would be able to just replay these calls and call an elevator and call an open door somewhere elseã€‚

ğŸ˜Šã€‚

![](img/636c140212269d09d3c0fe4260e3716f_50.png)

And this is alsoï¼Œ for exampleï¼Œ how the vendor sell the systemã€‚

 So it has like the integration betweenï¼Œ for exampleï¼Œ an elevator and a robotã€‚

 And you can just use thisã€‚To open doors and call an elevatorã€‚

 And that will be probably one of the most unexpected red timingming strategies everã€‚ If youã€‚

 for exampleï¼Œ heed like this to robot and suddenly you get access to a door or to an elevatorã€‚Okayã€‚

 so what does Daendo say about thisï¼Ÿ Wellï¼Œ we have been talking to the vendor for over a year now reported this last year in Juneã€‚

 And the communication was a bit trickyã€‚ At some pointï¼Œ Dawenda took a little breakã€‚ And in Mayã€‚

 he came back and saidï¼Œ yeahï¼Œ everything is fixedã€‚ğŸ˜Šï¼ŒBut we don't know what they fixedã€‚

 They didn't fix the security issuesã€‚And two weeks before Blackhead suddenlyã€‚

 the CEO noticed that there's something going onã€‚ and we got in touch with the CEO of the companyã€‚

 And turns out there was some internal miscommunication and the security issues have not been properly communicated with an organizationã€‚

 and they are currently still mitigating these issuesã€‚Okayã€‚

 so let's close out to the lessons learnedã€‚Okayï¼Œ so digization inï¼Œ in air culture is a huge topicã€‚

 And you see a lot of new technology being fielded thereã€‚

 And there's a lot of research potential there to be tested and to beã€‚To be heedã€‚Alsoã€‚

 from our personal experienceï¼Œ security awareness in this field is not that highã€‚

 So especially when it comes to users and sometimes the vendorsã€‚

 they don care about cyber security or the issues to introduce with introducing these technologiesã€‚

And alsoï¼Œ agriculture is at large scaleï¼Œ also created infrastructureã€‚ So this should liveã€‚

 this technology should live up toï¼Œ should live up to a higher standardã€‚



![](img/636c140212269d09d3c0fe4260e3716f_52.png)

Okayï¼Œ so that was it for the talkã€‚ I would like to kick off the Q And A sessionã€‚

 and I would like to answer the most important question firstã€‚



![](img/636c140212269d09d3c0fe4260e3716f_54.png)

Does it run tombã€‚ Yesï¼Œ it doesã€‚ğŸ‘Firstã€‚So wes a vendor here today to listen toã€‚The question wasã€‚

 iss the vendor hereã€‚ we don't knowã€‚ I don't think soã€‚ also we don't knowã€‚

They have some mitigations in placeï¼Œ but we haven't had the time to test them because were like two weeks before blackheadsã€‚

 Soï¼Œ they theyï¼Œ we had some emails correspondenceã€‚ They they sayï¼Œ heyï¼Œ they fixed itï¼Œ butã€‚

We don't flowã€‚But the thing is likeï¼Œ it's not just they have to fix thatã€‚

 They also have to like upgrade all the farmers for thisã€‚ And yeahï¼Œ they have to callï¼Œ wellã€‚

 this probably take them some time to upgrade all these devicesã€‚Did I get it rightã€‚

 The the steering wheel had also Bluetooth controllerã€‚

 And did you look into communication between this Bluetooth controller and the steering wheelã€‚ Yeahã€‚

 we that also weï¼Œ we we took a look at this becauseï¼Œ but thenã€‚

 but this is just standard Android Bluetooth interfaceã€‚

So some farmers use this as as a remote remote steering controller for thisï¼Œ likeï¼Œ like a remoteã€‚

And it just connects to the Android and just inputs someï¼Œ some normal inputs like a keyboardã€‚

 for exampleã€‚ So it's just standard Android Bluetoothtã€‚Okayï¼Œ soï¼Œ so it just acted as a heat keyboardã€‚

 rightï¼Ÿ Yeahï¼Œ it is exï¼Œ similar to keyboardã€‚Let's pleaseã€‚Yeahã€‚æˆ‘ã€‚ã®ã¯ã€‚The question wasã€‚

 if you could really refine the the steer wheel controlã€‚å•Šã€‚In theoryï¼Œ we would have been ableã€‚ But PCã€‚

 we just used topointï¼Œ so we basically can specify a point to drive from A to Bã€‚

 And then we will have to calculate what kind of route we want to driveã€‚

 So we're quite close to doing a full control over the steering wheelï¼Œ but we never implemented thisã€‚

Yesï¼Œ pleaseã€‚What functionality is the MQTT brokerï¼ŸProvide the systemã€‚ä¿¾æˆ‘å“‹å•Šä½ ã€‚Yesã€‚Yeahã€‚

 that's interesting because there's also some other platforms that are integrated with this dataã€‚

 They likeï¼Œ they have a fleet management software where you can track the dataã€‚But it's alsoã€‚

 it's also forï¼Œ for tracking what kind of operations you did on a fieldã€‚

 you can drive the tractor offline as well if you have the the maps offlineã€‚ So it's notã€‚

 it's not mandatory to use this every timeï¼Œ but it's used by most of these farmers to like have the data on your fields of your fieldsã€‚

The farm goodã€‚Access to youã€‚The other can partially for So they have to synchronize the mapsã€‚

 But if they did thisï¼Œ then they can use this in offline modeã€‚Okayï¼Œ I think that's itã€‚

 Lets say thank you andã€‚è¿™æœ‰ã€‚