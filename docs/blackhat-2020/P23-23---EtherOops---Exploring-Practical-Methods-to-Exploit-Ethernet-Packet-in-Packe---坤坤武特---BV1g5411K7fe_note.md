# P23：23 - EtherOops - 探索利用以太网数据包内数据包攻击的实用方法 - 坤坤武特 - BV1g5411K7fe

![](img/7bb22dc3b1f5fb3ed64ff957859d006a_1.png)

![](img/7bb22dc3b1f5fb3ed64ff957859d006a_2.png)

[MUSIC]。

![](img/7bb22dc3b1f5fb3ed64ff957859d006a_1.png)

![](img/7bb22dc3b1f5fb3ed64ff957859d006a_2.png)

## 概述

在本节课中，我们将探讨一种名为“数据包内数据包”的攻击方法，它允许攻击者绕过网络和防火墙等安全措施。

## 动机

许多零点击远程代码执行漏洞都需要攻击者与受害者设备之间存在某种网络邻近性，例如直接路由或跨层路由。然而，某些超级漏洞，如CDPON和Urgent 11，甚至可以在攻击者能够从其网络向受害者设备发送完全受控的数据包的情况下，仅通过单个数据包进行利用。

## 攻击场景

攻击者位于防火墙后面，目标是将其两个数据包注入内部子网。这些数据包被注入到防火墙边缘的左侧网络段，该网络段位于防火墙的内部。

## 数据包内数据包攻击

数据包内数据包攻击的概念是，攻击者将恶意数据包封装在合法数据包中，使其在通过防火墙时被接受。当数据包到达目标网络时，恶意数据包被解封装并执行。

## 以太网物理属性

以太网使用铜缆，这些铜缆使用空闲快速以太网，其速率为100兆比特或千兆以太网。这两种文件在物理层上具有不同的编码方式。

![](img/7bb22dc3b1f5fb3ed64ff957859d006a_4.png)

![](img/7bb22dc3b1f5fb3ed64ff957859d006a_6.png)

![](img/7bb22dc3b1f5fb3ed64ff957859d006a_8.png)

## 攻击方法

攻击者可以通过以下方式实现数据包内数据包攻击：

1. 在数据包中插入一个特殊的序列号，该序列号会导致接收器将其解释为新的数据包。
2. 计算原始数据包的CRC32校验和，并将其与新的数据包的CRC32校验和进行比较，以确保攻击成功。

## 攻击示例

![](img/7bb22dc3b1f5fb3ed64ff957859d006a_10.png)

以下是一个攻击示例，其中攻击者使用数据包内数据包攻击来注入IPv6路由器广告（RA）数据包：

1. 攻击者将IPv6 RA数据包封装在UDP数据包中。
2. 攻击者将UDP数据包发送到受害者设备。
3. 当UDP数据包到达受害者设备时，数据包内数据包攻击导致IPv6 RA数据包被解封装并执行。
4. IPv6 RA数据包配置了受害者的IPv6路由表、DNS服务器和搜索域。

## 总结

本节课中，我们探讨了数据包内数据包攻击的概念、攻击方法和攻击示例。这种攻击方法可以绕过网络和防火墙等安全措施，因此需要采取适当的预防措施来防止其利用。