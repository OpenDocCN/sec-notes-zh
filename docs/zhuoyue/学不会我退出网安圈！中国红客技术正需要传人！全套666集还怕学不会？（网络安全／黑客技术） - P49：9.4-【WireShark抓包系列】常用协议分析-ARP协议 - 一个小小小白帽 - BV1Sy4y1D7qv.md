# 学不会我退出网安圈！中国红客技术正需要传人！全套666集还怕学不会？（网络安全／黑客技术） - P49：9.4-【WireShark抓包系列】常用协议分析-ARP协议 - 一个小小小白帽 - BV1Sy4y1D7qv

好下面呢我们来讲一下使用visuck啊，对常用协议啊抓包并分析原理啊，那么在进行协议分析的时候呢，我们来关闭一下混淆模式，那避免一些干扰的数据包的存在，好吧，那么首先呢我们来看常用协议分析arp协议。

那么什么是a r p协议呢，也叫地址解析协议啊，那么它是一个通过解析网络层地址来寻找对吧，数据链路层地址的一个网络传输协议啊，那么它的在i p v4 中啊极其重要。

a r p也是通过网络地址来定位什么mark地址啊，这么一个过程啊，这有解析过程，他主要负责将什么ip地址解析成mac地址，那下面呢我们来开始啊，抓包啊，我们先来过滤一下的啊，来先把这个混杂模式啊去掉。

好开始，然后这里呢我们过滤一下，只来抓a arp协议的数据包好吧，然后重新抓取一下的好的，那么如何能产生一个arp数据包啊对啊，这里头，那么我们可以通过nmap来基于a r p协议，来进行了吗。

扫描我们在ky打开终端。

![](img/d4a43e8fcd39a0d4e8996dbfd176bd56_1.png)

nmap杠小sn啊，那么小s n z参数啥，只拼扫不扫描端口对吧，那么我们来扫描一下网关。

![](img/d4a43e8fcd39a0d4e8996dbfd176bd56_3.png)

好的，然后呢回头我们看这里呢，我们就抓到了arp数据包好吧，那么我们来看一下我们抓取到的数据包啊，分析来第一个请求包啊，第一个请求包，那么第一个解决包是什么意思啊，对啊，那么这个是谁发出的这个位面啊。

这个是啥ky啊，kelly 7 f d a7 b那发出去谁知道对，这个是我看一下啊，这是who孩子1。53泰网关啊，这是网关发给呃，发给1。53的对吧对，那么1。53我看啊，1。53。

这儿这儿这儿这儿这儿对，这是第一个啊，第一个啊嗯就是说啊这个kelly啊，7f d a7 b啊，谁知道发生一个广播包，对谁知道1。1护孩子192。168点，1。1对他的mac地址告诉1。53是吧。

那么这个呢是一个什么类型呢，这是一个请求的数据包，我们来看一下啊，来我们可以停止了停止停止啊，a arp协议啊，我们点击这里点击这里好吧，然后呢我们来看这个每一个都是什么意思啊，我来给大家解读一下的。

好不好对嗯，这个首先啊看这是request是吧，这请求包对吧，这是1。53向局域网内发生的广播包，来问谁知道1。1对吧，他的mac地址啊，看这里圆mac地址，这是谁，这是1。53，就是开利的对吧。

哎原ip地址1。53，目标mac地址现在是不知道，我们想要知道对吧，目标ip地址是网关的嗯，然后呢注意那么这里第一个啊headware type啊，那么这是代表他硬件类型也是标识啊，链路层协议好吧。

对以太网协议，然后呢这个呢pro这是协议类型啊，那标识是网络层协议，网络层协议，然后呢再往下这个是硬件地址长度对，那么就是mark地址长度，那标识它是六个字节48位对吧，那么这个呢是协议地址长度啊。

四个字节有ip地址长度32位，然后呢这op code操作码操作码呢，这标识啊这个a r p啊，数据包的类型啊，一呢表示是请求，二表示响应啊，那么哪个是响应呢，来我们看这个啊，应该是这个对吧，二是响应。

然后呢这块一是request请求啊，然后呢这个下面的是原mark原ip，目标me ip和目标mac地址啊，那木源mac地址现在是不知道的，那么我们来点击第二个，这个是响应包，谁响应给谁的网关，发给1。

53的a r p响应包，那么这里呢就是replay好吧，对代表是响应啊，然后呢这个是这这这个都一样了啊，这个都一样，然后呢这个操作码的是二代表的响应包啊，那么这里原mac地址。

原ip地址正好和对他的请求包互换了，对此时的网关发给kelly的，那么这个原mac地址就是网关的，原ip呢是网关的对吧，目标mac地址是kelly目标ip一点五三好吧。

那么这个呢就是整个这个a r p啊，它这个协议啊类型啊，那么相对来讲还是比较简单的啊，这个然后呢我们来给大家来总结一下的好吧，对这个是a r p啊，如何才能抓到a r p数据包啊。

那么你其实只是n map，发送一个a r p请求包就可以了啊，对n map杠小s啊，那其实我们来看整个过程啊，对整个过程还是比较有意思的对吧，嗯注意啊，那么在请求包中啊，在请求包中。

那么这个目标mac地面都是零，因为他不知道对吧，那么在响应包a r i p应答包中，那么这个零对吧，都被谁呀，你要请求的那个对他的mac地址填充了对，也就是说应答包补全了自己的mac地址。

目的地址和原地址做了一个替换，正好颠倒过来了，互换了好吧，那么整个过程啊对我们就相当于啥，就是一问一答，是不是啊，我们看啊，看这个图，who has啊，1。1til一点五三啊，然后呢要显应包呢。

这里头来看他想要1。2。168。1。1at，后边是他他网关的mac地址是吧，他在这里，那么此时呢就相当于1。53，发送了一个广播包，问谁有1。1的mac地址，然后呢1。1硬答对，那么是1。

1的mac地址是啥，这个那么整个过程就相应啊，广播请求单播回应啊，那么这个呢过程呢是一个还是比较有趣的啊，对就是a r p协议类型的数据包啊。



![](img/d4a43e8fcd39a0d4e8996dbfd176bd56_5.png)