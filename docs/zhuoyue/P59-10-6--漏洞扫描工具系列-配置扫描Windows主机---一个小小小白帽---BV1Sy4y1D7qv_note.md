# 课程P59：10.6-【漏洞扫描工具系列】配置扫描Windows主机 🖥️🔍

在本节课中，我们将学习如何使用OpenVAS（NAS）漏洞扫描工具来配置并执行对Windows主机的扫描。我们将从登录和基本设置开始，逐步讲解如何创建扫描任务、配置各项扫描参数，并最终查看和分析扫描结果。

## 概述与登录

首先，我们需要登录到OpenVAS的管理界面。假设目标Windows XP主机的IP地址是`192.168.1.154`。

登录后，界面语言默认为中文。我们可以通过点击“Settings”将其更改为英文，以便于后续操作。

在“Settings”中，可以管理用户、进行高级设置、配置代理服务器以及设置SMTP邮件服务器。邮件服务器用于在计划扫描任务完成后，自动发送报告到指定邮箱。

## 创建扫描任务

接下来，我们开始创建一个新的扫描任务。点击“Scans”，然后选择“New Scan”。

在创建新扫描的界面中，我们需要为任务命名，例如“XP_Scan”。目标（Target）可以设置为单个IP地址（如`192.168.1.154`）、IP地址段、域名，或者通过上传包含多个目标的文本文件来指定。

计划任务（Schedule）允许我们设置扫描的执行频率，例如一次性、每天、每周等。通知（Alerts）功能则可以在扫描完成后，通过邮件发送报告，但这需要提前配置好SMTP服务器。

报告（Report）设置允许我们自定义扫描报告的详细程度和内容。例如，可以选择是否启用覆盖模式以节省磁盘空间，或者是否在报告中显示被替代的修补程序信息。

## 配置扫描参数

### 主机发现

在“Discovery”部分，我们可以配置主机发现选项。默认启用了“Ping the remote host”功能。其下有两个子选项：
*   **Test the local...**: 表示在扫描目标主机时，是否也扫描本机。
*   **Fast network discovery**: 启用快速网络发现，可能会绕过一些额外的测试以提高速度，但可能牺牲一些准确性。

探测方式（Ping Method）提供了多种选择，如ARP（仅限局域网）、TCP、ICMP和UDP。我们还可以设置扫描网络打印机或启用网络唤醒（Wake-on-LAN）功能。

### 端口扫描

“Port Scanning”部分用于配置端口扫描。我们可以设置端口扫描的范围：
*   **Default**: 扫描约4790个常见端口。
*   **All**: 进行全端口扫描（1-65535）。
*   也可以自定义范围，例如 `80, 21, 22, 3306` 或 `T:1-1024`（扫描TCP协议的1-1024端口）。

本地端口枚举（Local Port Enumerators）提供了多种方式，如SSH、WMI等，通常用于需要身份验证的场景。网络端口扫描（Network Port Scanners）则包括TCP SYN扫描（半连接扫描，较隐蔽）、TCP全连接扫描和UDP扫描。

### 服务与漏洞扫描

在“Service”发现中，我们可以设置对所有端口上的服务进行探测，以及对SSL/TLS服务进行探测。可以指定检查在特定天数（如60天）内到期的SSL证书。

“Scan”选项卡下的设置关乎扫描的侵入性和精度。例如，“Thorough tests”选项会进行更彻底的测试，可能获得更精确的结果，但也更具侵入性，可能影响目标主机。

### Windows特定设置

由于我们的目标是Windows主机，可以在“Windows”部分进行相关配置。例如，可以启用“Request information about SMB domains”来获取SMB域信息，或设置用户枚举的ID范围。

如果需要对Windows主机进行更深入的扫描（如检查恶意软件），可以在“Credentials”部分添加主机的登录凭证（用户名和密码）。

### 插件管理

“Plugins”部分管理扫描时使用的漏洞检测插件。我们可以根据目标主机的情况，启用或禁用特定的插件组或单个插件。例如，如果目标没有数据库服务，可以禁用数据库相关的插件组以提高扫描效率。

## 执行扫描与查看结果

所有参数配置完成后，点击“Save”保存任务，然后点击“Start”开始扫描。

扫描过程中，界面会实时显示发现的漏洞信息。扫描完成后，结果会按危险等级（高、中、低、信息）分类显示。

![](img/1834f38d961efd5734510dd052e76ff3_1.png)

我们可以点击某个具体的漏洞，查看其详细描述、影响、解决方案以及相关的参考链接。报告还会指出该漏洞是通过哪个端口、哪个插件发现的。

![](img/1834f38d961efd5734510dd052e76ff3_3.png)

## 总结

![](img/1834f38d961efd5734510dd052e76ff3_5.png)

本节课我们一起学习了使用OpenVAS对Windows主机进行漏洞扫描的完整流程。我们从登录和基本设置开始，详细讲解了如何创建扫描任务，并逐步配置了主机发现、端口扫描、服务探测、Windows特定设置以及插件管理等关键参数。最后，我们执行了扫描并学习了如何查看和分析扫描报告。通过实践，你可以根据不同的目标环境调整这些设置，以进行更有效、更精准的漏洞扫描。