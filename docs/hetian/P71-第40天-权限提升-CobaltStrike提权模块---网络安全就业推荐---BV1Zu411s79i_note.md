# è¯¾ç¨‹P71ï¼šç¬¬40å¤© - æƒé™æå‡ï¼šCobalt Strikeææƒæ¨¡å— ğŸš€

![](img/e2b6ad23cf71015f63c465600c231882_1.png)

åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åˆ©ç”¨Cobalt Strikeæ¡†æ¶ä¸­çš„ææƒæ¨¡å—ï¼Œå°†å·²è·å¾—çš„æ™®é€šç”¨æˆ·æƒé™æå‡è‡³æ›´é«˜æƒé™ï¼ˆå¦‚SYSTEMï¼‰ã€‚è¯¾ç¨‹å°†æ¶µç›–æ¼æ´åŸç†ã€æ¨¡å—é…ç½®ã€è„šæœ¬åŠ è½½ä»¥åŠå¤šç§ææƒæ–¹æ³•çš„å…·ä½“æ“ä½œã€‚

![](img/e2b6ad23cf71015f63c465600c231882_2.png)

![](img/e2b6ad23cf71015f63c465600c231882_3.png)

![](img/e2b6ad23cf71015f63c465600c231882_5.png)

![](img/e2b6ad23cf71015f63c465600c231882_7.png)

![](img/e2b6ad23cf71015f63c465600c231882_9.png)

![](img/e2b6ad23cf71015f63c465600c231882_11.png)

---

![](img/e2b6ad23cf71015f63c465600c231882_13.png)

![](img/e2b6ad23cf71015f63c465600c231882_15.png)

## æ¦‚è¿°

![](img/e2b6ad23cf71015f63c465600c231882_17.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†WindowsæœåŠ¡è·¯å¾„æ¼æ´çš„åŸç†ã€‚æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•åœ¨Cobalt Strikeä¸­åˆ©ç”¨ç›¸å…³æ¨¡å—å’Œè„šæœ¬å®ç°æƒé™æå‡ã€‚æˆ‘ä»¬å°†é‡ç‚¹å­¦ä¹ å†…ç½®ææƒæ¨¡å—ã€å¤–éƒ¨EXPåˆ©ç”¨ä»¥åŠPowerShellè„šæœ¬çš„é›†æˆä½¿ç”¨ã€‚

---

![](img/e2b6ad23cf71015f63c465600c231882_19.png)

![](img/e2b6ad23cf71015f63c465600c231882_21.png)

![](img/e2b6ad23cf71015f63c465600c231882_23.png)

## æœåŠ¡è·¯å¾„æ¼æ´åˆ©ç”¨å›é¡¾ä¸Cobalt Strikeé›†æˆ

å¦‚æœç›®æ ‡æœåŠ¡çš„å¯æ‰§è¡Œç¨‹åºè·¯å¾„æ²¡æœ‰è¢«å¼•å·åŒ…è£¹ï¼Œç³»ç»Ÿåœ¨å¯åŠ¨æœåŠ¡æ—¶ï¼Œä¼šæŒ‰ç©ºæ ¼åˆ†å‰²è·¯å¾„å­—ç¬¦ä¸²ï¼Œå¹¶ä¾æ¬¡æŸ¥æ‰¾å‰é¢éƒ¨åˆ†å¯¹åº”çš„å¯æ‰§è¡Œç¨‹åºã€‚å®ƒä¼šä¸€å±‚å±‚ç›®å½•æŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°æœ€ç»ˆçš„æœåŠ¡ç¨‹åºã€‚

![](img/e2b6ad23cf71015f63c465600c231882_25.png)

![](img/e2b6ad23cf71015f63c465600c231882_26.png)

![](img/e2b6ad23cf71015f63c465600c231882_28.png)

![](img/e2b6ad23cf71015f63c465600c231882_29.png)

![](img/e2b6ad23cf71015f63c465600c231882_30.png)

åˆ©ç”¨æ­¤æ¼æ´è¿›è¡Œææƒçš„æ–¹æ³•æ˜¯ï¼šæ‰¾åˆ°è¯¥è·¯å¾„ä¸­æŸä¸ªæˆ‘ä»¬æœ‰å†™å…¥æƒé™çš„ç›®å½•ã€‚å¦‚æœæœ‰å†™å…¥æƒé™ï¼Œå°±å¯ä»¥å°è¯•å†™å…¥ä¸€ä¸ªæ¶æ„ç¨‹åºã€‚

![](img/e2b6ad23cf71015f63c465600c231882_32.png)

![](img/e2b6ad23cf71015f63c465600c231882_34.png)

![](img/e2b6ad23cf71015f63c465600c231882_35.png)

ä¾‹å¦‚ï¼Œå°è¯•å†™å…¥ä¸€ä¸ª15872å­—èŠ‚çš„ç¨‹åºåˆ° `C:\Windows\Product` ç›®å½•ä¸‹ï¼Œç”Ÿæˆç¨‹åºåä¸º `common.exe`ã€‚ç”Ÿæˆæ­¤ç¨‹åºåï¼Œéœ€è¦ç­‰å¾…æœåŠ¡é‡æ–°å¯åŠ¨ã€‚å› ä¸ºæ¼æ´è§¦å‘éœ€è¦æœåŠ¡é‡å¯å¹¶åŠ è½½å¯æ‰§è¡Œç¨‹åºè·¯å¾„æ—¶ï¼Œæ‰ä¼šæŸ¥æ‰¾åˆ°æˆ‘ä»¬å†™å…¥çš„æœ¨é©¬ç¨‹åºå¹¶åŠ è½½æ‰§è¡Œã€‚

![](img/e2b6ad23cf71015f63c465600c231882_37.png)

ç”±äºæˆ‘ä»¬æ˜¯æ™®é€šç”¨æˆ·ï¼Œæ²¡æœ‰æƒé™å¯åŠ¨è¯¥æœåŠ¡ï¼Œæ‰€ä»¥åˆ©ç”¨æ¨¡å—ä¼šå¤„äºç­‰å¾…çŠ¶æ€ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ¨¡æ‹ŸæœåŠ¡å¯åŠ¨æ¥è§¦å‘ã€‚ä»¥ä¸‹æ˜¯åˆ©ç”¨è¿‡ç¨‹çš„å…³é”®æ­¥éª¤ï¼š

![](img/e2b6ad23cf71015f63c465600c231882_39.png)

![](img/e2b6ad23cf71015f63c465600c231882_41.png)

1.  **æŸ¥æ‰¾å¯åˆ©ç”¨æœåŠ¡**ï¼šæ¨¡å—ä¼šæ‰«æç›®æ ‡æœºå™¨ä¸Šå­˜åœ¨æ¼æ´çš„æœåŠ¡ã€‚
2.  **å†™å…¥æ¶æ„ç¨‹åº**ï¼šå°†ç”Ÿæˆçš„Stageï¼ˆPayloadï¼‰å†™å…¥æœ‰æƒé™çš„ç›®å½•ã€‚
3.  **ç­‰å¾…æœåŠ¡é‡å¯**ï¼šç­‰å¾…æœåŠ¡é‡å¯ä»¥è§¦å‘æ¼æ´ã€‚

![](img/e2b6ad23cf71015f63c465600c231882_43.png)

![](img/e2b6ad23cf71015f63c465600c231882_45.png)

![](img/e2b6ad23cf71015f63c465600c231882_47.png)

![](img/e2b6ad23cf71015f63c465600c231882_48.png)

**æ³¨æ„**ï¼šæˆåŠŸåˆ©ç”¨åï¼Œæˆ‘ä»¬å¾—åˆ°çš„ä¼šè¯ï¼ˆSessionï¼‰æ˜¯åŸºäº `common.exe` è¿™ä¸ªç¨‹åºçš„ã€‚ç”±äºå®ƒå¹¶éçœŸæ­£çš„æœåŠ¡ç¨‹åºï¼Œæ— æ³•ä¸æœåŠ¡æ§åˆ¶å™¨æ­£å¸¸é€šä¿¡ï¼Œè¿›ç¨‹å¾ˆå¿«ä¼šè¢«ç»ˆæ­¢ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¼šè¯å»ºç«‹åç«‹å³è¿›è¡Œè¿›ç¨‹è¿ç§»ï¼ˆMigrateï¼‰ï¼Œå°†ä¼šè¯è¿ç§»åˆ°ä¸€ä¸ªç¨³å®šçš„ç³»ç»Ÿè¿›ç¨‹ï¼ˆå¦‚ `explorer.exe`ï¼‰ä¸­ï¼Œä»¥ç»´æŒæŒä¹…è®¿é—®ã€‚

![](img/e2b6ad23cf71015f63c465600c231882_50.png)

![](img/e2b6ad23cf71015f63c465600c231882_52.png)

---

![](img/e2b6ad23cf71015f63c465600c231882_54.png)

![](img/e2b6ad23cf71015f63c465600c231882_56.png)

## Cobalt Strike é«˜çº§ä¼šè¯é…ç½®

![](img/e2b6ad23cf71015f63c465600c231882_58.png)

![](img/e2b6ad23cf71015f63c465600c231882_60.png)

åœ¨Cobalt Strikeä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é«˜çº§é…ç½®æ¥ä¼˜åŒ–ææƒæ“ä½œã€‚ä»¥ä¸‹æ˜¯å…³é”®é…ç½®é¡¹ï¼š

![](img/e2b6ad23cf71015f63c465600c231882_62.png)

![](img/e2b6ad23cf71015f63c465600c231882_64.png)

*   **`exitonsession`**ï¼šæ­¤é€‰é¡¹é»˜è®¤ä¸º `true`ï¼Œæ„å‘³ç€åœ¨å¾—åˆ°ä¸€ä¸ªä¼šè¯åï¼Œåå°çš„Jobï¼ˆä»»åŠ¡ï¼‰ä¼šè‡ªåŠ¨é€€å‡ºã€‚é€šå¸¸æˆ‘ä»¬å°†å…¶è®¾ç½®ä¸º `false`ï¼Œè®©JobæŒç»­è¿è¡Œï¼Œç¡®ä¿Payloadæ‰§è¡Œåèƒ½ç¨³å®šå»ºç«‹ä¼šè¯ã€‚
*   **`autorunscript`**ï¼šæ­¤é€‰é¡¹ç”¨äºè®¾ç½®è‡ªåŠ¨è¿è¡Œè„šæœ¬ã€‚åœ¨å¾—åˆ°æ–°ä¼šè¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œæ­¤å¤„è®¾ç½®çš„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸º `migrate -f`ï¼Œè¿™æ ·åœ¨è·å¾—ä¼šè¯çš„ç¬é—´ï¼Œå°±ä¼šè‡ªåŠ¨å°†ä¼šè¯è¿ç§»åˆ°å…¶ä»–è¿›ç¨‹ï¼Œé˜²æ­¢å› è¿›ç¨‹é€€å‡ºè€Œä¸¢å¤±æƒé™ã€‚
*   **`servercms` æ¨¡å—**ï¼šæ­¤æ¨¡å—å¯¹åº”â€œä¸å®‰å…¨çš„æœåŠ¡æƒé™â€æ¼æ´çš„åˆ©ç”¨ã€‚
*   **`alwaysinstallelevated` æ¨¡å—**ï¼šæ­¤æ¨¡å—å¯¹åº”â€œå§‹ç»ˆä»¥é«˜æƒé™å®‰è£…MSIâ€ç­–ç•¥çš„æ¼æ´åˆ©ç”¨ã€‚å¦‚æœç›®æ ‡ç­–ç•¥é…ç½®äº†æ­¤é¡¹ï¼Œä»»ä½•ç”¨æˆ·éƒ½èƒ½ä»¥SYSTEMæƒé™å®‰è£…MSIæ–‡ä»¶ã€‚æˆ‘ä»¬åªéœ€ç”Ÿæˆä¸€ä¸ªåŒ…å«Payloadçš„MSIæ–‡ä»¶å¹¶ä¸Šä¼ æ‰§è¡Œï¼Œå³å¯è·å¾—SYSTEMæƒé™çš„ä¼šè¯ã€‚

![](img/e2b6ad23cf71015f63c465600c231882_66.png)

![](img/e2b6ad23cf71015f63c465600c231882_68.png)

---

![](img/e2b6ad23cf71015f63c465600c231882_70.png)

## ä½¿ç”¨å¤–éƒ¨ææƒEXPï¼ˆä»¥CVE-2019-0803ä¸ºä¾‹ï¼‰

![](img/e2b6ad23cf71015f63c465600c231882_72.png)

![](img/e2b6ad23cf71015f63c465600c231882_74.png)

![](img/e2b6ad23cf71015f63c465600c231882_76.png)

![](img/e2b6ad23cf71015f63c465600c231882_78.png)

é™¤äº†å†…ç½®æ¨¡å—ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä¸Šä¼ å¹¶ä½¿ç”¨ç‹¬ç«‹çš„ææƒEXPç¨‹åºã€‚ä¾‹å¦‚ï¼Œåˆ©ç”¨CVE-2019-0803ï¼ˆWin32kæ¼æ´ï¼‰çš„EXPç¨‹åºã€‚

![](img/e2b6ad23cf71015f63c465600c231882_80.png)

![](img/e2b6ad23cf71015f63c465600c231882_82.png)

è¯¥EXPå½±å“èŒƒå›´å¾ˆå¹¿ï¼ŒåŒ…æ‹¬Windows 7åˆ°Windows 10ä»¥åŠå¤šä¸ªServerç‰ˆæœ¬ã€‚ä½¿ç”¨æ–¹æ³•é€šå¸¸æ˜¯åœ¨å‘½ä»¤è¡Œåæ¥ `cmd` é€‰é¡¹å’Œè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚

![](img/e2b6ad23cf71015f63c465600c231882_84.png)

![](img/e2b6ad23cf71015f63c465600c231882_86.png)

**æ“ä½œæ­¥éª¤**ï¼š
1.  åœ¨Cobalt Strikeçš„ä¼šè¯ä¸­ï¼Œé€šè¿‡æ–‡ä»¶ç®¡ç†å™¨å°†EXPç¨‹åºï¼ˆå¦‚ `exp.exe`ï¼‰ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ã€‚
2.  é€šè¿‡ `execute` å‘½ä»¤æˆ–Shellæ‰§è¡Œè¯¥EXPã€‚ä¾‹å¦‚ï¼š`exp.exe cmd "whoami"`ï¼Œå¦‚æœæˆåŠŸï¼Œä¼šè¿”å› `nt authority\system`ã€‚
3.  è¦è·å¾—ä¸€ä¸ªSYSTEMæƒé™çš„Beaconï¼Œå¯ä»¥å…ˆç”Ÿæˆä¸€ä¸ªåå‘Shellçš„Payloadï¼ˆå¦‚ `shell.exe`ï¼‰ï¼Œç„¶åé€šè¿‡EXPä»¥SYSTEMæƒé™æ‰§è¡Œå®ƒï¼š`exp.exe cmd "start C:\path\to\shell.exe"`ã€‚æ‰§è¡Œåï¼ŒCobalt Strikeçš„ç›‘å¬å™¨å°±ä¼šæ”¶åˆ°ä¸€ä¸ªSYSTEMæƒé™çš„ä¼šè¯ã€‚

![](img/e2b6ad23cf71015f63c465600c231882_88.png)

![](img/e2b6ad23cf71015f63c465600c231882_90.png)

---

![](img/e2b6ad23cf71015f63c465600c231882_92.png)

![](img/e2b6ad23cf71015f63c465600c231882_94.png)

![](img/e2b6ad23cf71015f63c465600c231882_96.png)

![](img/e2b6ad23cf71015f63c465600c231882_98.png)

## é›†æˆPowerShellææƒè„šæœ¬ï¼ˆPowerUpï¼‰

![](img/e2b6ad23cf71015f63c465600c231882_100.png)

![](img/e2b6ad23cf71015f63c465600c231882_101.png)

![](img/e2b6ad23cf71015f63c465600c231882_103.png)

Cobalt Strikeå¯ä»¥é€šè¿‡ `powershell-import` åŠ è½½PowerShellè„šæœ¬ã€‚PowerUpæ˜¯ä¸€ä¸ªè‘—åçš„ææƒè¾…åŠ©è„šæœ¬ï¼Œèƒ½å…¨é¢æ£€æµ‹ç³»ç»Ÿæ½œåœ¨çš„ææƒæ¼æ´ã€‚

![](img/e2b6ad23cf71015f63c465600c231882_105.png)

![](img/e2b6ad23cf71015f63c465600c231882_107.png)

![](img/e2b6ad23cf71015f63c465600c231882_109.png)

![](img/e2b6ad23cf71015f63c465600c231882_111.png)

![](img/e2b6ad23cf71015f63c465600c231882_113.png)

![](img/e2b6ad23cf71015f63c465600c231882_115.png)

**æ“ä½œæ­¥éª¤**ï¼š
1.  ä½¿ç”¨ `powershell-import` å‘½ä»¤åŠ è½½æœ¬åœ°çš„PowerUpè„šæœ¬ã€‚
2.  ä½¿ç”¨ `powershell` å‘½ä»¤è°ƒç”¨è„šæœ¬ä¸­çš„æ¨¡å—ã€‚ä¾‹å¦‚ï¼Œæ‰§è¡Œ `Invoke-AllChecks` å‘½ä»¤ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨è¿è¡Œæ‰€æœ‰æ£€æŸ¥æ¨¡å—ã€‚
3.  è„šæœ¬ä¼šè¾“å‡ºè¯¦ç»†çš„æ£€æµ‹ç»“æœï¼Œä¾‹å¦‚ï¼š
    *   å¯å†™çš„æœåŠ¡è·¯å¾„ï¼ˆ`Unquoted Service Paths`ï¼‰ã€‚
    *   å¯ç”¨çš„â€œå§‹ç»ˆä»¥é«˜æƒé™å®‰è£…â€ç­–ç•¥ï¼ˆ`AlwaysInstallElevated`ï¼‰ã€‚
    *   å…¶ä»–é…ç½®é”™è¯¯æˆ–å¼±æƒé™ç‚¹ã€‚
    æ ¹æ®è¾“å‡ºä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æˆ–ç»“åˆå…¶ä»–æ¨¡å—è¿›è¡Œåˆ©ç”¨ã€‚

![](img/e2b6ad23cf71015f63c465600c231882_117.png)

![](img/e2b6ad23cf71015f63c465600c231882_119.png)

---

![](img/e2b6ad23cf71015f63c465600c231882_121.png)

![](img/e2b6ad23cf71015f63c465600c231882_122.png)

![](img/e2b6ad23cf71015f63c465600c231882_124.png)

![](img/e2b6ad23cf71015f63c465600c231882_126.png)

![](img/e2b6ad23cf71015f63c465600c231882_128.png)

## åŠ è½½ä¸ä½¿ç”¨ç¬¬ä¸‰æ–¹Aggressorè„šæœ¬ï¼ˆå¦‚SweetPotatoï¼‰

![](img/e2b6ad23cf71015f63c465600c231882_130.png)

![](img/e2b6ad23cf71015f63c465600c231882_132.png)

![](img/e2b6ad23cf71015f63c465600c231882_133.png)

![](img/e2b6ad23cf71015f63c465600c231882_135.png)

![](img/e2b6ad23cf71015f63c465600c231882_137.png)

![](img/e2b6ad23cf71015f63c465600c231882_139.png)

Aggressorè„šæœ¬å¯ä»¥æå¤§æ‰©å±•Cobalt Strikeçš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œ`SweetPotato`ï¼ˆåœŸè±†å®¶æ—ææƒå·¥å…·ï¼‰å°±æœ‰å¯¹åº”çš„Aggressorè„šæœ¬ç‰ˆæœ¬ã€‚

![](img/e2b6ad23cf71015f63c465600c231882_141.png)

![](img/e2b6ad23cf71015f63c465600c231882_143.png)

**æ“ä½œæ­¥éª¤**ï¼š
1.  åœ¨Cobalt Strikeçš„è„šæœ¬ç®¡ç†å™¨ï¼ˆ`Script Manager`ï¼‰ä¸­ï¼Œç‚¹å‡» `Load`ï¼Œé€‰æ‹©åç¼€ä¸º `.cna` çš„è„šæœ¬æ–‡ä»¶è¿›è¡ŒåŠ è½½ã€‚
2.  åŠ è½½æˆåŠŸåï¼Œåœ¨Beaconçš„å³é”®èœå• `Access` -> `Elevate` ä¸­ï¼Œä¼šå‡ºç°æ–°çš„ææƒé€‰é¡¹ï¼ˆå¦‚ `SweetPotato`ï¼‰ã€‚
3.  é€‰æ‹©è¯¥é€‰é¡¹å¹¶æŒ‡å®šç›‘å¬å™¨ï¼Œå¦‚æœç›®æ ‡å­˜åœ¨ç›¸åº”æ¼æ´ï¼Œæ‰§è¡Œåå³å¯è·å¾—ä¸€ä¸ªSYSTEMæƒé™çš„ä¼šè¯ã€‚

![](img/e2b6ad23cf71015f63c465600c231882_144.png)

![](img/e2b6ad23cf71015f63c465600c231882_146.png)

![](img/e2b6ad23cf71015f63c465600c231882_147.png)

![](img/e2b6ad23cf71015f63c465600c231882_149.png)

![](img/e2b6ad23cf71015f63c465600c231882_151.png)

![](img/e2b6ad23cf71015f63c465600c231882_152.png)

---

![](img/e2b6ad23cf71015f63c465600c231882_154.png)

![](img/e2b6ad23cf71015f63c465600c231882_156.png)

![](img/e2b6ad23cf71015f63c465600c231882_158.png)

![](img/e2b6ad23cf71015f63c465600c231882_160.png)

![](img/e2b6ad23cf71015f63c465600c231882_162.png)

## Cobalt Strikeé€šä¿¡æœºåˆ¶ç®€è¦è¯´æ˜

![](img/e2b6ad23cf71015f63c465600c231882_164.png)

ä¸ºäº†æ›´å¥½åœ°ç†è§£æ“ä½œï¼Œç®€è¦è¯´æ˜Cobalt Strikeçš„é€šä¿¡æ¨¡å‹ï¼š
*   **Team Server**ï¼šæœåŠ¡ç«¯ï¼Œç®¡ç†è€…å¤šä¸ªç›‘å¬å™¨ï¼ˆListenerï¼‰ã€‚
*   **Beacon**ï¼šæ¤å…¥åœ¨ç›®æ ‡æœºå™¨ä¸Šçš„Payloadï¼Œä¸Team Serveré€šä¿¡ã€‚
*   **é€šä¿¡æ–¹å¼**ï¼šé€šå¸¸ä½¿ç”¨HTTP/HTTPSæˆ–DNSç­‰åè®®ã€‚Beaconä¼šæŒ‰ç…§è®¾å®šçš„ç¡çœ æ—¶é—´ï¼ˆ`sleep`ï¼‰ï¼Œå®šæœŸå‘Team Serverå‘é€è¯·æ±‚ï¼ˆå¦‚GETè¯·æ±‚ï¼‰æ¥è·å–å¾…æ‰§è¡Œçš„å‘½ä»¤ã€‚æ‰§è¡Œç»“æœå†é€šè¿‡POSTç­‰æ–¹å¼å›ä¼ ã€‚è®¾ç½®è¾ƒçŸ­çš„ `sleep` æ—¶é—´ä¼šä½¿äº¤äº’æ›´å®æ—¶ï¼Œä½†ä¹Ÿæ›´å®¹æ˜“è¢«æ£€æµ‹ã€‚

![](img/e2b6ad23cf71015f63c465600c231882_166.png)

![](img/e2b6ad23cf71015f63c465600c231882_168.png)

![](img/e2b6ad23cf71015f63c465600c231882_170.png)

![](img/e2b6ad23cf71015f63c465600c231882_171.png)

![](img/e2b6ad23cf71015f63c465600c231882_173.png)

![](img/e2b6ad23cf71015f63c465600c231882_175.png)

![](img/e2b6ad23cf71015f63c465600c231882_177.png)

---

![](img/e2b6ad23cf71015f63c465600c231882_179.png)

![](img/e2b6ad23cf71015f63c465600c231882_180.png)

![](img/e2b6ad23cf71015f63c465600c231882_182.png)

![](img/e2b6ad23cf71015f63c465600c231882_184.png)

## æ€»ç»“

![](img/e2b6ad23cf71015f63c465600c231882_186.png)

æœ¬èŠ‚è¯¾æˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†åœ¨Cobalt Strikeæ¡†æ¶ä¸­è¿›è¡Œæƒé™æå‡çš„å¤šç§æ–¹æ³•ï¼š
1.  åˆ©ç”¨å†…ç½®çš„ `elevate` æ¨¡å—è¿›è¡Œææƒã€‚
2.  é€šè¿‡é«˜çº§ä¼šè¯é…ç½®ï¼ˆ`autorunscript`ï¼‰å®ç°è‡ªåŠ¨åŒ–è¿›ç¨‹è¿ç§»ï¼Œç»´æŒæƒé™ç¨³å®šã€‚
3.  ä¸Šä¼ å¹¶åˆ©ç”¨å¤–éƒ¨ææƒEXPç¨‹åºï¼ˆå¦‚CVE-2019-0803ï¼‰ã€‚
4.  é›†æˆPowerShellè„šæœ¬ï¼ˆå¦‚PowerUpï¼‰è¿›è¡Œå…¨é¢çš„æ¼æ´æ£€æµ‹ã€‚
5.  åŠ è½½ç¬¬ä¸‰æ–¹Aggressorè„šæœ¬ï¼ˆå¦‚SweetPotatoï¼‰æ¥æ‰©å±•ææƒèƒ½åŠ›ã€‚

![](img/e2b6ad23cf71015f63c465600c231882_188.png)

![](img/e2b6ad23cf71015f63c465600c231882_190.png)

æŒæ¡è¿™äº›æ–¹æ³•ï¼Œèƒ½å¸®åŠ©æˆ‘ä»¬åœ¨æ¸—é€æµ‹è¯•ä¸­æ›´æœ‰æ•ˆåœ°å°†æ™®é€šç”¨æˆ·æƒé™æå‡è‡³SYSTEMæƒé™ï¼Œä¸ºåç»­çš„æ¨ªå‘ç§»åŠ¨å’Œæƒé™ç»´æŒæ‰“ä¸‹åŸºç¡€ã€‚è¯¾åè¯·å¤§å®¶åŠ¡å¿…åœ¨å®éªŒç¯å¢ƒä¸­äº²è‡ªæ“ä½œä¸€éï¼Œä»¥åŠ æ·±ç†è§£ã€‚