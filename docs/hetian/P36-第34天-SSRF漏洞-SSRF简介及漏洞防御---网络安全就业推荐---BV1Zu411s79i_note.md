# ç½‘ç»œå®‰å…¨å°±ä¸šæ¨è - è¯¾ç¨‹P36ï¼šç¬¬34å¤©ï¼šSSRFæ¼æ´ - ç®€ä»‹ã€åˆ©ç”¨ä¸é˜²å¾¡ ğŸ›¡ï¸

åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†è¦å­¦ä¹ æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ æ¼æ´ã€‚è¿™æ˜¯ä¸€ç§å…è®¸æ”»å‡»è€…è¯±ä½¿æœåŠ¡å™¨å‘ä»»æ„ç›®æ ‡å‘èµ·ç½‘ç»œè¯·æ±‚çš„æ¼æ´ï¼Œå¸¸è¢«ç”¨ä½œâ€œç©¿è¶Šç½‘ç»œé˜²ç«å¢™çš„é€šè¡Œè¯â€ã€‚

## ä»€ä¹ˆæ˜¯SSRFï¼ŸğŸ¤”

SSRFï¼Œå…¨ç§° Server-Side Request Forgeryï¼Œå³æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªç”±æœåŠ¡å™¨æ‰§è¡Œçš„æ¶æ„è¯·æ±‚é“¾æ¥ï¼Œä»è€Œé€ æˆæ¼æ´ã€‚è¯¥æ¼æ´é€šå¸¸ç”¨äºå¤–ç½‘æ¢æµ‹æˆ–æ”»å‡»å†…ç½‘æœåŠ¡ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_1.png)

![](img/77e0765b4691c75db3dabec028e17de8_3.png)

![](img/77e0765b4691c75db3dabec028e17de8_4.png)

![](img/77e0765b4691c75db3dabec028e17de8_6.png)

![](img/77e0765b4691c75db3dabec028e17de8_8.png)

![](img/77e0765b4691c75db3dabec028e17de8_10.png)

![](img/77e0765b4691c75db3dabec028e17de8_12.png)

å…¶å½¢æˆåŸå› å¤§å¤šæ˜¯ï¼šæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½ï¼Œä½†æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤å’Œé™åˆ¶ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_14.png)

![](img/77e0765b4691c75db3dabec028e17de8_16.png)

![](img/77e0765b4691c75db3dabec028e17de8_18.png)

![](img/77e0765b4691c75db3dabec028e17de8_19.png)

![](img/77e0765b4691c75db3dabec028e17de8_21.png)

![](img/77e0765b4691c75db3dabec028e17de8_22.png)

![](img/77e0765b4691c75db3dabec028e17de8_23.png)

![](img/77e0765b4691c75db3dabec028e17de8_24.png)

![](img/77e0765b4691c75db3dabec028e17de8_26.png)

ä¾‹å¦‚ï¼Œä¸€ä¸ªç½‘ç«™åŠ è½½æ‰˜ç®¡åœ¨å…¶ä»–æœåŠ¡å™¨ä¸Šçš„å›¾ç‰‡æ—¶ï¼Œå¦‚æœæœªå¯¹è¯·æ±‚å›¾ç‰‡èµ„æºçš„é“¾æ¥ï¼ˆURLï¼‰è¿›è¡Œé™åˆ¶å’Œè¿‡æ»¤ï¼Œå°±å¯èƒ½å­˜åœ¨SSRFæ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥ä¼ªé€ è¯·æ±‚ç›®æ ‡ï¼Œè®©å­˜åœ¨æ¼æ´çš„æœåŠ¡å™¨å‘æŒ‡å®šçš„å†…ç½‘IPå’Œç«¯å£å‘èµ·è¯·æ±‚ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_28.png)

![](img/77e0765b4691c75db3dabec028e17de8_29.png)

æœ€å¸¸è§çš„ä¾‹å­æ˜¯ï¼šæ”»å‡»è€…ä¼ å…¥ä¸€ä¸ªæœªç»éªŒè¯çš„URLï¼Œåç«¯ä»£ç ç›´æ¥è¯·æ±‚è¯¥URLï¼Œä»è€Œé€ æˆSSRFæ¼æ´ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_31.png)

![](img/77e0765b4691c75db3dabec028e17de8_33.png)

## SSRFä¸CSRFçš„åŒºåˆ« âš–ï¸

![](img/77e0765b4691c75db3dabec028e17de8_35.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†SSRFçš„åŸºæœ¬æ¦‚å¿µï¼Œæœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒä¸å¦ä¸€ä¸ªå¸¸è§æ¼æ´CSRFçš„åŒºåˆ«ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_37.png)

![](img/77e0765b4691c75db3dabec028e17de8_39.png)

![](img/77e0765b4691c75db3dabec028e17de8_40.png)

![](img/77e0765b4691c75db3dabec028e17de8_42.png)

![](img/77e0765b4691c75db3dabec028e17de8_43.png)

![](img/77e0765b4691c75db3dabec028e17de8_44.png)

![](img/77e0765b4691c75db3dabec028e17de8_46.png)

![](img/77e0765b4691c75db3dabec028e17de8_48.png)

![](img/77e0765b4691c75db3dabec028e17de8_50.png)

![](img/77e0765b4691c75db3dabec028e17de8_52.png)

*   **CSRF**ï¼šè·¨ç«™è¯·æ±‚ä¼ªé€ ã€‚å‘ç”Ÿåœ¨ç”¨æˆ·ç™»å½•ç½‘ç«™Aåï¼Œæ”»å‡»è€…è¯±ä½¿ç”¨æˆ·è®¿é—®æ¶æ„ç½‘ç«™Bï¼Œç½‘ç«™Båˆ©ç”¨ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ï¼ˆå¦‚Cookieï¼‰å‘ç½‘ç«™Aå‘èµ·éç”¨æˆ·æœ¬æ„çš„è¯·æ±‚ã€‚å…¶æ ¹æºæ˜¯æœåŠ¡ç«¯æ²¡æœ‰å¯¹ç”¨æˆ·æäº¤çš„æ•°æ®è¿›è¡Œéšæœºå€¼æ ¡éªŒï¼Œæˆ–æ²¡æœ‰æ ¡éªŒHTTPè¯·æ±‚å¤´ä¸­çš„Refererå­—æ®µã€‚
*   **SSRF**ï¼šæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ã€‚åˆ©ç”¨çš„æ˜¯æœåŠ¡å™¨å¯¹ç”¨æˆ·æä¾›çš„URLè¿‡äºä¿¡ä»»ï¼Œæ²¡æœ‰å¯¹è¯¥URLè¿›è¡Œå……åˆ†çš„é™åˆ¶å’Œæ¶æ„æ€§æ£€æµ‹ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å­˜åœ¨SSRFæ¼æ´çš„æœåŠ¡å™¨ä½œä¸ºè·³æ¿ï¼Œæ”»å‡»å†…ç½‘æˆ–å…¶ä»–æœåŠ¡å™¨ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_54.png)

![](img/77e0765b4691c75db3dabec028e17de8_56.png)

![](img/77e0765b4691c75db3dabec028e17de8_58.png)

![](img/77e0765b4691c75db3dabec028e17de8_59.png)

![](img/77e0765b4691c75db3dabec028e17de8_61.png)

## SSRFçš„æ”»å‡»å±å®³ ğŸ’¥

![](img/77e0765b4691c75db3dabec028e17de8_63.png)

![](img/77e0765b4691c75db3dabec028e17de8_65.png)

SSRFæ¼æ´çš„å±å®³ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

![](img/77e0765b4691c75db3dabec028e17de8_67.png)

![](img/77e0765b4691c75db3dabec028e17de8_69.png)

ä»¥ä¸‹æ˜¯SSRFæ¼æ´çš„ä¸»è¦å±å®³ï¼š

![](img/77e0765b4691c75db3dabec028e17de8_71.png)

![](img/77e0765b4691c75db3dabec028e17de8_73.png)

![](img/77e0765b4691c75db3dabec028e17de8_75.png)

![](img/77e0765b4691c75db3dabec028e17de8_77.png)

![](img/77e0765b4691c75db3dabec028e17de8_79.png)

1.  **ä¿¡æ¯æ”¶é›†**ï¼šæ”»å‡»è€…å¯ä»¥åˆ©ç”¨SSRFæ¼æ´è·å–Webåº”ç”¨å¯è¾¾æœåŠ¡å™¨çš„Bannerä¿¡æ¯ï¼Œæ”¶é›†å†…ç½‘æœåŠ¡çš„æŒ‡çº¹ä¿¡æ¯ï¼Œä»¥åŠæ¢æµ‹å†…éƒ¨ç½‘ç»œç»“æ„å’Œå¼€æ”¾çš„ç«¯å£ã€‚
2.  **æ”»å‡»å†…ç½‘æœåŠ¡**ï¼šæ”»å‡»è€…å¯ä»¥æ”»å‡»è¿è¡Œåœ¨å†…ç½‘çš„ç³»ç»Ÿæˆ–åº”ç”¨ç¨‹åºã€‚ç”±äºå†…ç½‘æœåŠ¡çš„å®‰å…¨é˜²æŠ¤å¯èƒ½ä¸å¦‚å¤–ç½‘ä¸¥æ ¼ï¼Œå¯èƒ½å­˜åœ¨æœªæˆæƒè®¿é—®ç­‰æ¼æ´ã€‚é€šè¿‡SSRFæ”»å‡»è¿™äº›æ¼æ´ï¼Œå¯èƒ½ç›´æ¥è·å–Web Shellï¼Œä»è€Œç»•è¿‡é˜²ç«å¢™è¿›å…¥ç›®æ ‡å†…ç½‘ã€‚
3.  **è¯»å–å†…éƒ¨èµ„æºä¸æ‰§è¡Œæ”»å‡»**ï¼šé€šè¿‡ç‰¹å®šçš„URLåè®®ï¼Œæ”»å‡»è€…å¯ä»¥è¯»å–æœåŠ¡å™¨å†…éƒ¨çš„æ•æ„Ÿæ–‡ä»¶ã€‚åŒæ—¶ï¼Œå¯ä»¥ç»“åˆå†…ç½‘ä¸­å­˜åœ¨çš„å…¶ä»–æ¼æ´ï¼ˆå¦‚Redisæœªæˆæƒè®¿é—®ã€Struts2å‘½ä»¤æ‰§è¡Œç­‰ï¼‰æ‰§è¡Œç›¸åº”çš„æ”»å‡»åŠ¨ä½œï¼Œä¾‹å¦‚å†™å…¥Webshellæˆ–åå¼¹Shellã€‚

## SSRFæ¼æ´çš„å¸¸è§åœºæ™¯ ğŸ”

äº†è§£äº†SSRFçš„å±å®³åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹åœ¨å“ªäº›åœ°æ–¹å¯èƒ½æ‰¾åˆ°è¿™ç§æ¼æ´ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_81.png)

![](img/77e0765b4691c75db3dabec028e17de8_83.png)

ä»¥ä¸‹æ˜¯ä»WebåŠŸèƒ½ç‚¹å¯»æ‰¾SSRFæ¼æ´çš„å¸¸è§åœºæ™¯ï¼š

![](img/77e0765b4691c75db3dabec028e17de8_85.png)

![](img/77e0765b4691c75db3dabec028e17de8_87.png)

![](img/77e0765b4691c75db3dabec028e17de8_89.png)

1.  **é€šè¿‡URLåœ°å€åˆ†äº«ç½‘é¡µå†…å®¹**ï¼šä¾‹å¦‚æ–‡ç« åˆ†äº«åˆ°å¾®åšã€QQç©ºé—´ç­‰åŠŸèƒ½ã€‚è¿™äº›åŠŸèƒ½ä¼šé€šè¿‡ç”¨æˆ·æä¾›çš„URLé“¾æ¥è·å–ç›®æ ‡ç½‘ç«™çš„æ ‡é¢˜ã€å›¾ç‰‡ç­‰å†…å®¹ã€‚å¦‚æœæœªå¯¹ç”¨æˆ·æä¾›çš„é“¾æ¥è¿›è¡Œè¿‡æ»¤ï¼Œå°±å¯èƒ½å­˜åœ¨SSRFæ¼æ´ã€‚
2.  **åœ¨çº¿ç¿»è¯‘**ï¼šä¾‹å¦‚ç™¾åº¦ç¿»è¯‘ã€æœ‰é“ç¿»è¯‘ç­‰æä¾›çš„â€œç¿»è¯‘ç½‘é¡µâ€åŠŸèƒ½ã€‚è¯¥åŠŸèƒ½ä¼šè¯·æ±‚ç”¨æˆ·è¾“å…¥çš„URLä»¥è·å–ç½‘é¡µå†…å®¹è¿›è¡Œç¿»è¯‘ã€‚å¦‚æœæœªå¯¹URLè¿›è¡Œé™åˆ¶ï¼Œå°±å¯èƒ½å­˜åœ¨SSRFæ¼æ´ã€‚
3.  **é€šè¿‡URLåœ°å€åŠ è½½ä¸ä¸‹è½½å›¾ç‰‡**ï¼šç½‘ç«™é€šè¿‡ç”¨æˆ·æä¾›çš„URLè¿œç¨‹åŠ è½½æˆ–ä¸‹è½½å›¾ç‰‡èµ„æºã€‚
4.  **å›¾ç‰‡/æ–‡ç« æ”¶è—åŠŸèƒ½**ï¼šä¾‹å¦‚å°è±¡ç¬”è®°çš„æ”¶è—åŠŸèƒ½ï¼Œå®ƒä¼šè¯·æ±‚ç”¨æˆ·æä¾›çš„URLä»¥ä¿å­˜æ–‡ç« å†…å®¹ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_91.png)

![](img/77e0765b4691c75db3dabec028e17de8_93.png)

![](img/77e0765b4691c75db3dabec028e17de8_95.png)

![](img/77e0765b4691c75db3dabec028e17de8_97.png)

![](img/77e0765b4691c75db3dabec028e17de8_99.png)

æ­¤å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡URLä¸­çš„å…³é”®å­—ï¼ˆå¦‚ `url`ã€`link`ã€`src` ç­‰ï¼‰æ¥å¯»æ‰¾å¯èƒ½å­˜åœ¨SSRFæ¼æ´çš„å‚æ•°ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_101.png)

![](img/77e0765b4691c75db3dabec028e17de8_103.png)

![](img/77e0765b4691c75db3dabec028e17de8_105.png)

![](img/77e0765b4691c75db3dabec028e17de8_107.png)

**æ€»ç»“æ¥è¯´ï¼ŒSSRFæ¼æ´å¸¸å‡ºç°åœ¨ä¸¤ç±»åœºæ™¯ï¼š**
*   èƒ½å¤Ÿå¯¹å¤–å‘èµ·ç½‘ç»œè¯·æ±‚çš„åœ°æ–¹ã€‚
*   ä»è¿œç¨‹æœåŠ¡å™¨è¯·æ±‚èµ„æºï¼ˆå¦‚å›¾ç‰‡ã€æ–‡æœ¬ï¼‰çš„åŠŸèƒ½ç‚¹ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_109.png)

![](img/77e0765b4691c75db3dabec028e17de8_111.png)

![](img/77e0765b4691c75db3dabec028e17de8_113.png)

## SSRFæ¼æ´çš„åˆ©ç”¨ä¸æµ‹è¯• ğŸ› ï¸

![](img/77e0765b4691c75db3dabec028e17de8_115.png)

![](img/77e0765b4691c75db3dabec028e17de8_117.png)

![](img/77e0765b4691c75db3dabec028e17de8_119.png)

![](img/77e0765b4691c75db3dabec028e17de8_121.png)

å‘ç°æ½œåœ¨çš„SSRFæ¼æ´åï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨ä¸€äº›ç‰¹å®šçš„URLåè®®æ¥è¿›è¡Œæµ‹è¯•å’Œåˆ©ç”¨ã€‚

ä»¥ä¸‹æ˜¯SSRFåˆ©ç”¨ä¸­å¸¸ç”¨çš„å‡ ç§URLåè®®ï¼š

1.  **`dict://` åè®®**ï¼šå­—å…¸æœåŠ¡å™¨åè®®ã€‚å¯ç”¨äºè·å–ç›®æ ‡æœåŠ¡å™¨ä¸Šç‰¹å®šç«¯å£è¿è¡ŒæœåŠ¡çš„ç‰ˆæœ¬ç­‰Bannerä¿¡æ¯ã€‚
    *   **æœ¬åœ°åˆ©ç”¨ç¤ºä¾‹**ï¼š`curl -v â€œdict://127.0.0.1:3306â€` å¯ä»¥æ¢æµ‹æœ¬åœ°MySQLæœåŠ¡çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚
    *   **è¿œç¨‹åˆ©ç”¨**ï¼šåœ¨å­˜åœ¨SSRFæ¼æ´çš„å‚æ•°ä¸­ï¼Œæ„é€  `dict://å†…ç½‘IP:ç«¯å£` çš„Payloadï¼ŒæœåŠ¡å™¨ä¼šè¯·æ±‚è¯¥ç«¯å£å¹¶è¿”å›æœåŠ¡ä¿¡æ¯ã€‚
2.  **`file://` åè®®**ï¼šæ–‡ä»¶ç³»ç»Ÿåè®®ã€‚ç”¨äºè¯»å–æœåŠ¡å™¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„å†…å®¹ã€‚
    *   **åˆ©ç”¨ç¤ºä¾‹**ï¼šæ„é€  `file:///etc/passwd` å¯ä»¥å°è¯•è¯»å–Linuxç³»ç»Ÿçš„å¯†ç æ–‡ä»¶ã€‚
3.  **`gopher://` åè®®**ï¼šä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„åè®®ï¼Œå ªç§°â€œä¸‡é‡‘æ²¹â€ã€‚å®ƒå¯ä»¥å‘é€é¢„å…ˆæ„é€ å¥½çš„æ•°æ®åŒ…ï¼Œå¸¸ç”¨äºæ”»å‡»å†…ç½‘æœåŠ¡ï¼Œå¦‚Redisæœªæˆæƒè®¿é—®ã€‚
    *   **åˆ©ç”¨ç¤ºä¾‹**ï¼š`curl â€œgopher://127.0.0.1:6789/_HI%20Everyone%0AThis%20is%20just%20a%20testâ€` ä¼šå‘æœ¬åœ°çš„6789ç«¯å£å‘é€ä¸€æ®µæ–‡æœ¬æ•°æ®ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_123.png)

## PHPä¸­æ˜“å¯¼è‡´SSRFçš„å‡½æ•° âš™ï¸

![](img/77e0765b4691c75db3dabec028e17de8_125.png)

![](img/77e0765b4691c75db3dabec028e17de8_127.png)

![](img/77e0765b4691c75db3dabec028e17de8_129.png)

![](img/77e0765b4691c75db3dabec028e17de8_131.png)

![](img/77e0765b4691c75db3dabec028e17de8_133.png)

![](img/77e0765b4691c75db3dabec028e17de8_135.png)

![](img/77e0765b4691c75db3dabec028e17de8_137.png)

åœ¨PHPå¼€å‘ä¸­ï¼ŒæŸäº›å‡½æ•°ä½¿ç”¨ä¸å½“ææ˜“å¼•å‘SSRFæ¼æ´ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_139.png)

![](img/77e0765b4691c75db3dabec028e17de8_141.png)

![](img/77e0765b4691c75db3dabec028e17de8_143.png)

ä»¥ä¸‹æ˜¯ä¸‰ä¸ªéœ€è¦é‡ç‚¹å…³æ³¨çš„PHPå‡½æ•°ï¼š

![](img/77e0765b4691c75db3dabec028e17de8_145.png)

![](img/77e0765b4691c75db3dabec028e17de8_146.png)

![](img/77e0765b4691c75db3dabec028e17de8_148.png)

![](img/77e0765b4691c75db3dabec028e17de8_150.png)

![](img/77e0765b4691c75db3dabec028e17de8_152.png)

![](img/77e0765b4691c75db3dabec028e17de8_154.png)

![](img/77e0765b4691c75db3dabec028e17de8_156.png)

![](img/77e0765b4691c75db3dabec028e17de8_158.png)

![](img/77e0765b4691c75db3dabec028e17de8_160.png)

![](img/77e0765b4691c75db3dabec028e17de8_161.png)

![](img/77e0765b4691c75db3dabec028e17de8_162.png)

1.  **`curl_exec()`**ï¼šç”¨äºæ‰§è¡ŒcURLä¼šè¯ï¼Œè·å–URLå†…å®¹ã€‚å¦‚æœå‰ç«¯ä¼ å…¥çš„URLå‚æ•°æœªç»å¤„ç†ç›´æ¥ä¼ ç»™æ­¤å‡½æ•°ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„URLè¿›è¡Œåˆ©ç”¨ã€‚
2.  **`file_get_contents()`**ï¼šå°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚åŒæ ·ï¼Œå¦‚æœå‚æ•°å¯æ§ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒè¯»å–æ–‡ä»¶æˆ–è¯·æ±‚URLã€‚**ç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯**ï¼Œæ­¤å‡½æ•°æ”¯æŒPHPä¼ªåè®® `php://filter`ï¼Œå¯ç”¨æ¥è¯»å–ç½‘ç«™æºç ï¼ˆå¦‚ `php://filter/convert.base64-encode/resource=index.php`ï¼‰ï¼Œé¿å…PHPä»£ç è¢«ç›´æ¥è§£ææ‰§è¡Œã€‚
3.  **`fsockopen()`**ï¼šæ‰“å¼€ä¸€ä¸ªç½‘ç»œè¿æ¥æˆ–Unixå¥—æ¥å­—è¿æ¥ã€‚æ­¤å‡½æ•°ä¸»è¦ç”¨äºå¯¹IPåœ°å€æˆ–åŸŸåè¿›è¡ŒåŸå§‹Socketè¿æ¥ï¼Œå¹¶è¯»å–è¿”å›å†…å®¹ã€‚å®ƒåªèƒ½å¤„ç†IP/åŸŸåï¼Œä¸èƒ½ç›´æ¥å¤„ç†å®Œæ•´çš„HTTP URLã€‚

![](img/77e0765b4691c75db3dabec028e17de8_164.png)

![](img/77e0765b4691c75db3dabec028e17de8_166.png)

![](img/77e0765b4691c75db3dabec028e17de8_168.png)

![](img/77e0765b4691c75db3dabec028e17de8_170.png)

![](img/77e0765b4691c75db3dabec028e17de8_172.png)

![](img/77e0765b4691c75db3dabec028e17de8_174.png)

![](img/77e0765b4691c75db3dabec028e17de8_175.png)

![](img/77e0765b4691c75db3dabec028e17de8_177.png)

![](img/77e0765b4691c75db3dabec028e17de8_179.png)

![](img/77e0765b4691c75db3dabec028e17de8_181.png)

![](img/77e0765b4691c75db3dabec028e17de8_183.png)

## æ— å›æ˜¾çš„SSRFï¼ˆBlind SSRFï¼‰ä¸æ£€æµ‹æ–¹æ³• ğŸ•µï¸â™‚ï¸

![](img/77e0765b4691c75db3dabec028e17de8_185.png)

![](img/77e0765b4691c75db3dabec028e17de8_187.png)

![](img/77e0765b4691c75db3dabec028e17de8_189.png)

![](img/77e0765b4691c75db3dabec028e17de8_191.png)

å‰é¢ä»‹ç»çš„æ¡ˆä¾‹éƒ½æœ‰æ˜æ˜¾çš„å›æ˜¾ï¼ˆå³è¯·æ±‚ç»“æœä¼šæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼‰ã€‚ä½†å­˜åœ¨ä¸€ç§æƒ…å†µï¼ŒæœåŠ¡ç«¯è™½ç„¶å‘èµ·äº†è¯·æ±‚ï¼Œå´ä¸å°†ç»“æœè¿”å›ç»™å‰ç«¯é¡µé¢ï¼Œè¿™å°±æ˜¯â€œæ— å›æ˜¾SSRFâ€ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_193.png)

![](img/77e0765b4691c75db3dabec028e17de8_195.png)

![](img/77e0765b4691c75db3dabec028e17de8_196.png)

![](img/77e0765b4691c75db3dabec028e17de8_197.png)

![](img/77e0765b4691c75db3dabec028e17de8_198.png)

å¯¹äºæ— å›æ˜¾çš„SSRFï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§å¸¦å¤–é€šé“æŠ€æœ¯è¿›è¡Œæ£€æµ‹ï¼š

![](img/77e0765b4691c75db3dabec028e17de8_200.png)

![](img/77e0765b4691c75db3dabec028e17de8_202.png)

![](img/77e0765b4691c75db3dabec028e17de8_204.png)

![](img/77e0765b4691c75db3dabec028e17de8_206.png)

![](img/77e0765b4691c75db3dabec028e17de8_207.png)

![](img/77e0765b4691c75db3dabec028e17de8_209.png)

![](img/77e0765b4691c75db3dabec028e17de8_211.png)

1.  **HTTPå¸¦å¤–é€šé“**ï¼šåˆ©ç”¨Burp Suite Collaboratorå®¢æˆ·ç«¯æˆ–è‡ªå·±çš„å…¬ç½‘æœåŠ¡å™¨ã€‚å°†å¸¦æœ‰å”¯ä¸€å­åŸŸåçš„Collaborator URLæˆ–è‡ªå·±çš„æœåŠ¡å™¨åœ°å€ä½œä¸ºPayloadï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨å‘èµ·äº†è¯·æ±‚ï¼Œæˆ‘ä»¬å°±èƒ½åœ¨Collaboratoræˆ–æœåŠ¡å™¨æ—¥å¿—ä¸­çœ‹åˆ°è®°å½•ï¼Œä»è€Œè¯å®æ¼æ´å­˜åœ¨ã€‚
2.  **DNSLog**ï¼šåˆ©ç”¨DNSè§£æè®°å½•ã€‚ä½¿ç”¨ `dnslog.cn` ç­‰å¹³å°æä¾›çš„å­åŸŸåä½œä¸ºPayloadã€‚å¦‚æœç›®æ ‡æœåŠ¡å™¨å°è¯•è§£æè¯¥åŸŸåï¼Œå°±ä¼šåœ¨å¹³å°ç•™ä¸‹DNSè§£ææ—¥å¿—ï¼Œä»è€Œåˆ¤æ–­æ¼æ´å­˜åœ¨ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_213.png)

![](img/77e0765b4691c75db3dabec028e17de8_215.png)

![](img/77e0765b4691c75db3dabec028e17de8_217.png)

## SSRFçš„é™åˆ¶ä¸ç»•è¿‡æ–¹æ³• ğŸš§

![](img/77e0765b4691c75db3dabec028e17de8_219.png)

![](img/77e0765b4691c75db3dabec028e17de8_221.png)

![](img/77e0765b4691c75db3dabec028e17de8_223.png)

![](img/77e0765b4691c75db3dabec028e17de8_225.png)

![](img/77e0765b4691c75db3dabec028e17de8_227.png)

æœåŠ¡ç«¯å¯èƒ½ä¼šå¯¹SSRFè¿›è¡Œä¸€äº›é˜²å¾¡æ€§é™åˆ¶ï¼Œä¾‹å¦‚è¿‡æ»¤å†…ç½‘IPã€ç‰¹å®šåè®®ç­‰ã€‚æ”»å‡»è€…åˆ™éœ€è¦æŒæ¡ä¸€äº›ç»•è¿‡æŠ€å·§ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_229.png)

![](img/77e0765b4691c75db3dabec028e17de8_231.png)

![](img/77e0765b4691c75db3dabec028e17de8_233.png)

![](img/77e0765b4691c75db3dabec028e17de8_235.png)

![](img/77e0765b4691c75db3dabec028e17de8_237.png)

![](img/77e0765b4691c75db3dabec028e17de8_239.png)

ä»¥ä¸‹æ˜¯å‡ ç§å¸¸è§çš„SSRFé™åˆ¶ç»•è¿‡æ–¹æ³•ï¼š

![](img/77e0765b4691c75db3dabec028e17de8_241.png)

![](img/77e0765b4691c75db3dabec028e17de8_243.png)

![](img/77e0765b4691c75db3dabec028e17de8_245.png)

![](img/77e0765b4691c75db3dabec028e17de8_247.png)

![](img/77e0765b4691c75db3dabec028e17de8_249.png)

![](img/77e0765b4691c75db3dabec028e17de8_251.png)

![](img/77e0765b4691c75db3dabec028e17de8_253.png)

1.  **åˆ©ç”¨ `@` ç¬¦å·**ï¼šURLæ ¼å¼ `http://example.com@192.168.1.1`ã€‚å®é™…è¯·æ±‚çš„æ˜¯`@`ç¬¦å·åçš„IPåœ°å€ï¼Œä½†å‰ç«¯æ˜¾ç¤ºçš„æ˜¯`@`å‰çš„åŸŸåï¼Œå¯ç”¨äºç»•è¿‡ä¸€äº›åŸºäºåŸŸåçš„è¿‡æ»¤ã€‚
2.  **IPåœ°å€è½¬æ¢è¿›åˆ¶**ï¼šå°†IPåœ°å€è½¬æ¢ä¸ºå…«è¿›åˆ¶ã€åè¿›åˆ¶æˆ–åå…­è¿›åˆ¶æ ¼å¼ã€‚ä¾‹å¦‚ï¼Œ`192.168.1.1` å¯è½¬æ¢ä¸ºï¼š
    *   å…«è¿›åˆ¶ï¼š`0300.0250.01.01`
    *   åè¿›åˆ¶ï¼š`3232235777`
    *   åå…­è¿›åˆ¶ï¼š`0xC0A80101`
    æµè§ˆå™¨åœ¨è§£ææ—¶é€šå¸¸ä¼šå°†å…¶è¿˜åŸä¸ºæ ‡å‡†IPã€‚
3.  **æ·»åŠ ç«¯å£**ï¼šåœ¨æŸäº›æ­£åˆ™åŒ¹é…ä¸ä¸¥è°¨çš„æƒ…å†µä¸‹ï¼Œä¸ºURLæ·»åŠ ç«¯å£å¯èƒ½ç»•è¿‡è¿‡æ»¤ï¼Œä¾‹å¦‚ `http://192.168.1.1:80`ã€‚
4.  **åˆ©ç”¨çŸ­åœ°å€/é‡å®šå‘æœåŠ¡**ï¼šä½¿ç”¨ `xip.io`ã€`nip.io` æˆ–URLçŸ­é“¾æ¥æœåŠ¡ã€‚ä¾‹å¦‚ `192.168.1.1.xip.io` ä¼šè§£æåˆ° `192.168.1.1`ï¼Œå¯ä»¥ç»•è¿‡å¯¹ç›´æ¥IPåœ°å€çš„è¿‡æ»¤ã€‚
5.  **åˆ©ç”¨å¥å·æ›¿ä»£ç‚¹**ï¼šåœ¨æŸäº›è§£æåœºæ™¯ä¸‹ï¼Œ`127ã€‚0ã€‚0ã€‚1`ï¼ˆä½¿ç”¨ä¸­æ–‡å¥å·ï¼‰å¯èƒ½è¢«ç­‰ä»·è§£æä¸º `127.0.0.1`ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_255.png)

![](img/77e0765b4691c75db3dabec028e17de8_257.png)

## SSRFæ¼æ´çš„é˜²å¾¡ ğŸ›¡ï¸

![](img/77e0765b4691c75db3dabec028e17de8_259.png)

![](img/77e0765b4691c75db3dabec028e17de8_261.png)

![](img/77e0765b4691c75db3dabec028e17de8_263.png)

![](img/77e0765b4691c75db3dabec028e17de8_265.png)

![](img/77e0765b4691c75db3dabec028e17de8_267.png)

![](img/77e0765b4691c75db3dabec028e17de8_269.png)

æœ€åï¼Œæˆ‘ä»¬ä»é˜²å¾¡è§’åº¦æ€»ç»“ä¸€ä¸‹åº”å¯¹SSRFæ¼æ´çš„æªæ–½ã€‚

![](img/77e0765b4691c75db3dabec028e17de8_271.png)

![](img/77e0765b4691c75db3dabec028e17de8_272.png)

![](img/77e0765b4691c75db3dabec028e17de8_273.png)

![](img/77e0765b4691c75db3dabec028e17de8_275.png)

![](img/77e0765b4691c75db3dabec028e17de8_277.png)

ä»¥ä¸‹æ˜¯é˜²å¾¡SSRFæ¼æ´çš„å‡ ç§æœ‰æ•ˆæ–¹æ³•ï¼š

1.  **è¿‡æ»¤è¿”å›ä¿¡æ¯**ï¼šå¯¹æœåŠ¡ç«¯è¯·æ±‚è¿”å›çš„å†…å®¹è¿›è¡Œä¸¥æ ¼æ£€æŸ¥ï¼Œå¦‚æœåŒ…å«æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚å†…ç½‘IPã€ç«¯å£Bannerç­‰ï¼‰ï¼Œåˆ™ä¸äºˆæ˜¾ç¤ºã€‚
2.  **ç»Ÿä¸€é”™è¯¯ä¿¡æ¯**ï¼šé¿å…é€šè¿‡è¯·æ±‚çš„æˆåŠŸæˆ–å¤±è´¥çŠ¶æ€ï¼ˆå¦‚å“åº”æ—¶é—´ã€å¸ƒå°”å€¼True/Falseï¼‰æ¥æ¨æ–­å†…ç½‘ä¿¡æ¯ã€‚
3.  **é™åˆ¶è¯·æ±‚ç«¯å£**ï¼šåªå…è®¸è®¿é—®Webåº”ç”¨éœ€è¦çš„å¸¸ç”¨ç«¯å£ï¼Œå¦‚80ã€443ã€8080ç­‰ã€‚
4.  **è®¾ç½®IPé»‘åå•**ï¼šä¸¥æ ¼ç¦æ­¢è®¿é—®å†…ç½‘IPåœ°å€æ®µï¼ˆå¦‚ `10.0.0.0/8`ï¼Œ `172.16.0.0/12`ï¼Œ `192.168.0.0/16`ï¼‰å’Œå›ç¯åœ°å€ï¼ˆ`127.0.0.0/8`ï¼‰ã€‚
5.  **ç¦ç”¨ä¸å¿…è¦çš„åè®®**ï¼šä»…å…è®¸ä½¿ç”¨HTTPå’ŒHTTPSåè®®ï¼Œç¦ç”¨ `file://`ã€`gopher://`ã€`dict://` ç­‰å±é™©åè®®ã€‚
6.  **è¿›è¡Œç™½åå•æ ¡éªŒ**ï¼šå¯¹ç”¨æˆ·è¾“å…¥çš„URLè¿›è¡Œä¸¥æ ¼çš„ç™½åå•æ ¡éªŒï¼Œåªå…è®¸è®¿é—®é¢„æœŸçš„ã€å¯ä¿¡çš„åŸŸåæˆ–IPã€‚

![](img/77e0765b4691c75db3dabec028e17de8_279.png)

![](img/77e0765b4691c75db3dabec028e17de8_281.png)

![](img/77e0765b4691c75db3dabec028e17de8_283.png)

![](img/77e0765b4691c75db3dabec028e17de8_285.png)

![](img/77e0765b4691c75db3dabec028e17de8_287.png)

## æ€»ç»“ ğŸ“š

![](img/77e0765b4691c75db3dabec028e17de8_289.png)

![](img/77e0765b4691c75db3dabec028e17de8_291.png)

![](img/77e0765b4691c75db3dabec028e17de8_293.png)

![](img/77e0765b4691c75db3dabec028e17de8_295.png)

![](img/77e0765b4691c75db3dabec028e17de8_297.png)

![](img/77e0765b4691c75db3dabec028e17de8_299.png)

![](img/77e0765b4691c75db3dabec028e17de8_301.png)

![](img/77e0765b4691c75db3dabec028e17de8_303.png)

![](img/77e0765b4691c75db3dabec028e17de8_305.png)

![](img/77e0765b4691c75db3dabec028e17de8_307.png)

![](img/77e0765b4691c75db3dabec028e17de8_309.png)

æœ¬èŠ‚è¯¾ä¸­æˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†SSRFæ¼æ´ã€‚æˆ‘ä»¬ä»SSRFçš„åŸºæœ¬æ¦‚å¿µå’Œå½¢æˆåŸå› è®²èµ·ï¼Œç†è§£äº†å®ƒä½œä¸ºâ€œå†…ç½‘é€šè¡Œè¯â€çš„å±å®³ã€‚æˆ‘ä»¬åŒºåˆ†äº†SSRFä¸CSRFï¼Œå¹¶åˆ—ä¸¾äº†SSRFå¸¸è§çš„æ”»å‡»åœºæ™¯å’Œåˆ©ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬ä½¿ç”¨ `dict`ã€`file`ã€`gopher` ç­‰åè®®è¿›è¡Œä¿¡æ¯æ¢æµ‹å’Œæ”»å‡»ã€‚æˆ‘ä»¬è¿˜æ¢è®¨äº†PHPä¸­æ˜“å¼•å‘SSRFçš„å±é™©å‡½æ•°ï¼Œä»¥åŠå¦‚ä½•æ£€æµ‹æ— å›æ˜¾çš„SSRFã€‚æœ€åï¼Œæˆ‘ä»¬å­¦ä¹ äº†æ”»å‡»è€…å¯èƒ½ä½¿ç”¨çš„ç»•è¿‡æŠ€å·§ï¼Œå¹¶ä»å¼€å‘è§’åº¦æ€»ç»“äº†å¤šç§æœ‰æ•ˆçš„é˜²å¾¡æ–¹æ¡ˆã€‚æŒæ¡è¿™äº›çŸ¥è¯†ï¼Œå¯¹äºæŒ–æ˜å’Œé˜²èŒƒSSRFæ¼æ´è‡³å…³é‡è¦ã€‚