![](img/d2847feec9131798ba537001b21bdf9a_0.png)

![](img/d2847feec9131798ba537001b21bdf9a_2.png)

![](img/d2847feec9131798ba537001b21bdf9a_3.png)

![](img/d2847feec9131798ba537001b21bdf9a_4.png)

![](img/d2847feec9131798ba537001b21bdf9a_5.png)

# è¯¾ç¨‹P43ï¼šç¬¬4å¤©ï¼šç½‘ç«™ä¿¡æ¯æ”¶é›† ðŸ”

åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ç½‘ç»œå®‰å…¨æ¸—é€æµ‹è¯•ä¸­è‡³å…³é‡è¦çš„ä¸€æ­¥â€”â€”ç½‘ç«™ä¿¡æ¯æ”¶é›†ã€‚æˆ‘ä»¬å°†äº†è§£å¦‚ä½•è¯†åˆ«ç½‘ç«™çš„â€œæŒ‡çº¹â€ï¼ŒæŽ¢æµ‹æ•æ„Ÿæ–‡ä»¶å’Œç›®å½•ï¼Œä»¥åŠè¯†åˆ«ç½‘ç«™çš„é˜²æŠ¤æŽªæ–½ï¼ˆWAFï¼‰ã€‚æŽŒæ¡è¿™äº›æŠ€èƒ½ï¼Œèƒ½å¸®åŠ©æˆ‘ä»¬æ›´é«˜æ•ˆã€æ›´ç²¾å‡†åœ°å‘çŽ°æ½œåœ¨çš„å®‰å…¨æ¼æ´žã€‚

## ç½‘ç«™æŒ‡çº¹è¯†åˆ« ðŸ§¬

![](img/d2847feec9131798ba537001b21bdf9a_7.png)

![](img/d2847feec9131798ba537001b21bdf9a_9.png)

ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†ä¿¡æ¯æ”¶é›†çš„æ•´ä½“æ¡†æž¶ï¼Œæœ¬èŠ‚ä¸­æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•è¯†åˆ«ä¸€ä¸ªç½‘ç«™çš„â€œæŒ‡çº¹â€ã€‚ç½‘ç«™çš„â€œæŒ‡çº¹â€æ˜¯æŒ‡å…¶æž„æˆç»„ä»¶çš„ä¿¡æ¯ï¼Œä¸»è¦åŒ…æ‹¬æœåŠ¡å™¨æ“ä½œç³»ç»Ÿã€Webä¸­é—´ä»¶ã€è„šæœ¬è¯­è¨€å’Œæ•°æ®åº“ã€‚äº†è§£è¿™äº›ä¿¡æ¯æ˜¯åŽç»­æ¸—é€æµ‹è¯•çš„åŸºç¡€ã€‚

![](img/d2847feec9131798ba537001b21bdf9a_11.png)

![](img/d2847feec9131798ba537001b21bdf9a_13.png)

![](img/d2847feec9131798ba537001b21bdf9a_15.png)

ä¸€ä¸ªç½‘ç«™æœ€åŸºæœ¬çš„ç»„æˆåŒ…æ‹¬ï¼š
*   **æœåŠ¡å™¨ï¼ˆæ“ä½œç³»ç»Ÿï¼‰**ï¼šé€šå¸¸æ˜¯ `Linux` æˆ– `Windows Server`ã€‚
*   **ä¸­é—´ä»¶ï¼ˆWebå®¹å™¨ï¼‰**ï¼šä¾‹å¦‚ `Apache`ã€`Tomcat`ã€`Nginx`ã€‚
*   **è„šæœ¬è¯­è¨€**ï¼šä¾‹å¦‚ `PHP`ã€`JSP`ã€`ASP`ã€`.NET`ã€`Python` çš„ `Django` æˆ– `Flask`ã€‚
*   **æ•°æ®åº“**ï¼šä¾‹å¦‚ `MySQL`ã€`SQL Server`ã€`Oracle`ã€`Access`ã€‚

![](img/d2847feec9131798ba537001b21bdf9a_17.png)

### æ“ä½œç³»ç»Ÿè¯†åˆ«

![](img/d2847feec9131798ba537001b21bdf9a_19.png)

![](img/d2847feec9131798ba537001b21bdf9a_21.png)

ä»¥ä¸‹æ˜¯åˆ¤æ–­ç½‘ç«™æœåŠ¡å™¨æ“ä½œç³»ç»Ÿçš„ä¸‰ç§å¸¸ç”¨æ–¹æ³•ï¼š

![](img/d2847feec9131798ba537001b21bdf9a_23.png)

![](img/d2847feec9131798ba537001b21bdf9a_24.png)

![](img/d2847feec9131798ba537001b21bdf9a_26.png)

1.  **Pingå‘½ä»¤TTLå€¼åˆ¤æ–­**ï¼šé€šè¿‡ `ping` ç›®æ ‡IPï¼Œè§‚å¯Ÿè¿”å›žçš„TTLå€¼ã€‚Windowsç³»ç»Ÿçš„TTLå€¼é€šå¸¸ä¸º128ï¼ŒLinuxç³»ç»Ÿé€šå¸¸ä¸º64ã€‚å…¬å¼å¯æ¦‚æ‹¬ä¸ºï¼š`TTL > 100` ä¸€èˆ¬ä¸ºWindowsï¼Œ`TTL < 100` ä¸€èˆ¬ä¸ºLinuxã€‚
    ```bash
    ping ç›®æ ‡IP
    ```

2.  **Nmapæ‰«æè¯†åˆ«**ï¼šä½¿ç”¨Nmapçš„ `-O` å‚æ•°è¿›è¡Œæ“ä½œç³»ç»Ÿè¯†åˆ«ã€‚
    ```bash
    nmap -O ç›®æ ‡IP
    ```

3.  **URLå¤§å°å†™æ•æ„Ÿæ€§æµ‹è¯•**ï¼šWindowsæœåŠ¡å™¨å¯¹URLè·¯å¾„å¤§å°å†™ä¸æ•æ„Ÿï¼Œè€ŒLinuxæœåŠ¡å™¨æ•æ„Ÿã€‚ä¾‹å¦‚ï¼Œåœ¨WindowsæœåŠ¡å™¨ä¸Šè®¿é—® `http://ç›®æ ‡/DVWA` å’Œ `http://ç›®æ ‡/dvwa` æ•ˆæžœç›¸åŒï¼›åœ¨LinuxæœåŠ¡å™¨ä¸Šï¼Œåˆ™å¯èƒ½å› å¤§å°å†™é”™è¯¯è€Œæ— æ³•è®¿é—®ã€‚

### ä¸­é—´ä»¶ã€è„šæœ¬è¯­è¨€ä¸Žæ•°æ®åº“è¯†åˆ«

è¯†åˆ«ç½‘ç«™çš„ä¸­é—´ä»¶ã€è„šæœ¬è¯­è¨€å’Œæ•°æ®åº“ç±»åž‹ï¼Œæœ‰åŠ©äºŽæˆ‘ä»¬å¯»æ‰¾é’ˆå¯¹æ€§çš„æ¼æ´žã€‚

1.  **æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰**ï¼šæ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„â€œç½‘ç»œ(Network)â€æ ‡ç­¾é¡µï¼Œåˆ·æ–°é¡µé¢ï¼ŒæŸ¥çœ‹HTTPå“åº”å¤´ä¸­çš„ `Server` å­—æ®µï¼Œé€šå¸¸åŒ…å«ä¸­é—´ä»¶ä¿¡æ¯ï¼ˆå¦‚ `Server: nginx`ï¼‰ã€‚

2.  **æµè§ˆå™¨æ’ä»¶**ï¼šä½¿ç”¨å¦‚ `Wappalyzer` è¿™ç±»æµè§ˆå™¨æ’ä»¶ï¼Œå¯ä»¥å¿«é€Ÿåˆ†æžç½‘ç«™ä½¿ç”¨çš„æŠ€æœ¯æ ˆï¼ŒåŒ…æ‹¬ä¸­é—´ä»¶ã€å‰ç«¯æ¡†æž¶ã€è„šæœ¬è¯­è¨€ç­‰ã€‚

3.  **URLåŽç¼€ä¸Žç»éªŒåˆ¤æ–­**ï¼šè§‚å¯Ÿç½‘é¡µURLçš„åŽç¼€åï¼Œä¾‹å¦‚ `.php` é€šå¸¸ä»£è¡¨PHPï¼Œ`.jsp` æˆ– `.do` é€šå¸¸ä»£è¡¨Javaï¼Œ`.aspx` ä»£è¡¨ASP.NETã€‚

4.  **åœ¨çº¿å·¥å…·ä¸ŽNmapè„šæœ¬**ï¼šå¯ä»¥åˆ©ç”¨åœ¨çº¿æŒ‡çº¹è¯†åˆ«å¹³å°æˆ–Nmapçš„è„šæœ¬å¼•æ“Žè¿›è¡Œæ›´å…¨é¢çš„æŽ¢æµ‹ã€‚

### å¸¸è§CMSè¯†åˆ«

CMSï¼ˆå†…å®¹ç®¡ç†ç³»ç»Ÿï¼‰å¦‚ `WordPress`ã€`Discuz!`ã€`ç»‡æ¢¦(DedeCMS)`ã€`PHPCMS` ç­‰ï¼Œé€šå¸¸æœ‰å…¬å¼€çš„æ¼æ´žã€‚è¯†åˆ«CMSæœ‰åŠ©äºŽå¿«é€Ÿå®šä½å¯åˆ©ç”¨çš„åŽ†å²æ¼æ´žã€‚

è¯†åˆ«æ–¹æ³•åŒ…æ‹¬ï¼š
*   **æŸ¥çœ‹ç½‘ç«™é¡µè„š/Banner**ï¼šè®¸å¤šCMSä¼šåœ¨é¡µé¢åº•éƒ¨æ˜¾ç¤ºç‰ˆæƒä¿¡æ¯ï¼Œå¦‚ `Powered by Discuz!`ã€‚
*   **ä½¿ç”¨åœ¨çº¿è¯†åˆ«å·¥å…·**ï¼šè¾“å…¥URLï¼Œè®©å·¥å…·è‡ªåŠ¨åˆ†æžã€‚
*   **æœç´¢æ¼æ´žåº“**ï¼šåœ¨ `exploit-db`ã€`seebug` ç­‰æ¼æ´žå¹³å°æœç´¢å·²çŸ¥CMSçš„æ¼æ´žå’Œåˆ©ç”¨æ–¹æ³•ã€‚

![](img/d2847feec9131798ba537001b21bdf9a_28.png)

![](img/d2847feec9131798ba537001b21bdf9a_30.png)

![](img/d2847feec9131798ba537001b21bdf9a_32.png)

## æ•æ„Ÿæ–‡ä»¶åŠç›®å½•æŽ¢æµ‹ ðŸ“‚

åœ¨äº†è§£äº†ç½‘ç«™çš„åŸºæœ¬æž„æˆåŽï¼Œæˆ‘ä»¬éœ€è¦æŽ¢æµ‹ç½‘ç«™æ˜¯å¦å­˜åœ¨æ•æ„Ÿæ–‡ä»¶æˆ–ç›®å½•æ³„éœ²ã€‚è¿™äº›æ³„éœ²å¯èƒ½æºäºŽç®¡ç†å‘˜é…ç½®ç–å¿½ï¼Œæ˜¯èŽ·å–å…³é”®ä¿¡æ¯ï¼ˆå¦‚æºä»£ç ã€é…ç½®æ–‡ä»¶ã€å¤‡ä»½æ–‡ä»¶ï¼‰çš„é‡è¦é€”å¾„ã€‚

![](img/d2847feec9131798ba537001b21bdf9a_34.png)

![](img/d2847feec9131798ba537001b21bdf9a_36.png)

![](img/d2847feec9131798ba537001b21bdf9a_38.png)

![](img/d2847feec9131798ba537001b21bdf9a_40.png)

![](img/d2847feec9131798ba537001b21bdf9a_42.png)

ä»¥ä¸‹æ˜¯å¸¸è§çš„æ•æ„Ÿæ–‡ä»¶æˆ–ç›®å½•ç±»åž‹ï¼š

*   **`.git`ã€`.svn` æ³„éœ²**ï¼šç‰ˆæœ¬æŽ§åˆ¶ç³»ç»Ÿæ–‡ä»¶æ³„éœ²ï¼Œå¯èƒ½å¯¼è‡´æ•´ä¸ªç½‘ç«™æºä»£ç è¢«ä¸‹è½½ã€‚
*   **`.DS_Store` æ³„éœ²**ï¼šMac OSç³»ç»Ÿç›®å½•æ–‡ä»¶ï¼Œå¯èƒ½æ³„éœ²ç›®å½•ç»“æž„ã€‚
*   **`WEB-INF` æ³„éœ²**ï¼šJava Webåº”ç”¨çš„å®‰å…¨ç›®å½•ï¼Œè‹¥é…ç½®ä¸å½“å¯èƒ½æ³„éœ²æºä»£ç ã€‚
*   **ç½‘ç«™å¤‡ä»½æ–‡ä»¶**ï¼šå¦‚ `www.rar`ã€`web.zip`ã€`database.sql` ç­‰ï¼Œå¯èƒ½åŒ…å«æºä»£ç æˆ–æ•°æ®åº“ä¿¡æ¯ã€‚

![](img/d2847feec9131798ba537001b21bdf9a_44.png)

![](img/d2847feec9131798ba537001b21bdf9a_46.png)

![](img/d2847feec9131798ba537001b21bdf9a_48.png)

![](img/d2847feec9131798ba537001b21bdf9a_50.png)

### æŽ¢æµ‹å·¥å…·ä¸Žæ–¹æ³•

æŽ¢æµ‹è¿™äº›æ•æ„Ÿä¿¡æ¯é€šå¸¸éœ€è¦ä½¿ç”¨ä¸“é—¨çš„å·¥å…·è¿›è¡Œæ‰«æã€‚

![](img/d2847feec9131798ba537001b21bdf9a_52.png)

![](img/d2847feec9131798ba537001b21bdf9a_54.png)

ä»¥ä¸‹æ˜¯å‡ ç§å¸¸ç”¨çš„ç›®å½•å’Œæ–‡ä»¶æ‰«æå·¥å…·ï¼š

![](img/d2847feec9131798ba537001b21bdf9a_56.png)

1.  **å¾¡å‰‘**ï¼šç»å…¸çš„å›¾å½¢åŒ–ç›®å½•æ‰«æå·¥å…·ï¼Œæ”¯æŒå¤šç§è„šæœ¬ç±»åž‹å­—å…¸ï¼Œæ˜“äºŽä¸Šæ‰‹ã€‚
2.  **dirsearch**ï¼šåŸºäºŽPythonçš„å‘½ä»¤è¡Œç›®å½•æ‰«æå·¥å…·ï¼Œé€Ÿåº¦å¿«ï¼Œå¯å®šåˆ¶æ€§å¼ºã€‚
    ```bash
    python3 dirsearch.py -u http://ç›®æ ‡ç½‘å€ -e php,html,zip
    ```
3.  **dirmap**ï¼šå¦ä¸€æ¬¾é«˜æ•ˆçš„Pythonç›®å½•æ‰«æå·¥å…·ï¼Œæ”¯æŒå¹¶å‘æ‰«æã€‚
    ```bash
    python3 dirmap.py -i http://ç›®æ ‡ç½‘å€ -lcf
    ```

**é’ˆå¯¹ç‰¹å®šæ¼æ´žçš„ä¿¡æ¯æ³„éœ²**ï¼šæŸäº›æ¡†æž¶å­˜åœ¨å›ºæœ‰çš„ä¿¡æ¯æ³„éœ²æ¼æ´žã€‚ä¾‹å¦‚ï¼ŒSpring Bootæ¡†æž¶çš„ `/env` ç«¯ç‚¹æœªæŽˆæƒè®¿é—®ï¼Œå¯èƒ½æ³„éœ²æ•°æ®åº“å¯†ç ç­‰æ•æ„Ÿé…ç½®ä¿¡æ¯ã€‚å‘çŽ°è¿™ç±»æ¼æ´žé€šå¸¸ä¹Ÿéœ€è¦é€šè¿‡ç›®å½•æŽ¢æµ‹æ¥å¯»æ‰¾ç‰¹å®šè·¯å¾„ã€‚

## ç½‘ç«™WAFè¯†åˆ« ðŸ›¡ï¸

åœ¨å°è¯•æ¸—é€ä¹‹å‰ï¼Œè¯†åˆ«ç›®æ ‡ç½‘ç«™æ˜¯å¦éƒ¨ç½²äº†WAFï¼ˆWebåº”ç”¨é˜²ç«å¢™ï¼‰è‡³å…³é‡è¦ã€‚WAFä¼šæ‹¦æˆªå¸¸è§çš„æ”»å‡»æµé‡ï¼Œç›²ç›®æµ‹è¯•å¯èƒ½å¯¼è‡´IPè¢«å°é”ã€‚

WAFä¸»è¦ç”¨äºŽï¼š
*   é˜²å¾¡å¸¸è§Webæ”»å‡»ï¼ˆå¦‚SQLæ³¨å…¥ã€XSSï¼‰ã€‚
*   é˜²æ­¢è‡ªåŠ¨åŒ–æ”»å‡»ï¼ˆå¦‚æš´åŠ›ç ´è§£ã€æ¼æ´žæ‰«æï¼‰ã€‚
*   é˜»æ­¢æ¶æ„çˆ¬è™«ç­‰ã€‚

![](img/d2847feec9131798ba537001b21bdf9a_58.png)

### WAFè¯†åˆ«æ–¹æ³•

![](img/d2847feec9131798ba537001b21bdf9a_60.png)

![](img/d2847feec9131798ba537001b21bdf9a_62.png)

è¯†åˆ«WAFå¯ä»¥å¸®åŠ©æˆ‘ä»¬é€‰æ‹©é’ˆå¯¹æ€§çš„ç»•è¿‡æŠ€æœ¯ã€‚

![](img/d2847feec9131798ba537001b21bdf9a_64.png)

![](img/d2847feec9131798ba537001b21bdf9a_66.png)

![](img/d2847feec9131798ba537001b21bdf9a_68.png)

1.  **æ‰‹åŠ¨æµ‹è¯•**ï¼šæäº¤ç®€å•çš„æµ‹è¯•Payloadï¼ˆå¦‚ `' and '1'='1`ï¼‰ï¼Œè§‚å¯Ÿè¿”å›žé¡µé¢æ˜¯å¦åŒ…å« `å®‰å…¨ç‹—`ã€`äº‘é”`ã€`é˜¿é‡Œäº‘ç›¾` ç­‰WAFæ‹¦æˆªæç¤ºã€‚
2.  **å·¥å…·è¯†åˆ«**ï¼šä½¿ç”¨ `wafw00f` å·¥å…·å¯ä»¥è‡ªåŠ¨åŒ–è¯†åˆ«WAFã€‚
    ```bash
    # å®‰è£…
    git clone https://github.com/EnableSecurity/wafw00f.git
    cd wafw00f
    python setup.py install
    # ä½¿ç”¨
    wafw00f http://ç›®æ ‡ç½‘å€
    ```
3.  **Nmapè„šæœ¬**ï¼šNmapä¹Ÿæä¾›äº†ä¸€äº›ç”¨äºŽè¯†åˆ«WAFçš„è„šæœ¬ï¼Œä½†è¯†åˆ«èƒ½åŠ›ç›¸å¯¹ä¸€èˆ¬ã€‚

è¯†åˆ«å‡ºWAFåŽï¼Œå¯ä»¥æœç´¢è¯¥WAFçš„å·²çŸ¥ç»•è¿‡æ–¹æ³•ï¼Œä¾‹å¦‚ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ã€æ³¨é‡Šã€ç¼–ç ç­‰æ–¹å¼å°è¯•ç»•è¿‡é˜²æŠ¤è§„åˆ™ã€‚

## æ€»ç»“ä¸Žä½œä¸š ðŸ“

æœ¬èŠ‚è¯¾ä¸­æˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†ç½‘ç«™ä¿¡æ¯æ”¶é›†çš„ä¸‰ä¸ªæ ¸å¿ƒéƒ¨åˆ†ï¼š**ç½‘ç«™æŒ‡çº¹è¯†åˆ«**ã€**æ•æ„Ÿæ–‡ä»¶åŠç›®å½•æŽ¢æµ‹**ä»¥åŠ**ç½‘ç«™WAFè¯†åˆ«**ã€‚è¿™äº›æ˜¯æ¸—é€æµ‹è¯•å‰æœŸæœ€å…³é”®çš„ä¿¡æ¯æ¢³ç†å·¥ä½œï¼Œèƒ½ä¸ºåŽç»­çš„æ¼æ´žæŒ–æŽ˜å’Œåˆ©ç”¨æä¾›æ˜Žç¡®çš„æ–¹å‘ã€‚

**è¯¾åŽä½œä¸š**ï¼š
1.  **å®žéªŒç»ƒä¹ **ï¼šåœ¨å’Œå¤©å®žéªŒå®¤å¹³å°å®Œæˆã€ŠNmapç½‘ç»œæ‰«æã€‹ä¸Žã€ŠWebæ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼ˆGit/SVNï¼‰ã€‹ç›¸å…³å®žéªŒã€‚
2.  **å®žæˆ˜å°è¯•**ï¼šé€‰æ‹©ä¸€ä¸ªå…¬ç›ŠSRCå¹³å°ï¼ˆå¦‚è¡¥å¤©ã€æ¼æ´žç›’å­ï¼‰ä¸Šçš„ä¸€ä¸ªç›®æ ‡ï¼Œå°è¯•è¿›è¡Œå®Œæ•´çš„ç½‘ç«™ä¿¡æ¯æ”¶é›†ï¼Œå¹¶è®°å½•æ”¶é›†åˆ°çš„ä¿¡æ¯åŠè¿‡ç¨‹ã€‚

![](img/d2847feec9131798ba537001b21bdf9a_70.png)

é€šè¿‡ç†è®ºä¸Žå®žè·µçš„ç»“åˆï¼Œä½ å°†èƒ½ç†Ÿç»ƒæŽŒæ¡ç½‘ç«™ä¿¡æ¯æ”¶é›†çš„æŠ€èƒ½ï¼Œä¸ºæˆä¸ºä¸€ååˆæ ¼çš„ç½‘ç»œå®‰å…¨å·¥ç¨‹å¸ˆæ‰“ä¸‹åšå®žåŸºç¡€ã€‚ç¥å¤§å®¶å­¦ä¹ é¡ºåˆ©ï¼